<html>
<head>
<title>End to end Mask detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç«¯åˆ°ç«¯å±è”½æ£€æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/end-to-end-mask-detection-24fb44a52523?source=collection_archive---------1-----------------------#2020-11-22">https://medium.com/nerd-for-tech/end-to-end-mask-detection-24fb44a52523?source=collection_archive---------1-----------------------#2020-11-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7cf14e5621d093da6b8d4c9f642fdfd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lH5mIjU7ISbB4EEJ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">äºšå½“Â·å°¼è¥¿å¥¥é²å…‹åœ¨<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><p id="c5de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">é¦–å…ˆï¼Œä»€ä¹ˆæ˜¯ç«¯åˆ°ç«¯ï¼Ÿ</p><p id="93f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æœºå™¨å­¦ä¹ /æ•°æ®ç§‘å­¦å®¶ä¸­çš„ç«¯åˆ°ç«¯è§£å†³æ–¹æ¡ˆæ˜¯ä¸€ä¸ªæ¶µç›–æ•°æ®æ”¶é›†ä»¥æ„å»ºæ¨¡å‹å¹¶åœ¨ç°å®ç”Ÿæ´»ä¸­ä½¿ç”¨å®ƒçš„è¿‡ç¨‹ã€‚</p><p id="3a4c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ›´å¤šç«¯åˆ°ç«¯é˜…è¯»é˜…è¯»è¿™ä¸ªæƒŠäººçš„åšå®¢</p><div class="jt ju ez fb jv jw"><a href="https://eugeneyan.com/writing/end-to-end-data-science/" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">ä¸å—æ¬¢è¿çš„è§‚ç‚¹-æ•°æ®ç§‘å­¦å®¶åº”è¯¥æ›´åŠ ç«¯åˆ°ç«¯</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">æœ€è¿‘ï¼Œæˆ‘åœ¨Redditä¸Šçœ‹åˆ°ä¸€ä¸ªå…³äºæ•°æ®ç§‘å­¦å’Œæœºå™¨å­¦ä¹ ä¸­ä¸åŒè§’è‰²çš„å¸–å­:æ•°æ®ç§‘å­¦å®¶â€¦</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">eugeneyan.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jw"/></div></div></a></div></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="7ffb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç›®å½•</p><ol class=""><li id="afdf" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js kx ky kz la bi translated">æ”¶é›†æ•°æ®</li><li id="e700" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">æ•°æ®é¢„å¤„ç†</li><li id="823a" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">å¯è§†åŒ–æ•°æ®</li><li id="b034" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">å»ºç«‹æ¨¡å‹</li><li id="f3d7" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ç«è½¦æ¨¡å‹</li><li id="d829" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">è¯„ä¼°è®­ç»ƒæ¨¡å‹</li><li id="2aa2" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä¿å­˜å·²è®­ç»ƒçš„æ¨¡å‹</li><li id="4d0a" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">æ ¹æ®è‡ªå®šä¹‰æ•°æ®è¿›è¡Œé¢„æµ‹</li><li id="1f83" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">å®æ—¶æ£€æµ‹</li></ol></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="c85d" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">1.æ”¶é›†æ•°æ®</h1><p id="6b5e" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">åœ¨æ¯ä¸€ä¸ªæœºå™¨å­¦ä¹ ä¸­ï¼Œé—®é¢˜æ•°æ®éƒ½å¾ˆé‡è¦ã€‚ä½†æ›´é‡è¦çš„æ˜¯å®ƒçš„å½¢å¼æ˜¯æ­£ç¡®çš„ã€‚</p><p id="1b20" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™é‡Œï¼Œæ•°æ®æ˜¯ä»<a class="ae iu" href="https://www.kaggle.com/andrewmvd/face-mask-detection" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>æ”¶é›†çš„ã€‚</p><p id="0a28" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ•°æ®æ˜¯è¿™ä¸ªæ•°æ®é›†çš„å­é›†ï¼Œä½ å¯ä»¥ä»<a class="ae iu" href="https://drive.google.com/drive/folders/1n8AXQ8wEKWH6nx8Vz-dxLbPQzz5qerPq?usp=sharing" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ä¸‹è½½</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="6617" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">2.æ•°æ®é¢„å¤„ç†</h1><p id="b7dd" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">åœ¨æˆ‘ä»¬å¤„ç†æ•°æ®ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç”¨æ­£ç¡®çš„åç§°å°†æ•°æ®ç»„ç»‡åœ¨æ­£ç¡®çš„æ–‡ä»¶å¤¹ä¸­ã€‚</p><p id="05d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©:</p><ul class=""><li id="6a1e" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">ä½¿ç”¨tensor flow<a class="ae iu" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image_dataset_from_directory" rel="noopener ugc nofollow" target="_blank">image _ dataset _ from _ directory</a>ã€‚</li><li id="019d" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js mj ky kz la bi translated">åŠ è½½CSVæ–‡ä»¶ã€‚</li></ul><p id="bac5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä»CSVæ–‡ä»¶åŠ è½½</p><p id="f451" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œä¸åŒ…æ‹¬CSVæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é€šè¿‡å›¾åƒæ•°æ®ç”Ÿæˆã€‚</p><p id="3408" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å›¾åƒåç§°æ”¹ä¸ºå¸¦æ©ç å’Œä¸å¸¦æ©ç ã€‚</p><p id="a307" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç”¨äºå¸¦æ©ç </p><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="9d16" class="mt lh hi mp b fi mu mv l mw mx"># importing os module <br/>import os <br/><br/># Function to rename multiple files <br/>def main():<br/>    for count, filename in enumerate(os.listdir("DATASET/")):<br/>        dst ="withmask." + str(count) + ".jpeg"<br/>        src ='DATASET/'+ filename <br/>        dst ='DATASET/'+ dst <br/>        # rename() function will<br/>        # rename all the files <br/>        os.rename(src, dst) <br/><br/># Driver Code <br/>if __name__ == '__main__':<br/>    # Calling main() function <br/>    main()</span></pre><p id="a784" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å› ä¸ºæ²¡æœ‰é¢å…·</p><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="333d" class="mt lh hi mp b fi mu mv l mw mx"># importing os module <br/>import os <br/><br/># Function to rename multiple files <br/>def main():<br/>    for count, filename in enumerate(os.listdir("New folder/")):<br/>        dst ="withoutmask." + str(count) + ".jpeg"<br/>        src ='New folder/'+ filename <br/>        dst ='New folder/'+ dst <br/>        # rename() function will<br/>        # rename all the files <br/>        os.rename(src, dst) <br/><br/># Driver Code <br/>if __name__ == '__main__':<br/>    # Calling main() function <br/>    main()</span></pre><p id="bb0d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ç°åœ¨å°†æ‰€æœ‰ç”Ÿæˆçš„å›¾åƒç§»åŠ¨åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªç†ŠçŒ«æ•°æ®æ¡†</p><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="6c52" class="mt lh hi mp b fi mu mv l mw mx">import pandas as pd<br/>filenames=os.listdir("FULL_DATA/")<br/>categories=[]<br/>for f_name in filenames:<br/>    category=f_name.split('.')[0]<br/>    if category=='withmask':<br/>        categories.append('withmask')<br/>    else:<br/>        categories.append('withoutmask')<br/>df=pd.DataFrame({<br/>    'filename':filenames,<br/>    'labels':categories<br/>})</span></pre><figure class="mk ml mm mn fd ij er es paragraph-image"><div class="er es my"><img src="../Images/c5df791ad66c095e45111da4d7a18849.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*aBO9u4I1uKpvvQVHPS-_jw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">æ•°æ®å¸§</figcaption></figure><p id="10f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å°†æ•°æ®å¸§ä¿å­˜åˆ°CSVæ–‡ä»¶ä¸­ã€‚</p><p id="c3dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">ç°åœ¨æ•°æ®ç»“æ„æ­£ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥åŠ è½½æ•°æ®äº†</strong></p><ul class=""><li id="7e70" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">è¯»å–CSVæ–‡ä»¶</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="7688" class="mt lh hi mp b fi mu mv l mw mx"># Import pandas</span><span id="f42c" class="mt lh hi mp b fi mz mv l mw mx">import pandas as pd</span><span id="9081" class="mt lh hi mp b fi mz mv l mw mx">labels_csv = pd.read_csv("PATH TO CSV FILE")</span></pre><ul class=""><li id="68d9" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">å‡†å¤‡æ ‡ç­¾</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="0e84" class="mt lh hi mp b fi mu mv l mw mx">import numpy as np</span><span id="1bd9" class="mt lh hi mp b fi mz mv l mw mx">labels = labels_csv["labels"].to_numpy()</span><span id="12ef" class="mt lh hi mp b fi mz mv l mw mx">labels</span></pre><ul class=""><li id="5fa4" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">å°†æ ‡ç­¾è½¬æ¢æˆå¸ƒå°”æ•°ç»„</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="4d52" class="mt lh hi mp b fi mu mv l mw mx"># Find the unique label values</span><span id="3eb3" class="mt lh hi mp b fi mz mv l mw mx">unique_category = np.unique(labels)</span><span id="a175" class="mt lh hi mp b fi mz mv l mw mx">len(unique_category)</span><span id="325d" class="mt lh hi mp b fi mz mv l mw mx">boolean_labels = [label == unique_category for label in labels]</span></pre><ul class=""><li id="0005" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">ä½¿ç”¨<strong class="ix hj"> train_test_split </strong>åˆ›å»ºéªŒè¯é›†</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="c5b6" class="mt lh hi mp b fi mu mv l mw mx"># Setup X &amp; y variables</span><span id="3c81" class="mt lh hi mp b fi mz mv l mw mx">X = filenames</span><span id="85d6" class="mt lh hi mp b fi mz mv l mw mx">y = boolean_labels</span><span id="6d68" class="mt lh hi mp b fi mz mv l mw mx"># Let's split data</span><span id="db56" class="mt lh hi mp b fi mz mv l mw mx">from sklearn.model_selection import train_test_split</span><span id="9fd4" class="mt lh hi mp b fi mz mv l mw mx"># Into train and valid</span><span id="ee0f" class="mt lh hi mp b fi mz mv l mw mx">X_train, X_val, y_train, y_val = train_test_split(X,</span><span id="38cf" class="mt lh hi mp b fi mz mv l mw mx">                                                  y,</span><span id="c862" class="mt lh hi mp b fi mz mv l mw mx">                                                  test_size=0.2,</span><span id="31cd" class="mt lh hi mp b fi mz mv l mw mx">                                                  random_state=2509)</span><span id="540a" class="mt lh hi mp b fi mz mv l mw mx">len(X_train), len(X_val), len(y_train), len(y_val)</span></pre><ul class=""><li id="1aec" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">å°†å›¾åƒè½¬æ¢æˆå¼ é‡</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="3cba" class="mt lh hi mp b fi mu mv l mw mx"># Define image size<br/>IMG_SIZE = 224<br/><br/># Function<br/>def process_image(image_path, image_size=IMG_SIZE):<br/>  """<br/>  Takes an image file path and turns the image into a Tensor.<br/>  """<br/>  # Read in an image file<br/>  image = tf.io.read_file(image_path)<br/>  # Turn the jpg image into numerical Tensor with 3 colour   </span><span id="cae2" class="mt lh hi mp b fi mz mv l mw mx">  #channel(RGB)<br/>  <br/>  image = tf.image.decode_jpeg(image,channels=3)<br/>  # Convert the color channel values to (0-1) values<br/>  image = tf.image.convert_image_dtype(image,tf.float32)<br/>  # Resize the image to (224,224)<br/>  image = tf.image.resize(image, size=[image_size,image_size])<br/><br/>  return image</span></pre><ul class=""><li id="183b" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">å°†æ•°æ®æ‰¹é‡åŒ–</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="3383" class="mt lh hi mp b fi mu mv l mw mx"># Create a function to return a tuple (image, label)<br/>def get_image_lable(image_path,label):<br/>  """<br/>  Takes an image file path name and the label,<br/>  processes the image and return a tuple (image, label).<br/>  """<br/>  image = process_image(image_path)<br/><br/>  return image, label</span><span id="c2b2" class="mt lh hi mp b fi mz mv l mw mx"># Define the batch size<br/>BATCH_SIZE = 32<br/><br/># Function to convert data into batches<br/>def create_data_batches(X,y=None, batch_size=BATCH_SIZE,valid_data=False):<br/>  """<br/>  Creates batches of data of image (X) and label (y) pairs.<br/>  Shuffle the data if it's training data but doesn't shuffle if it's validation data.<br/>  """<br/>  # If data is valid dataset (NO SHUFFLE)<br/>  if valid_data:<br/>    print("Creating valid data batches.........")<br/>    data = tf.data.Dataset.from_tensor_slices((tf.constant(X),<br/>                                               tf.constant(y)))<br/>    data_batch = data.map(get_image_lable).batch(batch_size)<br/>    return data_batch<br/><br/>  else:<br/>    print("Creating train data batches.........")<br/>    # Turn filepaths and labels into Tensors<br/>    data = tf.data.Dataset.from_tensor_slices((tf.constant(X),<br/>                                               tf.constant(y)))<br/>    # Shuffling pathname and labels before mapping image processor fun<br/>    data = data.shuffle(buffer_size=len(X))<br/>    data_batch = data.map(get_image_lable).batch(batch_size)<br/><br/>    return data_batch</span></pre></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="a32d" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">3.å¯è§†åŒ–æ•°æ®</h1><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="fc5a" class="mt lh hi mp b fi mu mv l mw mx">import matplotlib.pyplot as plt<br/># Create fun for viewing in a data batch<br/>def show_images(images, labels):<br/>  """<br/>  Displays a plot of 25 images and their labels from a data batch.<br/>  """<br/>  plt.figure(figsize=(20, 20))<br/>  for i in range(25):<br/>    # Subplot<br/>    ax = plt.subplot(5,5,i+1)<br/>    plt.imshow(images[i])<br/>    plt.title(unique_category[labels[i].argmax()])<br/>    plt.axis("Off")</span></pre><p id="a9dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è°ƒç”¨è¿™ä¸ªå‡½æ•°</p><ul class=""><li id="bbf2" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">å¯¹äºè®­ç»ƒæ•°æ®</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="93aa" class="mt lh hi mp b fi mu mv l mw mx">train_images, train_labels = next(train_data.as_numpy_iterator())<br/>show_images(train_images,train_labels)</span></pre><ul class=""><li id="fef3" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js mj ky kz la bi translated">å¯¹äºæœ‰æ•ˆæ•°æ®</li></ul><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="db80" class="mt lh hi mp b fi mu mv l mw mx">val_images, val_labels = next(val_data.as_numpy_iterator())<br/>show_images(val_images, val_labels)</span></pre></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="9079" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">4.å»ºç«‹æ¨¡å‹</h1><p id="72b8" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å°†TensorFlow hubç”¨äºé¢„è®­ç»ƒæ¨¡å‹ã€‚</p><p id="18cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¯¹äºæ­¤ä»»åŠ¡ï¼Œæˆ‘ä»¬ä½¿ç”¨å°å‹å‹å·çš„<a class="ae iu" href="https://tfhub.dev/google/imagenet/mobilenet_v2_130_224/classification/4" rel="noopener ugc nofollow" target="_blank"> MobileNet V2 </a>ã€‚</p><ol class=""><li id="19ce" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js kx ky kz la bi translated">Set input_shape = [noneï¼Œ224ï¼Œ224ï¼Œ3]</li><li id="2911" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">è®¾ç½®è¾“å‡ºå½¢çŠ¶= 2</li><li id="e4db" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä½¿ç”¨tf.kerasä¸­çš„é¡ºåºæ¨¡å‹</li><li id="534a" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä½¿ç”¨model.build(input_shape)</li></ol><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="b0b0" class="mt lh hi mp b fi mu mv l mw mx"># Create a fun to build a keras model<br/>def create_model(input_shape=INPUT_SHAPE,output_shape=OUTPUT_SHAPE, model_url=MODEL_URL):<br/>  print("Building model with:", model_url)<br/><br/>  # Setup the model<br/>  model = tf.keras.Sequential([<br/>                               hub.KerasLayer(model_url),<br/>                               tf.keras.layers.Dense(units=output_shape, <br/>                                                     activation="softmax")<br/>  ])<br/><br/>  # Compile the model<br/>  model.compile(<br/>      loss = tf.keras.losses.BinaryCrossentropy(),<br/>      optimizer = tf.keras.optimizers.Adam(),<br/>      metrics = ["accuracy"]<br/>  )<br/><br/>  # Build the model<br/>  model.build(input_shape)<br/><br/>  return model</span><span id="47c1" class="mt lh hi mp b fi mz mv l mw mx">model = create_model()<br/>model.summary()</span></pre><figure class="mk ml mm mn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/ac6cbae5904fccde829b7f7b6325eb49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5P6G1PqZAc-63j1T1UvMcg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">æ¨¡å‹_æ‘˜è¦</figcaption></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="dc61" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">5.è®­ç»ƒæ¨¡ç‰¹</h1><p id="5b5d" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">æ ¹æ®25ä¸ªæ—¶æœŸçš„train_dataå’Œvalid_dataè®­ç»ƒæ¨¡å‹</p><p id="7f1b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å¦å¤–ï¼Œæ·»åŠ ä¸€ä¸ª<a class="ae iu" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping" rel="noopener ugc nofollow" target="_blank">æå‰åœæ­¢å›è°ƒ</a></p><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="d0ad" class="mt lh hi mp b fi mu mv l mw mx">Model.fit(x=train_data,<br/>          epochs=25,<br/>          validation_data=val_data,<br/>          callback=[early_stopping])</span></pre><figure class="mk ml mm mn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/0dc6e4e45a6dc9872e5eb2c0da1c54eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kUcZGuHlzWJgFbD7iLZV6A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">è®­ç»ƒæ¨¡å‹</figcaption></figure><p id="df0a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æœ‰äº†è¿™ä¸ªæ¨¡å‹ï¼Œval_lossæ˜¯<strong class="ix hj"> <em class="nc"> 0.0096 </em> </strong>è€Œå‡†ç¡®åº¦å‡ ä¹æ˜¯<strong class="ix hj"> <em class="nc"> 99.99 % </em> </strong></p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="21f9" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">6.è¯„ä¼°é¢„æµ‹</h1><p id="d4c3" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">å¯¹val_dataæ¨¡å‹ä½¿ç”¨model.predict()è¿”å›shape (_ï¼Œ2)çš„NumPyæ•°ç»„</p><figure class="mk ml mm mn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/30cdff470e2c5f43512cde35419f62c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zov_O4sSvaXHs5GT_a850w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">æœ‰æ•ˆæ•°æ®çš„é¢„æµ‹å›¾åƒ</figcaption></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="9a30" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">7.ä¿å­˜å¹¶é‡æ–°åŠ è½½å·²è®­ç»ƒæ¨¡å‹</h1><p id="3fff" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">ä½¿ç”¨kerasä¸­çš„save_modelä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚</p><p id="a80a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åŠ è½½æ¨¡å‹ä¸å¸¸è§„çš„load_modelæœ‰ç‚¹ä¸åŒ</p><p id="9aba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">è¿™é‡Œæˆ‘ä»¬è¦æä¾›<strong class="ix hj"><em class="nc">custom _ objects = { " KerasLayer ":hubã€‚æ¨¡å‹è·¯å¾„æ—åŠ è½½æ¨¡å‹å‡½æ•°ä¸­çš„</em> </strong>ã€‚</p><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="689c" class="mt lh hi mp b fi mu mv l mw mx">model = load_model(<br/>    'model/model.h5', custom_objects={"KerasLayer": hub.KerasLayer})</span></pre></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="d84f" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">8.æ ¹æ®è‡ªå®šä¹‰æ•°æ®è¿›è¡Œé¢„æµ‹</h1><p id="c3ef" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">åœ¨é¢„æµ‹æ–°æ•°æ®ä¹‹å‰ï¼Œè¯·ç¡®ä¿å®ƒçš„å½¢çŠ¶å’Œå¤§å°éƒ½æ­£ç¡®ã€‚</p><pre class="mk ml mm mn fd mo mp mq mr aw ms bi"><span id="9647" class="mt lh hi mp b fi mu mv l mw mx">def test_data(path):<br/>  demo = imread(path)<br/>  demo = tf.image.convert_image_dtype(demo,tf.float32)<br/>  demo = tf.image.resize(demo,size=[224,224])<br/>  demo = np.expand_dims(demo,axis=0)<br/><br/>  pred = model.predict(demo)<br/>  result = unique_category[np.argmax(pred)]<br/><br/>  return result</span></pre></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="cf28" class="lg lh hi bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">9.å®æ—¶æ£€æµ‹</h1><p id="0388" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨OpenCVçš„é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå®æ—¶æ£€æµ‹ã€‚</p><figure class="mk ml mm mn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/45cdb649fc53ee020c431ab154823d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAjBW_9TGRQeU5EnG67bWQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">å¸¦é¢å…·</figcaption></figure><ol class=""><li id="592c" class="ks kt hi ix b iy iz jc jd jg ku jk kv jo kw js kx ky kz la bi translated">å¯¼å…¥åº“</li><li id="4d93" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä½¿ç”¨load_model()åŠ è½½æ¨¡å‹ç¡®ä¿ä½¿ç”¨<strong class="ix hj"> <em class="nc"> custom_objectsã€‚</em> </strong></li><li id="ca77" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä½¿ç”¨cv2çš„ç½‘ç»œæ‘„åƒå¤´ã€‚è§†é¢‘æ•è·()</li><li id="5a3c" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä½¿ç”¨<a class="ae iu" href="https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml" rel="noopener ugc nofollow" target="_blank">Haar scade _ front alface</a>XMLæ–‡ä»¶è¿›è¡Œäººè„¸æ£€æµ‹ã€‚</li><li id="54f0" class="ks kt hi ix b iy lb jc lc jg ld jk le jo lf js kx ky kz la bi translated">ä½¿ç”¨åŠ è½½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚</li></ol></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="ebf8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä»£ç å›è´­</p><div class="jt ju ez fb jv jw"><a href="https://github.com/Vivek2509/End-to-end-mask-detector" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">vivek 2509/ç«¯åˆ°ç«¯é¢ç½©æ£€æµ‹å™¨</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">ä¸ºé¢å…·æ£€æµ‹æ„å»ºæ·±åº¦å­¦ä¹ æ¨¡å‹GitHubæ˜¯è¶…è¿‡5000ä¸‡å¼€å‘äººå‘˜çš„å®¶å›­ï¼Œä»–ä»¬ä¸€èµ·å·¥ä½œæ¥æ‰˜ç®¡å’Œâ€¦</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">github.com</p></div></div><div class="kf l"><div class="nf l kh ki kj kf kk io jw"/></div></div></a></div></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="dccd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">å˜¿ï¼Œè¯»è€…ä»¬ï¼Œæ„Ÿè°¢ä½ ä»¬çš„æ—¶é—´ã€‚å¦‚æœä½ å–œæ¬¢è¿™ä¸ªåšå®¢ï¼Œåˆ«å¿˜äº†é¼“æŒæ¬£èµå®ƒğŸ‘ã€‚</p><p id="0ed9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">æ›´å¤šå…³äºæœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦çš„åšå®¢è¯·å…³æ³¨æˆ‘ã€‚</p><p id="c097" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">åŠ¨æ‰‹æœºå™¨å­¦ä¹ é¡¹ç›®å‚è€ƒå¦‚ä¸‹</p><div class="jt ju ez fb jv jw"><a href="https://vivek2509.github.io/World_of_ML/" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">MLçš„ä¸–ç•Œ</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">ä¸ºäº†è®©ä¸–ç•Œå˜å¾—æ›´ç¾å¥½ï¼Œæ˜æ™ºåœ°ä½¿ç”¨æ•°æ®å’Œæœºå™¨ã€‚</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">vivek2509.github.io</p></div></div><div class="kf l"><div class="ng l kh ki kj kf kk io jw"/></div></div></a></div></div></div>    
</body>
</html>