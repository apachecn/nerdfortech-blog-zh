<html>
<head>
<title>Todo App With GraphQL, Express.js And React â€” Episode 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ GraphQLã€Express.js å’Œ React çš„ Todo åº”ç”¨ç¨‹åºâ€”ç¬¬ 1 é›†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/todo-app-with-graphql-express-js-redux-episode-1-ccbe54b40c89?source=collection_archive---------4-----------------------#2021-05-03">https://medium.com/nerd-for-tech/todo-app-with-graphql-express-js-redux-episode-1-ccbe54b40c89?source=collection_archive---------4-----------------------#2021-05-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/aee247e71af8002c5249e1af3082ea89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkG4MeJ05GClnO2Xx0UQ0Q.png"/></div></div></figure><h1 id="6535" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">æ„å»ºåŸºæœ¬ API</h1><p id="538e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi km translated">æ¬¢è¿å…‰ä¸´ã€‚è¿›è¡Œ API è°ƒç”¨å¹¶åœ¨ web é¡µé¢ä¸Šå‘ˆç°å“åº”éå¸¸æœ‰è¶£ã€‚ä½†æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ª API å¹¶æŸ¥è¯¢å®ƒæ˜¯å¾ˆæ£’çš„ï¼æ­¤å¤–ï¼Œåˆ›å»º API å¯ä»¥è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£ API æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå®ƒä»¬èƒŒåçš„é€»è¾‘æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå½“æ”¶åˆ° API è°ƒç”¨æ—¶åç«¯ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨è§‰å¾—åˆ°ç›®å‰ä¸ºæ­¢æ‚¨å·²ç»åœ¨é¡¹ç›®ä¸­åšäº†è¶³å¤Ÿå¤šçš„ API è°ƒç”¨ï¼Œå¹¶ä¸”æ‚¨å†³å®šæ·±å…¥äº†è§£ä»»ä½•åº”ç”¨ç¨‹åºçš„æ•´ä¸ªè¿‡ç¨‹ï¼Œæˆ‘å¯ä»¥è¯´è¿™ç¯‡æ–‡ç« å¯èƒ½ä¼šå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚</p><p id="58f1" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æˆ‘ä»¬å°†åœ¨è¿™ä¸ªé¡¹ç›®ä¸­æ„å»ºä¸€ä¸ª todo åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›æŠ€æœ¯:</p><ul class=""><li id="eba3" class="la lb hi jq b jr kv jv kw jz lc kd ld kh le kl lf lg lh li bi translated">å¿«é€’. js</li><li id="bc4b" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">GraphQL</li><li id="69b6" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">é˜¿æ³¢ç½—</li><li id="dce4" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">è’™æˆˆ</li><li id="97b9" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">ååº”</li></ul><p id="4d34" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤º:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/953f0c69f967f2fd7702e97a8aa080f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHjiqP0ijRUT2hRUJccyZg.png"/></div></div></figure><p id="6a70" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">è¿™ä¸€ç³»åˆ—æ–‡ç« è®¡åˆ’ç”± 3 é›†ç»„æˆã€‚è¿™äº›å‰§é›†å°†åŒ…å«ä»¥ä¸‹æ ‡é¢˜:</p><ul class=""><li id="acc2" class="la lb hi jq b jr kv jv kw jz lc kd ld kh le kl lf lg lh li bi translated">æ„å»ºåŸºæœ¬ API</li><li id="9f1a" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">æ„å»ºç”¨æˆ·èº«ä»½éªŒè¯</li><li id="cb73" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">åœ¨å‰ç«¯å‘ˆç°å’Œæ“ä½œæ•°æ®</li></ul><p id="7384" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">åœ¨è¿™ä¸€é›†é‡Œï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªåŸºæœ¬çš„ APIã€‚å®ƒå°†åŒ…å«ä¸€ä¸ªè·å– Todo é¡¹çš„æŸ¥è¯¢å’Œä¸‰ä¸ªåˆ›å»ºã€ä¿®æ”¹å’Œåˆ é™¤é¡¹çš„çªå˜ã€‚</p><p id="7989" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">è¿™é‡Œæ˜¯<a class="ae lt" href="https://github.com/ardaorkin/todo-app-server" rel="noopener ugc nofollow" target="_blank">è¿™ä¸€é›†</a>çš„æœ€ç»ˆä»£ç ã€‚</p><p id="730d" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">å‡†å¤‡å¥½äº†å—ï¼Ÿé‚£æˆ‘ä»¬èµ°å§ï¼</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><h2 id="ab58" class="mb ir hi bd is mc md me iw mf mg mh ja jz mi mj je kd mk ml ji kh mm mn jm mo bi translated">è¦æ±‚</h2><ul class=""><li id="2b82" class="la lb hi jq b jr js jv jw jz mp kd mq kh mr kl lf lg lh li bi translated">NodeJS 14v+</li><li id="5299" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">NPM è¿˜æ˜¯çº±çº¿</li><li id="c49a" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">NPX</li><li id="19f9" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">React å¼€å‘äººå‘˜å·¥å…·</li><li id="96da" class="la lb hi jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">Apollo å®¢æˆ·ç«¯å¼€å‘å·¥å…·</li></ul></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><h2 id="e7ee" class="mb ir hi bd is mc md me iw mf mg mh ja jz mi mj je kd mk ml ji kh mm mn jm mo bi translated">å»ºç­‘å¼€å‘ç¯å¢ƒ</h2><p id="369f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi km translated"><span class="l kn ko kp bm kq kr ks kt ku di"> C </span>åˆ›å»ºä¸€ä¸ªåä¸º<strong class="jq hj"> todo-app </strong>çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨<strong class="jq hj"> todo-app </strong>æ–‡ä»¶å¤¹ä¸­å†åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«åä¸º<strong class="jq hj"> server </strong>å’Œ<strong class="jq hj"> client </strong>ã€‚</p><p id="9beb" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æ‰“å¼€<strong class="jq hj"> todo-app/server </strong>æ–‡ä»¶å¤¹ï¼Œè¿è¡Œæ­¤å‘½ä»¤æ„å»º NodeJS é¡¹ç›®å¹¶å®‰è£…ä¾èµ–é¡¹:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="33aa" class="mb ir hi mt b fi mx my l mz na">npm init -y &amp;&amp; npm i express apollo-server-express graphql mongoose dotenv cors &amp;&amp; npm i --save-dev nodemon @babel/core @babel/node @babel/preset-env babel-loader</span></pre><p id="0402" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨åˆ›å»ºæ‚¨çš„åç«¯é¡¹ç›®ç»“æ„ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/5a0ae0a2d2a7cf8171bb73cc7ba64d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*kaWZsTRe8IYqD_jhNLFVyA.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">å®‰è£…é¡¹ç›®ä¾èµ–é¡¹æ—¶ï¼Œå°†è‡ªåŠ¨åˆ›å»º package.jsonã€package-lock.json æ–‡ä»¶å’Œ node_modules ç›®å½•ã€‚å› æ­¤æ‚¨ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»ºå®ƒä»¬ã€‚</figcaption></figure><p id="d69f" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">åˆ›å»ºæ‰€æœ‰æ–‡ä»¶å’Œç›®å½•åï¼Œæ‰“å¼€ã€‚babelrc æ–‡ä»¶ï¼Œå¹¶å°†è¿™å‡ è¡Œå†™å…¥å…¶ä¸­:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="7031" class="mb ir hi mt b fi mx my l mz na">{</span><span id="0272" class="mb ir hi mt b fi ng my l mz na">"presets": ["@babel/env"]</span><span id="1d57" class="mb ir hi mt b fi ng my l mz na">}</span></pre><p id="44ad" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æˆ‘ä»¬åœ¨ä¸­è¿›è¡Œçš„é…ç½®ã€‚babelrc æ–‡ä»¶å°†æä¾›æˆ‘ä»¬åœ¨æ¨¡å—å¯¼å…¥æ—¶ä½¿ç”¨ ES6ã€‚</p><p id="7353" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">åœ¨è¿›ä¸€æ­¥è®¨è®ºæœåŠ¡å™¨é…ç½®ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª MongoDB äº‘å¸æˆ·ã€‚</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><h2 id="96a3" class="mb ir hi bd is mc md me iw mf mg mh ja jz mi mj je kd mk ml ji kh mm mn jm mo bi translated">MongoDB é…ç½®</h2><p id="ea12" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi km translated"><span class="l kn ko kp bm kq kr ks kt ku di">ä¸ºäº†</span>é…ç½® MongoDBï¼Œè®©æˆ‘ä»¬åœ¨ mongodb.com/cloud çš„<a class="ae lt" href="https://www.mongodb.com/cloud" rel="noopener ugc nofollow" target="_blank">åˆ›å»ºä¸€ä¸ªè´¦æˆ·ã€‚ç¨åï¼Œåˆ›å»ºä¸€ä¸ªç»„ç»‡ã€ç»„ç»‡ä¸­çš„ä¸€ä¸ªé¡¹ç›®å’Œé¡¹ç›®ä¸­çš„ä¸€ä¸ªç¾¤ã€‚åˆ›å»ºé›†ç¾¤åï¼Œåœ¨é›†ç¾¤æ‰€åœ¨çš„é¡µé¢ä¸­ï¼Œå•å‡»æ•°æ®åº“è®¿é—®ã€‚åœ¨é‚£é‡Œå•å‡»æ·»åŠ æ–°æ•°æ®åº“ç”¨æˆ·é€‰é¡¹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ç”¨æˆ·ã€‚ç¨åï¼Œå•å‡»å·¦ä¾§æ ä¸Šçš„é›†ç¾¤é€‰é¡¹ã€‚åœ¨æ‰“å¼€çš„é¡µé¢ä¸Šï¼Œå•å‡»è¿æ¥æŒ‰é’®ã€‚åœ¨â€œè®¾ç½®è¿æ¥å®‰å…¨æ€§â€æ­¥éª¤ä¸­ï¼Œé€‰æ‹©â€œå…è®¸ä»»ä½•åœ°æ–¹â€é€‰é¡¹ï¼Œç„¶åå•å‡»â€œé€‰æ‹©è¿æ¥æ–¹æ³•â€ã€‚ç„¶åï¼Œè®©æˆ‘ä»¬å•å‡»è¿æ¥æ‚¨çš„åº”ç”¨ç¨‹åºé€‰é¡¹ï¼Œå¹¶å¤åˆ¶<strong class="jq hj">ä¸‹çš„è¿æ¥ä¿¡æ¯ï¼Œå°†æ‚¨çš„è¿æ¥å­—ç¬¦ä¸²æ·»åŠ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä»£ç </strong>ã€‚<strong class="jq hj"> </strong>è®©æˆ‘ä»¬å›åˆ°æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œåœ¨ã€‚env æ–‡ä»¶ï¼Œå¹¶å°† MongoDB è¿æ¥ä¿¡æ¯èµ‹ç»™è¯¥å˜é‡ã€‚ä½¿ç”¨åˆšåˆšåœ¨æ•°æ®åº“è®¿é—®æ­¥éª¤ä¸­åˆ›å»ºçš„å¯†ç è¿›è¡Œæ›´æ”¹ï¼Œå¹¶å°†<strong class="jq hj"> myFirstDatabase </strong>æ›´æ”¹ä¸º<strong class="jq hj"> todolist </strong>:</a></p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="cfad" class="mb ir hi mt b fi mx my l mz na">MONGODB_URL="mongodb+srv://username:12345@cluster0.mjh9d.mongodb.net/todolist?retryWrites=true&amp;w=majority"</span></pre><p id="aecb" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨ï¼Œæ‰“å¼€<strong class="jq hj"> db/connection/index.js </strong>æ–‡ä»¶ï¼Œå†™ä¸‹è¿™å‡ è¡Œ:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="53cd" class="mb ir hi mt b fi mx my l mz na">import dotenv from "dotenv";</span><span id="d081" class="mb ir hi mt b fi ng my l mz na">import mongoose from "mongoose";</span><span id="3195" class="mb ir hi mt b fi ng my l mz na">dotenv.config();</span><span id="4e68" class="mb ir hi mt b fi ng my l mz na">const dbConnection = () =&gt;</span><span id="a803" class="mb ir hi mt b fi ng my l mz na">  new Promise((resolve, reject) =&gt; {</span><span id="eeb4" class="mb ir hi mt b fi ng my l mz na">    mongoose.connect(process.env.MONGODB_URL, {</span><span id="55cb" class="mb ir hi mt b fi ng my l mz na">      useNewUrlParser: true,</span><span id="cc81" class="mb ir hi mt b fi ng my l mz na">      useUnifiedTopology: true,</span><span id="605a" class="mb ir hi mt b fi ng my l mz na">      useFindAndModify: false,</span><span id="77eb" class="mb ir hi mt b fi ng my l mz na">    });</span><span id="d67d" class="mb ir hi mt b fi ng my l mz na">  const db = mongoose.connection;</span><span id="ab08" class="mb ir hi mt b fi ng my l mz na">  db.on("error", () =&gt; {</span><span id="415a" class="mb ir hi mt b fi ng my l mz na">    console.error.bind(console, "connection error:");</span><span id="4444" class="mb ir hi mt b fi ng my l mz na">      reject(</span><span id="7690" class="mb ir hi mt b fi ng my l mz na">        new Error(</span><span id="686a" class="mb ir hi mt b fi ng my l mz na">          "Connection error has occurred when trying to connect to the database!"</span><span id="d28f" class="mb ir hi mt b fi ng my l mz na">      )</span><span id="1d83" class="mb ir hi mt b fi ng my l mz na">    );</span><span id="6c20" class="mb ir hi mt b fi ng my l mz na">  });</span><span id="59a6" class="mb ir hi mt b fi ng my l mz na">  db.once("open", () =&gt; resolve("ğŸš€ Successful database connection."));</span><span id="fdd0" class="mb ir hi mt b fi ng my l mz na">});</span><span id="5c0d" class="mb ir hi mt b fi ng my l mz na">export default dbConnection;</span></pre><p id="c10f" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">é€šè¿‡è¿™ä¸ªé…ç½®ï¼Œæˆ‘ä»¬å®šä¹‰äº† MongoDB çš„è¿æ¥ä¿¡æ¯ï¼Œå¹¶æä¾›äº†ä¸€ä¸ª promise å‡½æ•°ï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ã€‚åœ¨ç”¨ JavaScript ç¼–å†™åç«¯é¡¹ç›®æ—¶ï¼Œå°½å¯èƒ½å¤šåœ°åˆ›å»º Promise å‡½æ•°å¹¶æ·»åŠ é”™è¯¯å¤„ç†è¡Œæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚</p><p id="6c49" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç¨åï¼Œæ‰“å¼€<strong class="jq hj"> db/models/TodoModel.js </strong>æ–‡ä»¶ï¼Œç”¨ä»¥ä¸‹å‡ è¡Œå¡«å……å®ƒ:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="ff3d" class="mb ir hi mt b fi mx my l mz na">import mongoose from "mongoose";<br/></span><span id="f4ca" class="mb ir hi mt b fi ng my l mz na">const todoSchema = new mongoose.Schema({</span><span id="4816" class="mb ir hi mt b fi ng my l mz na">  user: String,</span><span id="eb6d" class="mb ir hi mt b fi ng my l mz na">  title: String,</span><span id="514d" class="mb ir hi mt b fi ng my l mz na">  mission: String,</span><span id="b35e" class="mb ir hi mt b fi ng my l mz na">  isDone: Boolean,</span><span id="fafe" class="mb ir hi mt b fi ng my l mz na">},</span><span id="1e1a" class="mb ir hi mt b fi ng my l mz na">{ timestamps: true });</span><span id="2df5" class="mb ir hi mt b fi ng my l mz na">const Todo = mongoose.model("Todo", todoSchema);</span><span id="1bf9" class="mb ir hi mt b fi ng my l mz na">export default Todo;</span></pre><p id="95ee" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†é›†åˆçš„æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å°†æ”¾åœ¨æ•°æ®åº“ä¸­ï¼Œå¹¶ä»è¯¥æ¨¡å¼ä¸­å¤åˆ¶ä¸€ä¸ªæ¨¡å‹ã€‚è®©æˆ‘ä»¬ç»§ç»­æœåŠ¡å™¨é…ç½®ï¼Œå¹¶è¿è¡ŒæœåŠ¡å™¨ä»¥è¿æ¥åˆ°æ•°æ®åº“ã€‚</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><h2 id="9cfc" class="mb ir hi bd is mc md me iw mf mg mh ja jz mi mj je kd mk ml ji kh mm mn jm mo bi translated">æœåŠ¡å™¨é…ç½®</h2><p id="c274" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi km translated">ä¸‹é¢æˆ‘ä»¬å·²ç»åˆ›å»ºäº† MongoDB é…ç½®ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å®ƒï¼</p><p id="fe96" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æ‰“å¼€<strong class="jq hj"> server.js </strong>æ–‡ä»¶ï¼Œå°†è¿™äº›è¡Œå†™å…¥å…¶ä¸­:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="aa90" class="mb ir hi mt b fi mx my l mz na">import express from "express";</span><span id="8a91" class="mb ir hi mt b fi ng my l mz na">import dbConnection from "./db/connection";</span><span id="76ea" class="mb ir hi mt b fi ng my l mz na">const startServer = async () =&gt; {</span><span id="a824" class="mb ir hi mt b fi ng my l mz na">  await dbConnection()</span><span id="9c89" class="mb ir hi mt b fi ng my l mz na">    .then((result) =&gt; console.log(result))</span><span id="602d" class="mb ir hi mt b fi ng my l mz na">    .catch((err) =&gt; console.log(err));</span><span id="8ce8" class="mb ir hi mt b fi ng my l mz na">  const app = express();</span><span id="d203" class="mb ir hi mt b fi ng my l mz na"><br/>  app.use("/", (req, res) =&gt; res.send("Welcome to Todo App"));</span><span id="7630" class="mb ir hi mt b fi ng my l mz na">app.listen(4000, () =&gt; console.log(`ğŸš€ Server listening on port 4000`));</span><span id="a9e3" class="mb ir hi mt b fi ng my l mz na">};</span><span id="5943" class="mb ir hi mt b fi ng my l mz na">startServer();</span></pre><p id="7cff" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨æ‰“å¼€<strong class="jq hj"> package.json </strong>æ–‡ä»¶ï¼Œå°†è¿™ä¸€è¡Œå†™å…¥è„šæœ¬éƒ¨åˆ†:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="c260" class="mb ir hi mt b fi mx my l mz na">"start": "nodemon ./server --exec babel-node -e js",</span></pre><p id="0d2a" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç¼–å†™å®Œå¯åŠ¨è„šæœ¬åï¼Œæ‚¨çš„<strong class="jq hj"> package.json </strong>çš„è„šæœ¬éƒ¨åˆ†åº”è¯¥å¦‚ä¸‹æ‰€ç¤º:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="25cb" class="mb ir hi mt b fi mx my l mz na">"scripts": {</span><span id="da06" class="mb ir hi mt b fi ng my l mz na">  "start": "nodemon ./server --exec babel-node -e js",</span><span id="520b" class="mb ir hi mt b fi ng my l mz na">  "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"</span><span id="b5f4" class="mb ir hi mt b fi ng my l mz na">},</span></pre><p id="846e" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æ‰“å¼€æ§åˆ¶å°ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡ŒæœåŠ¡å™¨:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="f97f" class="mb ir hi mt b fi mx my l mz na">npm start</span></pre><p id="6a3a" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">å¦‚æœæ‚¨åœ¨ç»ˆç«¯çš„è¾“å‡ºä¸Šçœ‹åˆ°è¿™ä¸¤æ¡æ¶ˆæ¯ï¼Œè¿™æ„å‘³ç€æ‚¨æˆåŠŸåœ°è¿›è¡Œäº†é…ç½®:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="aa4b" class="mb ir hi mt b fi mx my l mz na">ğŸš€ Successful database connection.<br/>ğŸš€ Server listening on port 4000</span></pre><p id="850c" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æ˜¯æ—¶å€™æ„å»º GraphQL æ¨¡å¼å¹¶è¿è¡Œ Apollo æœåŠ¡å™¨äº†ï¼</p></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><h2 id="cb96" class="mb ir hi bd is mc md me iw mf mg mh ja jz mi mj je kd mk ml ji kh mm mn jm mo bi translated">æ„å»º GrapQL æ¨¡å¼å’Œ Apollo æœåŠ¡å™¨</h2><p id="038d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi km translated">è¦æ„å»ºä¸€ä¸ª GraphQL ç»“æ„ï¼Œä»åˆ›å»ºç±»å‹å®šä¹‰å¼€å§‹æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€<strong class="jq hj">schema/typeDefs/index . js</strong>æ–‡ä»¶ï¼Œå¹¶ç¼–å†™ä»¥ä¸‹å‡ è¡Œ:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="e85c" class="mb ir hi mt b fi mx my l mz na">import { gql } from "apollo-server-express";</span><span id="96b4" class="mb ir hi mt b fi ng my l mz na">const typeDefs = gql`</span><span id="363b" class="mb ir hi mt b fi ng my l mz na">  type Todo {</span><span id="53ba" class="mb ir hi mt b fi ng my l mz na">    user: String</span><span id="f625" class="mb ir hi mt b fi ng my l mz na">    title: String</span><span id="1e68" class="mb ir hi mt b fi ng my l mz na">    mission: String</span><span id="7281" class="mb ir hi mt b fi ng my l mz na">    createdAt: String</span><span id="36ea" class="mb ir hi mt b fi ng my l mz na">    updatedAt: String</span><span id="cfc5" class="mb ir hi mt b fi ng my l mz na">    isDone: Boolean</span><span id="a01b" class="mb ir hi mt b fi ng my l mz na"> }</span><span id="d3de" class="mb ir hi mt b fi ng my l mz na">  input TodoInput {</span><span id="9743" class="mb ir hi mt b fi ng my l mz na">    user: String</span><span id="3a0e" class="mb ir hi mt b fi ng my l mz na">    title: String</span><span id="d75e" class="mb ir hi mt b fi ng my l mz na">    mission: String</span><span id="c4f3" class="mb ir hi mt b fi ng my l mz na">    isDone: Boolean</span><span id="94dd" class="mb ir hi mt b fi ng my l mz na">  }</span><span id="1fd7" class="mb ir hi mt b fi ng my l mz na">  type Query {</span><span id="3a1b" class="mb ir hi mt b fi ng my l mz na">    getTodoList: [Todo]</span><span id="58e3" class="mb ir hi mt b fi ng my l mz na">  }</span><span id="01c8" class="mb ir hi mt b fi ng my l mz na">  type Mutation {</span><span id="d925" class="mb ir hi mt b fi ng my l mz na">    addTodo(todo: TodoInput): Todo</span><span id="73e3" class="mb ir hi mt b fi ng my l mz na">  }`;<br/></span><span id="f2ac" class="mb ir hi mt b fi ng my l mz na">export default typeDefs;</span></pre><p id="f9f0" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">è¿™æ ·ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªä¸æ•°æ®åº“é›†åˆæ¨¡å¼å¹¶è¡Œçš„ Todo ç±»å‹ï¼Œä¸€ä¸ªä¸ Todo ç±»å‹å’Œ Todo æ¨¡å¼å¹¶è¡Œçš„è¾“å…¥ç±»å‹ã€‚æˆ‘ä»¬è¿˜å®šä¹‰äº†å†…ç½®çš„ GraphQL ç±»å‹:æŸ¥è¯¢å’Œå˜å¼‚ã€‚æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ª<strong class="jq hj">è§£æå™¨</strong>å¯¹è±¡ï¼Œæˆ‘ä»¬å°†ä¸ºå…¶ä¸­çš„æŸ¥è¯¢å’Œå˜å¼‚ç±»å‹ä½¿ç”¨ç›¸åŒçš„å±æ€§åï¼›æ­¤å¤–ï¼Œæˆ‘ä»¬å°†æŠŠ MongoDB æŸ¥è¯¢å‡½æ•°åˆ†é…ç»™<strong class="jq hj">è§£æå™¨</strong>å¯¹è±¡ä¸­çš„å±æ€§ã€‚æˆ‘ä»¬å°†æŠŠæŸ¥è¯¢å‡½æ•°å†™å…¥æ¨¡å‹ã€‚ç¨åï¼Œæˆ‘ä»¬å°†åˆå¹¶ Apollo æœåŠ¡å™¨é…ç½®ä¸­çš„ç±»å‹å®šä¹‰ã€è§£æå™¨å’Œæ¨¡å‹ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°†å»ºç«‹<strong class="jq hj">ç±»å‹å®šä¹‰ã€</strong><strong class="jq hj">è§£æå™¨ã€</strong>å’Œ<strong class="jq hj">æ¨¡å‹</strong>ä¹‹é—´çš„å…³ç³»ã€‚</p><p id="68f6" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºæ¨¡å‹ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€<strong class="jq hj"> schema/models/index.js </strong>æ–‡ä»¶ï¼Œå°†ä»¥ä¸‹å‡ è¡Œå†™å…¥å…¶ä¸­:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="3b5a" class="mb ir hi mt b fi mx my l mz na">import Todo from "../../db/models/TodoModel";</span><span id="a936" class="mb ir hi mt b fi ng my l mz na">const generateTodoModel = () =&gt; ({</span><span id="4aac" class="mb ir hi mt b fi ng my l mz na">queries: {</span><span id="1590" class="mb ir hi mt b fi ng my l mz na">  getAll: () =&gt;</span><span id="1e7e" class="mb ir hi mt b fi ng my l mz na">    new Promise(</span><span id="b991" class="mb ir hi mt b fi ng my l mz na">      async (resolve, reject) =&gt;</span><span id="5a2f" class="mb ir hi mt b fi ng my l mz na">        await Todo.find({}, (err, todo) =&gt;</span><span id="ff97" class="mb ir hi mt b fi ng my l mz na">          err ? reject(err) : resolve(todo)</span><span id="a1db" class="mb ir hi mt b fi ng my l mz na">      )<br/>    ),</span><span id="dd92" class="mb ir hi mt b fi ng my l mz na">  },</span><span id="00c2" class="mb ir hi mt b fi ng my l mz na">  mutations: {</span><span id="2f65" class="mb ir hi mt b fi ng my l mz na">    addTodo: (todo) =&gt;</span><span id="bc9f" class="mb ir hi mt b fi ng my l mz na">      new Promise((resolve, reject) =&gt;</span><span id="e35d" class="mb ir hi mt b fi ng my l mz na">        new Todo(todo).save((err, todo) =&gt; (err ? reject(err) : resolve(todo)))</span><span id="5aca" class="mb ir hi mt b fi ng my l mz na">      ),</span><span id="b342" class="mb ir hi mt b fi ng my l mz na">  },</span><span id="863a" class="mb ir hi mt b fi ng my l mz na">});</span><span id="cb7a" class="mb ir hi mt b fi ng my l mz na">export default generateTodoModel;</span></pre><p id="b0ca" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">è¿™æ ·ï¼Œæˆ‘ä»¬å°±åˆ›å»ºäº†å°†åœ¨å¯¼å…¥çš„ Todo æ¨¡å‹ä¸Šæ‰§è¡Œçš„æŸ¥è¯¢å‡½æ•°ï¼Œå¹¶å°†è¿™äº›å‡½æ•°åˆ†é…ç»™æˆ‘ä»¬åˆ›å»ºçš„ GraphQL æ¨¡å¼ä¸­çš„æ¨¡å‹ã€‚ç¨åï¼Œåœ¨è§£æå™¨å¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡åœ¨ Apollo æœåŠ¡å™¨ä¸­å®šä¹‰çš„ä¸Šä¸‹æ–‡å¯¹è±¡è°ƒç”¨è¿™äº›å‡½æ•°ï¼Œå¹¶å°†å®ƒä»¬ä½œä¸ºå€¼åˆ†é…ç»™å±æ€§ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»º resolver å¯¹è±¡å¹¶å°† console.log()å‡½æ•°åˆ†é…ç»™å±æ€§ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€<strong class="jq hj">schema/resolvers/index . js</strong>å¹¶å°†è¿™äº›è¡Œå†™å…¥å…¶ä¸­:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="6c8c" class="mb ir hi mt b fi mx my l mz na">const resolvers = {</span><span id="7171" class="mb ir hi mt b fi ng my l mz na">  Query: {</span><span id="2d71" class="mb ir hi mt b fi ng my l mz na">    getTodoList: async (parent, args, context) =&gt;</span><span id="5182" class="mb ir hi mt b fi ng my l mz na">      console.log(JSON.parse(JSON.stringify(args.todo)), context)</span><span id="8614" class="mb ir hi mt b fi ng my l mz na">  },</span><span id="6954" class="mb ir hi mt b fi ng my l mz na">  Mutation: {</span><span id="7314" class="mb ir hi mt b fi ng my l mz na">    addTodo: async (parent, args, context) =&gt;</span><span id="55f9" class="mb ir hi mt b fi ng my l mz na">      console.log(JSON.parse(JSON.stringify(args.todo)), context)</span><span id="0a2c" class="mb ir hi mt b fi ng my l mz na">  },</span><span id="d595" class="mb ir hi mt b fi ng my l mz na">};</span><span id="e93a" class="mb ir hi mt b fi ng my l mz na">export default resolvers;</span></pre><p id="21b1" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†<strong class="jq hj">ç±»å‹å®šä¹‰</strong>ã€<strong class="jq hj">ã€</strong>ã€<strong class="jq hj">è§£æå™¨</strong>ã€<strong class="jq hj">T22ã€<strong class="jq hj">æ¨¡å‹</strong>ã€‚æ˜¯æ—¶å€™åˆ›å»º Apollo æœåŠ¡å™¨é…ç½®å¹¶ä¸é‚£äº› GraphQL å…ƒç´ å»ºç«‹å…³ç³»äº†ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‰“å¼€<strong class="jq hj"> server.js æ–‡ä»¶</strong>å¹¶åƒè¿™æ ·ä¿®æ”¹å®ƒ:</strong></p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="2c25" class="mb ir hi mt b fi mx my l mz na">import express from "express";</span><span id="92d0" class="mb ir hi mt b fi ng my l mz na">import { ApolloServer } from "apollo-server-express";</span><span id="29f4" class="mb ir hi mt b fi ng my l mz na">import typeDefs from "./schema/typeDefs";</span><span id="8bf2" class="mb ir hi mt b fi ng my l mz na">import resolvers from "./schema/resolvers";</span><span id="e5b8" class="mb ir hi mt b fi ng my l mz na">import generateTodoModel from "./schema/models";</span><span id="e1a3" class="mb ir hi mt b fi ng my l mz na">import dbConnection from "./db/connection";</span><span id="1804" class="mb ir hi mt b fi ng my l mz na">import cors from "cors"<br/></span><span id="ff01" class="mb ir hi mt b fi ng my l mz na">const startApolloServer = async () =&gt; {</span><span id="e90b" class="mb ir hi mt b fi ng my l mz na">  await dbConnection()</span><span id="5d35" class="mb ir hi mt b fi ng my l mz na">    .then((result) =&gt; console.log(result))</span><span id="3df3" class="mb ir hi mt b fi ng my l mz na">    .catch((err) =&gt; console.log(err));</span><span id="a07e" class="mb ir hi mt b fi ng my l mz na">  const app = express();<br/>  app.use(cors())</span><span id="331a" class="mb ir hi mt b fi ng my l mz na">  const server = new ApolloServer({</span><span id="2f89" class="mb ir hi mt b fi ng my l mz na">    typeDefs,</span><span id="0353" class="mb ir hi mt b fi ng my l mz na">    resolvers,</span><span id="edbf" class="mb ir hi mt b fi ng my l mz na">    subscriptions: { path: "/subscriptions" },</span><span id="dd1f" class="mb ir hi mt b fi ng my l mz na">    context: ({ req }) =&gt; {</span><span id="1d8c" class="mb ir hi mt b fi ng my l mz na">      return {</span><span id="3d22" class="mb ir hi mt b fi ng my l mz na">        models: {</span><span id="2f08" class="mb ir hi mt b fi ng my l mz na">          Todo: generateTodoModel(),</span><span id="a899" class="mb ir hi mt b fi ng my l mz na">        },</span><span id="3bf1" class="mb ir hi mt b fi ng my l mz na">      };</span><span id="b885" class="mb ir hi mt b fi ng my l mz na">    },</span><span id="8685" class="mb ir hi mt b fi ng my l mz na">  });</span><span id="1f83" class="mb ir hi mt b fi ng my l mz na">  await server.start();</span><span id="08dc" class="mb ir hi mt b fi ng my l mz na">  server.applyMiddleware({ app });</span><span id="d7e1" class="mb ir hi mt b fi ng my l mz na">  app.use((req, res) =&gt; {</span><span id="a763" class="mb ir hi mt b fi ng my l mz na">    res.status(200);</span><span id="c2da" class="mb ir hi mt b fi ng my l mz na">    res.send("Welcome Todo App");</span><span id="68fc" class="mb ir hi mt b fi ng my l mz na">    res.end();</span><span id="d6f9" class="mb ir hi mt b fi ng my l mz na">  });<br/></span><span id="0ba0" class="mb ir hi mt b fi ng my l mz na">  await new Promise((resolve) =&gt; app.listen({ port: 4000 }, resolve));</span><span id="f04d" class="mb ir hi mt b fi ng my l mz na">  console.log(`ğŸš€ Server ready at http://localhost:4000${server.graphqlPath}`);</span><span id="5ea3" class="mb ir hi mt b fi ng my l mz na">  console.log(</span><span id="ed63" class="mb ir hi mt b fi ng my l mz na">`ğŸš€ Subscriptions ready at ws://localhost:4000${server.subscriptionsPath}`</span><span id="2bcb" class="mb ir hi mt b fi ng my l mz na">  );</span><span id="9ab8" class="mb ir hi mt b fi ng my l mz na">  return { server, app };</span><span id="cc0a" class="mb ir hi mt b fi ng my l mz na">};</span><span id="2bd0" class="mb ir hi mt b fi ng my l mz na">startApolloServer();</span></pre><p id="0121" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬æ„å»ºäº† Apollo æœåŠ¡å™¨ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºäº†<strong class="jq hj">ç±»å‹å®šä¹‰</strong>ã€<strong class="jq hj">è§£æå™¨</strong>å’Œ<strong class="jq hj">æ¨¡å‹</strong>ä¹‹é—´çš„å…³ç³»ã€‚ç°åœ¨ï¼Œæ£€æŸ¥æ‚¨ä¹‹å‰è¿è¡Œ<code class="du nh ni nj mt b">npm start</code>å‘½ä»¤çš„ç»ˆç«¯ã€‚å¦‚æœæ‚¨åœ¨ç»ˆç«¯çš„è¾“å‡ºä¸Šçœ‹åˆ°è¿™äº›æ¶ˆæ¯â€¦</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="7b7b" class="mb ir hi mt b fi mx my l mz na">ğŸš€ Successful database connection.<br/>ğŸš€ Server ready at <a class="ae lt" href="http://localhost:4000/graphql" rel="noopener ugc nofollow" target="_blank">http://localhost:4000/graphql</a><br/>ğŸš€ Subscriptions ready at <a class="ae lt" href="http://localhost:4000/subscriptions" rel="noopener ugc nofollow" target="_blank">ws://localhost:4000/subscriptions</a></span></pre><p id="d1a7" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">â€¦ç¥è´ºæ‚¨ï¼Œæ‚¨å·²ç»æˆåŠŸè¿è¡Œäº†ä¸€å° Apollo æœåŠ¡å™¨ï¼</p><p id="dffc" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ä½ åœ¨ Apollo æœåŠ¡å™¨é…ç½®ä¸­çœ‹åˆ°äº†<strong class="jq hj">ä¸Šä¸‹æ–‡</strong>åŠŸèƒ½å—ï¼Ÿå®ƒå°†æ¥è‡ª<strong class="jq hj"> express æœåŠ¡å™¨</strong>çš„<strong class="jq hj"> req </strong>å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚ç„¶è€Œï¼Œå®ƒç°åœ¨ä¸ç”¨å®ƒäº†ã€‚æ— è®ºå¦‚ä½•ï¼Œæ›´é‡è¦çš„æ˜¯çœ‹çœ‹<strong class="jq hj">ä¸Šä¸‹æ–‡</strong>å‡½æ•°è¿”å›ä»€ä¹ˆâ€”â€”å®ƒè¿”å›æˆ‘ä»¬åœ¨ GraphQL æ¨¡å¼ä¸­å®šä¹‰çš„æ¨¡å‹ï¼</p><p id="51e3" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨ï¼Œåœ¨è§£æå™¨ä¸­ï¼Œè®©æˆ‘ä»¬è°ƒç”¨æ¨¡å‹ä¸­å®šä¹‰çš„å‡½æ•°ã€‚è®°ä½ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæ˜¯å°†æŸ¥è¯¢å…ƒç´ è®°å½•åˆ°æ§åˆ¶å°ã€‚è®©æˆ‘ä»¬é€šè¿‡è§£æå™¨è¿è¡Œä¸€ä¸ªçœŸæ­£çš„æ•°æ®åº“æŸ¥è¯¢ï¼Œè€Œä¸æ˜¯ä»…ä»…å°†äº‹æƒ…è®°å½•åˆ°æ§åˆ¶å°ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€<strong class="jq hj">schema/resolvers/index . js</strong>å¹¶è¿›è¡Œå¦‚ä¸‹æ›´æ”¹:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="2515" class="mb ir hi mt b fi mx my l mz na">const resolvers = {</span><span id="984d" class="mb ir hi mt b fi ng my l mz na">  Query: {</span><span id="6fec" class="mb ir hi mt b fi ng my l mz na">    getTodoList: async (parent, args, context) =&gt;</span><span id="87ef" class="mb ir hi mt b fi ng my l mz na">      await context.models.Todo.queries.getAll(),</span><span id="1e28" class="mb ir hi mt b fi ng my l mz na">  },</span><span id="0efd" class="mb ir hi mt b fi ng my l mz na">  Mutation: {</span><span id="b30a" class="mb ir hi mt b fi ng my l mz na">    addTodo: async (parent, args, context) =&gt;</span><span id="bf27" class="mb ir hi mt b fi ng my l mz na">      await context.models.Todo.mutations.addTodo(</span><span id="aa52" class="mb ir hi mt b fi ng my l mz na">        JSON.parse(JSON.stringify(args.todo))</span><span id="6890" class="mb ir hi mt b fi ng my l mz na">      ),</span><span id="46f8" class="mb ir hi mt b fi ng my l mz na">  },</span><span id="1a64" class="mb ir hi mt b fi ng my l mz na">};</span><span id="0ae8" class="mb ir hi mt b fi ng my l mz na">export default resolvers;</span></pre><p id="cf64" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æœ‰äº†è¿™ä¸ªé…ç½®ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿä½¿ç”¨ GraphQL æŸ¥è¯¢è¯­è¨€è¿è¡Œ MongoDB æŸ¥è¯¢ã€‚è¦è¿è¡Œä¸€ä¸ªçœŸæ­£çš„æŸ¥è¯¢ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<a class="ae lt" href="http://localhost:4000/graphql" rel="noopener ugc nofollow" target="_blank">http://localhost:4000/graph QL</a>åœ°å€ï¼Œç„¶åè¿è¡Œä¸€ä¸ªå°†åˆ›å»ºä¸€ä¸ªæ–° todo çš„å˜å¼‚ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/ce0200501117f7c0adc7f362ade6962f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bffSJLcj_36meD8kCrhkaQ.png"/></div></div></figure><p id="8709" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">å¦‚æœæ‚¨çœ‹åˆ°äº†<strong class="jq hj">æ•°æ®</strong>å¯¹è±¡ï¼Œè¿™æ„å‘³ç€æ‚¨å·²ç»å®Œæˆäº†æ­£ç¡®çš„é…ç½®ï¼Œå¹¶ä¸”å·²ç»å‘ MongoDB æ·»åŠ äº†ä¸€ä¸ª todo å¯¹è±¡ã€‚ä¸ºäº†ç¡®ä¿å®‰å…¨ï¼Œè¯·æŸ¥çœ‹ MongoDB é›†åˆã€‚å•å‡» MongoDB äº‘ä¸­é›†ç¾¤é¡µé¢ä¸­çš„ Collections é€‰é¡¹å¡ã€‚åœ¨å‡ºç°çš„é¡µé¢ä¸Šï¼Œå•å‡»åä¸º<strong class="jq hj"> todolist </strong>çš„æ•°æ®åº“ä¸‹åä¸º<strong class="jq hj"> todo </strong>çš„é›†åˆã€‚</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nl"><img src="../Images/462abb43c754961511b69ac54d9df7b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MzgqO5awgUlXAELQBFH8vA.png"/></div></div></figure><p id="ca4d" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ·»åŠ äº†ä¸€ä¸ªæŸ¥è¯¢è§£æå™¨å’Œä¸€ä¸ªå˜å¼‚è§£æå™¨ã€‚è®©æˆ‘ä»¬å†æ·»åŠ ä¸¤ä¸ªå˜å¼‚è§£æå™¨æ¥ä¿®æ”¹å’Œåˆ é™¤ todo é¡¹ã€‚ä¸ºæ­¤ï¼Œæ‰“å¼€<strong class="jq hj"> schema/models/index.js </strong>æ–‡ä»¶ï¼Œå¹¶å°†è¿™äº›å‡½æ•°å†™å…¥<strong class="jq hj">çªå˜</strong>å¯¹è±¡:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="e843" class="mb ir hi mt b fi mx my l mz na">modifyItem: (body) =&gt;</span><span id="a4ee" class="mb ir hi mt b fi ng my l mz na">  new Promise(</span><span id="1b4e" class="mb ir hi mt b fi ng my l mz na">    async (resolve, reject) =&gt;</span><span id="1b69" class="mb ir hi mt b fi ng my l mz na">      await Todo.findByIdAndUpdate(body.id, body.query, (err, todo) =&gt;</span><span id="b75d" class="mb ir hi mt b fi ng my l mz na">        err ? reject(err) : resolve(todo)</span><span id="3bdf" class="mb ir hi mt b fi ng my l mz na">        )</span><span id="097d" class="mb ir hi mt b fi ng my l mz na">  ),</span><span id="0b7b" class="mb ir hi mt b fi ng my l mz na">  deleteItem: (id) =&gt;</span><span id="6d5d" class="mb ir hi mt b fi ng my l mz na">    new Promise(</span><span id="0e6d" class="mb ir hi mt b fi ng my l mz na">      async (resolve, reject) =&gt;</span><span id="ed24" class="mb ir hi mt b fi ng my l mz na">        await Todo.findByIdAndDelete(id, (err, todo) =&gt;</span><span id="b301" class="mb ir hi mt b fi ng my l mz na">          err ? reject(err) : resolve(todo)</span><span id="bea5" class="mb ir hi mt b fi ng my l mz na">        )</span><span id="dd4c" class="mb ir hi mt b fi ng my l mz na">   ),</span></pre><p id="0513" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç„¶åè½¬åˆ°<strong class="jq hj">schema/resolvers/index . js</strong>æ–‡ä»¶ï¼Œå°†è¿™äº›è¡Œå†™å…¥<strong class="jq hj">çªå˜</strong>:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="8e9d" class="mb ir hi mt b fi mx my l mz na">modifyItem: async (parent, args, context) =&gt;</span><span id="2b7f" class="mb ir hi mt b fi ng my l mz na">  await context.models.Todo.mutations.modifyItem(</span><span id="8541" class="mb ir hi mt b fi ng my l mz na">    JSON.parse(JSON.stringify(args))</span><span id="d3ff" class="mb ir hi mt b fi ng my l mz na">  ),</span><span id="eee7" class="mb ir hi mt b fi ng my l mz na">deleteItem: async (parent, args, context) =&gt;</span><span id="5134" class="mb ir hi mt b fi ng my l mz na">  await context.models.Todo.mutations.deleteItem(</span><span id="65c8" class="mb ir hi mt b fi ng my l mz na">    JSON.parse(JSON.stringify(args.id))</span><span id="4b07" class="mb ir hi mt b fi ng my l mz na">  ),</span></pre><p id="3bde" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">æœ€åï¼Œè½¬åˆ°<strong class="jq hj">schema/typeDefs/index . js</strong>æ–‡ä»¶ï¼Œå°†è¿™äº›è¡Œå†™å…¥<strong class="jq hj">çªå˜</strong>ç±»å‹:</p><pre class="lp lq lr ls fd ms mt mu mv aw mw bi"><span id="9fcc" class="mb ir hi mt b fi mx my l mz na">modifyItem(id: ID!, query: TodoInput): Todo</span><span id="01a7" class="mb ir hi mt b fi ng my l mz na">deleteItem(id: ID!): Todo</span></pre><p id="688e" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ç°åœ¨ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<a class="ae lt" href="http://localhost:4000/graphql" rel="noopener ugc nofollow" target="_blank">http://localhost:4000/graph QL</a>ã€‚å¹¶è¿è¡Œ<strong class="jq hj"> GetTodos </strong>æŸ¥è¯¢:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/f9e36648fc96608796574af1f45dca33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeMc3zSJ-DZoMWxjZI1RkA.png"/></div></div></figure><p id="899f" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ä»è¿”å›å€¼ä¸­å¤åˆ¶<strong class="jq hj"> _id </strong>å±æ€§ï¼Œåœ¨ Apollo playground ä¸Šæ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾ï¼Œç„¶åè¿è¡Œä¸€ä¸ª<strong class="jq hj"> ModifyItem </strong>å˜å¼‚ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nm"><img src="../Images/56d38b19006a725506a204b696a7b108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BG3xSblv3QwBIjAhThcjQ.png"/></div></div></figure><p id="0a9e" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">è¯·å‚è§<strong class="jq hj"> updatedAt </strong>å’Œ<strong class="jq hj"> isDone </strong>å±æ€§å·²æ›´æ”¹ã€‚åœ¨ MongoDB è¿æ¥é…ç½®ä¸­ï¼Œæˆ‘ä»¬æä¾›äº† updateAt å±æ€§ä»¥åœ¨æ¯ä¸ªæ›´æ–°æ“ä½œä¸­è¿›è¡Œæ›´æ”¹ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»é€šè¿‡åœ¨ Apollo æœåŠ¡å™¨ä¸Šè¿è¡Œçš„æŸ¥è¯¢æ›´æ”¹äº†<strong class="jq hj"> isDone </strong>ã€‚è®©æˆ‘ä»¬è¿è¡Œä¸€ä¸ªåˆ é™¤æŸ¥è¯¢ã€‚åœ¨ playground ä¸­æ‰“å¼€ä¸€ä¸ªæ–°çš„é€‰é¡¹å¡ï¼Œç„¶ååƒè¿™æ ·è¿è¡Œä¸€ä¸ªåˆ é™¤æŸ¥è¯¢:</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nm"><img src="../Images/96bbc46051c45990b521cf303bc51c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-Bzdsdc_-8Sj7uefN4oQw.png"/></div></div></figure><p id="9caa" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬æœ‰ä¸€ä¸ªå¯ä»¥è¿è¡Œ GraphQL æŸ¥è¯¢çš„ APIï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª NoSQL æ•°æ®åº“ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸ express.js é›†æˆçš„ Apollo æœåŠ¡å™¨ã€‚å¹²å¾—å¥½ï¼</p><p id="7ba9" class="pw-post-body-paragraph jo jp hi jq b jr kv jt ju jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl hb bi translated">ä¸‹æ¬¡æˆ‘ä»¬å°†åŸºäº API è°ƒç”¨å¤åˆ¶ JSON Web Tokenï¼Œå¹¶åœ¨ Apollo æœåŠ¡å™¨ä¸Šè¿›è¡Œç”¨æˆ·è®¤è¯å’Œæˆæƒé…ç½®ï¼</p></div></div>    
</body>
</html>