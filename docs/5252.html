<html>
<head>
<title>Categorical Encoding with Pandas: get_dummies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫的分类编码:get_dummies</h1>
<blockquote>原文：<a href="https://medium.com/nerd-for-tech/categorical-encoding-with-pandas-get-dummies-8feebc7d5e75?source=collection_archive---------7-----------------------#2021-09-11">https://medium.com/nerd-for-tech/categorical-encoding-with-pandas-get-dummies-8feebc7d5e75?source=collection_archive---------7-----------------------#2021-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3cca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我们将看看一个非常强大而简单的熊猫分类编码技术。</p><p id="3a33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单来说，Pandas是一个用于数据帧操作的计算库。</p><p id="8ba5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数据处理管道的数据争论阶段，对分类变量进行编码非常重要，如果不是至关重要的话。这是因为机器学习模型是使用算法处理数字数据类型的数学模型，而神经网络也处理数字数据类型。</p><p id="e0d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是为什么，我们需要编码方法将非数字数据转换成有意义的数字数据。为此我们来看看熊猫弄_假人的方法。</p><p id="475d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">get_dummies是实现hot编码方法的最简单的方法之一，它有非常有用的参数，我们将提到其中最重要的参数。</p><p id="0e50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以使用get_dummies在一行中执行热编码。</p><p id="5c0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在这个演示中使用一个工资数据集，在此下载<a class="ae jd" href="https://drive.google.com/file/d/1p9-JrjutoIZJF4gddV8Dfv-OsC41wtKs/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="357a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一数据科学流程的目标是根据其他特征预测个人的工资。我们将对这些数据使用线性回归，但这些数据还没有准备好用于机器学习模型。如果我们如何确定这一点，我们将使用pandas info()方法对数据进行描述性查看。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/46af6e105b36952305e107c62d687dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*heh3nA3vMlPSBY-ZleEw7g.png"/></div></figure><p id="40ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas使用object数据类型来表示分类变量/列，因为有分类(非数字)列，我们需要转换它们。</p><p id="d7ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们将实现get_dummies。</p><p id="7e19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">get_dummies所做的是，它为我们指定的每个目标列创建一个独热编码矩阵，但是标签编码呢，什么时候使用哪个用于哪个呢？</p><p id="1aca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">我们应用OHE(一个热编码):</strong></p><p id="c88b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当标签编码中彼此接近的值对应于不接近的目标值时(非线性数据)。</p><p id="8b67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当分类特征不是序数时(狗、猫、老鼠)。</p><p id="a8da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">我们应用标签编码(Le)当:</strong></p><p id="b3d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">范畴特征是序数(Jr. kg，Sr. kg，小学，高中等)。</p><p id="a1df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们上车吧！</p><p id="01ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们有两个分类列，我们需要分别对它们进行编码。</p><p id="1e95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从国家列开始:</p><p id="61f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们复制我们的数据，然后我们检查国家列中的唯一值</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/758314b0f891b533c996a09198b4d179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*USplQsZ_rkRwlPTTQ135aA.png"/></div></figure><p id="61ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“country”列有4个唯一值，这意味着在应用get_dummies()后我们将得到4列。</p><p id="19d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这种语法，我们可以将get_dummies应用于一列dataframe</p><p id="f357" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jn">static = PD . get _ dummies(train _ data[' country ']，prefix_sep='_ '，prefix='country') </em></p><p id="d40f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> static </strong> =保存新数据帧的变量名</p><p id="3584" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">train _ data[' country ']</strong>=数据集中的目标分类列</p><p id="a027" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> prefix_sep </strong> =干净列名的前缀分隔符参数</p><p id="1035" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">前缀</strong> =新列的前缀值</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/a797b5e690c596dc9fd1c5d48c1f435c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*hwV44oGczlRvnOg7GlkjdQ.png"/></div></figure><p id="d3ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你所看到的，在get_dummies()之后我们得到了一个4列的数据帧，有120行。</p><p id="0cd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到列名是来自train_data country列的值。</p><p id="960d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">唯一值用于形成新列，并使用1和0矩阵与其他值(现在的列)相关联。</p><p id="551a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">【drop _ first = True参数的虚拟对象</p><p id="544f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">drop_first=True参数的虚拟对象可用于删除第一列。这给我们留下了3列。通常这个参数的默认值是“假”，我们只是将其设置为“真”。让我们看看它是如何工作的。</p><p id="33e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jn">static = PD . get _ dummies(train _ data['国家']，prefix_sep='_ '，prefix= '国家'，drop_first = True) </em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/c0704e6a98a83c3ba88dd367e353f1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Hc2IYbcobEvvjA3ieku8wA.png"/></div></figure><p id="f632" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它删除get_dummies()数据帧的第一列。“静态”列的第一列是country_britain。如果国家是<strong class="ih hj">英国</strong>，所有列都是0。当所有列都为0时，模型知道国家是英国。</p><p id="69bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看看下面的例子。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/e5d0e601253f20a6f63af47eb369ef80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*E5Xe79DWmRjdXbpDCoPkSg.png"/></div></figure><p id="9830" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的原始数据帧train_data保持其形状。我们必须合并这些数据帧。</p><p id="2b90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用join或concat以两种方式合并它们。</p><p id="c8eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">串联:</strong></p><p id="ba3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用concat方法将static和train_data连接到一个数据帧中，然后删除“country”列，我们不再需要它，因为它不是数字。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/008e250382c2a86efce9641cc9847868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*GWXL7zGohl4js0ewZj5uXA.png"/></div></figure><p id="68d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们通过声明axis=1来连接列，这将并排放置我们的数据帧。</p><p id="1ec3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">消除垂直堆叠的误差，增加行并产生缺失的列和离群值。</p><p id="0470" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">加入:</strong></p><p id="ab47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用join方法将它们合并到数据框中，但是我们应该像concat一样删除“country”列，因为它不是数字。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jm"><img src="../Images/d0acbabd413d13ae78a6f852a8fdf019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*1HqKzHBRQVRyJ2vbhy4dFA.png"/></div></figure><p id="7128" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过声明axis=1来连接列，这将并排放置我们的数据帧。</p><p id="26d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有列都是数字。我们的数据现在已经为模型准备好了。</p><p id="fbd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="a4b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas get_dummies是一种令人惊叹的热编码技术，可以在建模之前对数据进行处理。这可以说是最简单的方法，它有许多参数，使我们的模型更可读，更平滑。</p></div></div>    
</body>
</html>