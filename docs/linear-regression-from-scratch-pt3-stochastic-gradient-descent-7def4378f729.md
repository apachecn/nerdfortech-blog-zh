# ä»å¤´å¼€å§‹çº¿æ€§å›å½’ PT3:éšæœºæ¢¯åº¦ä¸‹é™

> åŸæ–‡ï¼š<https://medium.com/nerd-for-tech/linear-regression-from-scratch-pt3-stochastic-gradient-descent-7def4378f729?source=collection_archive---------11----------------------->

> æ¬¢è¿å›æ¥ï¼è¿™æ˜¯çº¿æ€§å›å½’æ¨¡å‹çš„ç¬¬ 3 éƒ¨åˆ†ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢è‘—åçš„â€œéšæœºæ¢¯åº¦ä¸‹é™(SGD)â€ç®—æ³•ã€‚æˆ‘å°†å°è¯•è§£é‡Šè¿™ç§éå¸¸æµè¡Œçš„ç®—æ³•å¦‚ä½•å·¥ä½œçš„ç›´è§‰ï¼Œä»¥åŠå®ƒä¸ä¸Šä¸€ç³»åˆ—æ–‡ç« ä¸­æ¢è®¨çš„ç®€å•æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•çš„ä¸åŒä¹‹å¤„ã€‚å¦‚æœä½ æ²¡æœ‰çœ‹è¿‡ä¹‹å‰å…³äºè¿™ä¸ªä¸»é¢˜çš„æ–‡ç« ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°åµŒå…¥çš„é“¾æ¥: [**Part1**](https://mardiyyah.medium.com/linear-regression-from-scratch-pt1-484ff41e5a3) å’Œ [**Part 2**](/nerd-for-tech/linear-regression-from-scratch-pt2-the-gradient-descent-algorithm-f30d42fea40c) ã€‚è¯·åŠ¡å¿…é˜…è¯»å®ƒä»¬ï¼Œå› ä¸ºæœ¬æ–‡æ˜¯å»ºç«‹åœ¨å‰é¢è®¨è®ºçš„åŸºç¡€ä¸Šçš„ã€‚

åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨è§£å†³çº¿æ€§å›å½’é—®é¢˜æ—¶ï¼Œä½¿ç”¨æ•°å€¼æ–¹æ³•è€Œä¸æ˜¯åˆ†ææ–¹æ³•(å°é—­å½¢å¼çš„è§£å†³æ–¹æ¡ˆ)ã€‚æˆ‘ä»¬ç‰¹åˆ«æ¢ç´¢äº†ä¸€ç±»æµè¡Œçš„æ•°å€¼æ–¹æ³•ï¼›â€œæ¢¯åº¦ä¸‹é™â€ã€‚æ­£å¦‚æ‰€è§£é‡Šçš„ï¼Œå®ƒæ˜¯æœºå™¨å­¦ä¹ (åŒ…æ‹¬åƒæ·±åº¦å­¦ä¹ è¿™æ ·çš„å­é¢†åŸŸ)ä¸­ä½¿ç”¨çš„æœ€æµè¡Œçš„ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒæœ‰ä¸‰ç§å˜ä½“ï¼›

*   æ‰¹é‡æ¢¯åº¦ä¸‹é™(BGD)
*   éšæœºæ¢¯åº¦ä¸‹é™(SGD)
*   å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œä¹Ÿç§°ä¸ºå°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ã€‚(ç™¾ä¸‡æ–°å…ƒ)

æœ¬æ–‡çš„é‡ç‚¹å°†æ˜¯â€œéšæœºæ¢¯åº¦ä¸‹é™(SGD)â€ã€‚

> ****

# éšæœºæ¢¯åº¦ä¸‹é™:ç›´è§‰

å›æƒ³ä¸€ä¸‹ï¼Œåœ¨æ‰¹é‡æ¢¯åº¦ä¸‹é™(BGD)ä¸­ï¼Œæ‰€æœ‰è®­ç»ƒæ ·æœ¬(X)éƒ½ç”¨äºè®¡ç®—æ¢¯åº¦ï¼Œå¹¶åœ¨è¿­ä»£çš„å•ä¸ªæ­¥éª¤ä¸­æ›´æ–°æƒé‡ã€‚

å¯¹äºéšæœºæ¢¯åº¦ä¸‹é™(SGD)ï¼ŒåŒºåˆ«åœ¨äºæ¢¯åº¦è®¡ç®—æ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚SGD ä¸æ˜¯åŒæ—¶ä½¿ç”¨æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬ï¼Œè€Œæ˜¯éšæœºé€‰æ‹©ä¸€ä¸ªè®­ç»ƒæ ·æœ¬è¿›è¡Œæ¢¯åº¦è®¡ç®—ã€‚æˆ‘ä»€ä¹ˆæ„æ€ï¼Ÿ

è¿˜è®°å¾—æ¢¯åº¦ä¸‹é™çš„ä¼ªä»£ç å—ï¼Ÿ

*   åˆå§‹åŒ–æƒé‡çš„éšæœºçŒœæµ‹(ä»Î¸çš„éšæœºçŒœæµ‹å¼€å§‹)
*   ä½¿ç”¨â€œ**æ‰€æœ‰æ ·æœ¬(x)â€**è®¡ç®—æ¢¯åº¦
*   ä½¿ç”¨æ›´æ–°è§„åˆ™æ›´æ–°æƒé‡
*   é‡å¤ç›´åˆ°æ”¶æ•›

å¯¹äº SGDï¼Œè¿™å˜æˆäº†ï¼›

1.  åˆå§‹åŒ–æƒé‡çš„éšæœºçŒœæµ‹(ä»Î¸çš„éšæœºçŒœæµ‹å¼€å§‹)ã€‚
2.  ä»è®­ç»ƒæ•°æ®é›†ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªæ ·æœ¬(x(i))ã€‚
3.  è®¡ç®—å…¶æ¢¯åº¦(å³ä»… x(i)çš„æ¢¯åº¦)ã€‚
4.  ä½¿ç”¨æ›´æ–°è§„åˆ™æ›´æ–°æƒé‡ã€‚
5.  å¯¹æ‰€æœ‰è®­ç»ƒæ ·æœ¬(ä» x(i)åˆ° x(n))é‡å¤æ­¥éª¤(2â€“4)ï¼Œç›´åˆ°æ”¶æ•›ã€‚

![](img/8a2a4d5c56f733f9f4722165d979aaf0.png)

æ›´æ–° SGD çš„è§„åˆ™

å…¶ä¸­:x(i)è¿™é‡Œæ˜¯å•ä¸ªè®­ç»ƒè§‚å¯Ÿ/æ ·æœ¬ï¼Œy(i)æ˜¯æ˜ å°„åˆ° x(i)çš„æ ‡ç­¾/ç›®æ ‡ã€‚

> æœ‰è¶£çš„äº‹å®:éšæœº==éšæœºã€‚è®­ç»ƒæ ·æœ¬æ˜¯éšæœºé€‰æ‹©çš„ã€‚

SGD çš„ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼Œéœ€è¦çš„å†…å­˜å°‘ã€‚ç„¶è€Œï¼Œå®ƒä»æ¥æ²¡æœ‰åƒæˆ‘ä»¬æœŸæœ›çš„é‚£æ ·çœŸæ­£æ”¶æ•›ï¼Œè€Œæ˜¯è¾¾åˆ°äº†æœ€ä¼˜è§£çš„ä¸€ä¸ªè¿‘ä¼¼å€¼ã€‚ä½ ä¼šæ³¨æ„åˆ°å®ƒæœ‰ä¸€ä¸ªæ›´å˜ˆæ‚çš„ä¸‹å¡è¿åŠ¨ï¼Œå¹¶åœ¨å…¨çƒæœ€å°å€¼é™„è¿‘æŒ¯è¡(ä½†ä»æœªçœŸæ­£å‡»ä¸­è¦å®³)ã€‚å…¶è®¡ç®—å¤æ‚åº¦ä¸ºå¸¸æ•°æ—¶é—´ O(1)ã€‚

![](img/adce74ebf740d127a11e29cb9b987496.png)

æ¥æº:[ç ”ç©¶é—¨](https://www.researchgate.net/figure/Stochastic-gradient-descent-compared-with-gradient-descent_fig3_328106221)

> â€œSGD çš„éšæœºæ€§è´¨æ„å‘³ç€ä¸€äº›å™ªå£°å°†è¢«å¼•å…¥åˆ°æƒé‡è®¾ç½®ä¸­ï¼Œä½†è¯¥æŠ€æœ¯æ€»ä½“ä¸Šä»ç„¶éå¸¸æœ‰æ•ˆï¼Œå¹¶è¢«å¹¿æ³›ä½¿ç”¨ã€‚â€â€” **ç ”ç©¶ä¹‹é—¨(é“¾æ¥åˆ°ä¸‹é¢çš„å‡ºç‰ˆç‰©)**

SGD ä¹Ÿè¢«ç§°ä¸ºâ€œæ— åä¼°è®¡é‡â€ï¼Œå› ä¸ºæ¢¯åº¦çš„æœŸæœ›ä¸ BGD ç›¸åŒï¼Œä½†æ–¹å·®è¾ƒå°ã€‚

> â€œä¼°è®¡é‡æ˜¯ä¸€ç§å‡½æ•°ï¼Œå®ƒè¯•å›¾åœ¨ç»™å®šæ ·æœ¬æ•°æ®çš„æƒ…å†µä¸‹ä¼°è®¡æ€»ä½“æ•°æ®çš„ä¸€äº›æœ‰ç”¨è´¨é‡ã€‚åå·®æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¼°è®¡å™¨çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ€§è´¨ã€‚SGD æ˜¯æ— åçš„ï¼Œå› ä¸ºå¯¹æ¢¯åº¦çš„æœŸæœ›ä¸å¯¹ BGD çš„æœŸæœ›ç›¸åŒã€‚
> 
> æˆ‘çŸ¥é“è¿™äº›æœ¯è¯­å¯èƒ½å¬èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘å»ºè®®ä½ å‚è€ƒä¸‹é¢çš„é“¾æ¥ï¼Œæˆ‘å·²ç»å°†é“¾æ¥é™„åœ¨äº†è§£é‡Šè¿™äº›æ¦‚å¿µçš„åšå®¢å¸–å­ä¸Šã€‚"

**éšæœºæ¢¯åº¦ä¸‹é™ä¼˜äºæ‰¹é‡æ¢¯åº¦ä¸‹é™**

*   æ‰¹æ¬¡æ¢¯åº¦ä¸‹é™ç¼“æ…¢ã€‚å®ƒéœ€è¦åœ¨æ¯æ¬¡è¿­ä»£ä¸­è®¡ç®—æ•´ä¸ªè®­ç»ƒæ ·æœ¬çš„æ¢¯åº¦ã€‚å¦ä¸€æ–¹é¢ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ›´å¿«ï¼Œå› ä¸ºå®ƒä¸€æ¬¡åªä½¿ç”¨ä¸€ä¸ªæ ·æœ¬ã€‚
*   éšæœºæ¢¯åº¦ä¸‹é™æ˜¯ä¸€ç§æ— åä¼°è®¡é‡ã€‚
*   å®ƒçš„å¤æ‚åº¦æ˜¯å¸¸æ•°æ—¶é—´ O(1)ï¼ŒBDG çš„å¤æ‚åº¦æ˜¯ O(N)ã€‚

# éšæœºæ¢¯åº¦ä¸‹é™çš„ä»£ç å®ç°

å¦‚å‰æ‰€è¿°ï¼Œå¯¹äºä¸Šä¸€ç¯‡æ–‡ç« ä¸­ç”¨äºæ‰¹é‡æ¢¯åº¦ä¸‹é™çš„ä»£ç ï¼Œå”¯ä¸€éœ€è¦åšçš„ç»†å¾®åŒºåˆ«æ˜¯è¿­ä»£è¦ç´ (X)ï¼Œä¸€æ¬¡è·å–ä¸€ä¸ªè§‚æµ‹å€¼(è¡Œ)(æ›´åƒæ°´å¹³åˆ†å‰²æ•°æ®)ï¼Œå¹¶å°†å…¶ç”¨äºæ¢¯åº¦è®¡ç®—ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°æ®é›†ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

æˆ‘ä»¬å°†è·³è¿‡æ•°æ®é¢„å¤„ç†æ­¥éª¤ï¼Œç›´æ¥è¿›å…¥æ¨¡å‹ç±»ã€‚

åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å¿«é€Ÿäº†è§£ä¸€ä¸‹å…³äº SGD çš„ä¸¤ä¸ªé‡è¦æœ¯è¯­:

è¿™äº›æ˜¯ï¼›

*   ä¸–
*   è¿­ä»£æ¬¡æ•°(n_iters)

å› æ­¤**å†å…ƒ**è¢«å®šä¹‰ä¸ºå¯¹æ•´ä¸ªæ•°æ®é›†(æ‰€æœ‰è®­ç»ƒæ•°æ®)çš„ä¸€æ¬¡éå†ã€‚è€Œè¿­ä»£æ˜¯å¯¹ä¸€ä¸ªè®­ç»ƒæ•°æ®çš„ä¼ é€’ã€‚å¯¹äºæ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼Œè¿™ä¸¤ä¸ªæœ¯è¯­æœ‰æ—¶å¯ä»¥äº’æ¢ä½¿ç”¨ï¼Œå› ä¸ºæ‰€æœ‰è®­ç»ƒæ•°æ®éƒ½åœ¨ä¸€ä¸ªæ­¥éª¤ä¸­è€ƒè™‘ã€‚ç„¶è€Œï¼Œå¯¹äº SGDï¼Œè¿™äº›æœ¯è¯­æ˜¯ä¸åŒçš„(æ­£å¦‚æ‚¨åœ¨è®¸å¤šæ·±åº¦å­¦ä¹ åº”ç”¨ç¨‹åºä¸­ä¹Ÿä¼šçœ‹åˆ°çš„)ï¼ŒEpoch è¦†ç›–æ•´ä¸ªæ•°æ®é›†ï¼Œè€Œ iterations è€ƒè™‘æˆ‘ä»¬åœ¨æ°´å¹³åˆ†å‰²æ•°æ®æ—¶é‡‡å–çš„æ­¥éª¤(ä¸€æ¬¡è¿›è¡Œä¸€æ¬¡è§‚å¯Ÿ)ã€‚

ä½ ä¼šå¯¹ä»£ç æœ‰æ›´å¥½çš„ç›´è§‰ã€‚

åæ˜ è¯¥å˜åŒ–çš„å”¯ä¸€åŠŸèƒ½æ˜¯ä½“èƒ½/è®­ç»ƒåŠŸèƒ½ã€‚

![](img/cff4a865cbdaa80a752b2eb6c9da9fca.png)

è®­ç»ƒåŠŸèƒ½

å¦‚ä¸Šé¢çš„ä»£ç ç‰‡æ®µæ‰€ç¤ºï¼Œå¯åŠ¨äº†ç¬¬äºŒä¸ªå¾ªç¯ï¼ŒæŒ‡ç¤ºæ•°æ®çš„æ°´å¹³åˆ‡ç‰‡(X _ train . shape[0]= = row/observation)ã€‚æ³¨æ„åˆ°è¿™ä¸ªåˆ‡ç‰‡è¢«æ”¹å˜å½¢çŠ¶çš„é‚£ä¸€è¡Œäº†å—ï¼Ÿ*ä½ èƒ½çŒœåˆ°ä¸ºä»€ä¹ˆå—ï¼Ÿ*

æ²¡é”™ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå‘é‡ï¼Œâ€œè¡Œå‘é‡â€ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçŸ©é˜µã€‚æ²¡æœ‰æ•´å½¢ï¼Œä»£ç è¿”å›ä¸€ä¸ªé”™è¯¯(*è®°ä½çŸ©é˜µä¹˜æ³•çš„è§„åˆ™*)ã€‚ä¿®æ”¹åçš„â€œXâ€ä»…æ›¿æ¢è®­ç»ƒåŠŸèƒ½ä¸­çš„é¦–å­—æ¯ Xã€‚

è¿˜æœ‰ï¼Œâ€œ *X_train.shape[0]* çš„å€¼å°±æ˜¯è¿™é‡Œçš„è¿­ä»£æ¬¡æ•°(n_iters)ã€‚æ‰€ä»¥ä½ ä¹Ÿå¯ä»¥å°† *n_iters* å®šä¹‰ä¸ºä¸€ä¸ªå˜é‡ï¼Œè§ä¸‹å›¾ã€‚

![](img/12ef4a0237beae86d086c7f03ba507b2.png)

æ³¨æ„åˆ°åˆ‡ç‰‡ä¹Ÿæ˜¯ä¸ºâ€œYâ€å®ç°çš„(å¦‚å…¬å¼ä¸­æ‰€ç¤º)ã€‚

å…¶ä»–æ‰€æœ‰åŠŸèƒ½ä¿æŒä¸å˜ï¼›"é¢„æµ‹å’Œå‡æ–¹è¯¯å·®å‡½æ•°."

![](img/61fb3276369a09c76d6529840a94409a.png)

é€šè¿‡åˆå§‹åŒ–æ¨¡å‹æ¥è¿è¡Œä»£ç ï¼Œçœ‹çœ‹æŸå¤±å›¾ä¸ BGD æœ‰ä»€ä¹ˆä¸åŒã€‚

![](img/29d57da0e72a60a2f4212522d6333177.png)

> ä½ æœ‰æ²¡æœ‰æ³¨æ„åˆ°å’Œ BGD ç›¸æ¯”ä½¿ç”¨äº†æ›´å°çš„å­¦ä¹ ç‡ï¼Ÿä½ èƒ½çœ‹åˆ°æŒ¯è¡å’Œå˜ˆæ‚çš„è¿åŠ¨å—ï¼Ÿ

ä¸€èˆ¬æ¥è¯´ï¼Œå»ºè®®å¯¹ SGD ä½¿ç”¨è¾ƒå°çš„å­¦ä¹ é€Ÿç‡ï¼Œå› ä¸ºå®ƒæ¯æ¬¡éƒ½ä¾èµ–äºå•ä¸ªæ•°æ®è¿›è¡Œè®¡ç®—ã€‚å®ƒéå¸¸å˜ˆæ‚(å¦‚ä¸Šé¢çš„æŸè€—å›¾æ‰€ç¤ºï¼Œå¹¶ä¸”æ›´å€¾å‘äºè¿‡å†²ï¼Œå› ä¸ºå®ƒåœ¨å…¨å±€æœ€å°å€¼é™„è¿‘æŒ¯è¡ã€‚

![](img/47d9e709cf28affc6a1c19ec4bf9d60b.png)

# *å¹²å¾—å¥½ï¼*

# ç»“è®º

æˆ‘å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼Œå¹¶å¯¹ SGD çš„å·¥ä½œåŸç†æœ‰æ‰€äº†è§£ã€‚SGD åœ¨æœºå™¨å­¦ä¹ çš„å­é¢†åŸŸâ€”â€”â€œæ·±åº¦å­¦ä¹ â€ä¸­çš„åº”ç”¨æ›´ä¸ºæ™®åŠã€‚å®ƒæ˜¯æœ€å¸¸ç”¨çš„ä¼˜åŒ–å™¨ã€‚

åœ¨ä¸‹ä¸€ä¸ªç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå°æ‰¹é‡éšæœºæ¢¯åº¦ä½“é¢(*æœ€é…·çš„ä¸€æ‰¹)ğŸ˜„*)ã€‚

> â€œåªè¦æˆ‘ä»¬åŠªåŠ›ï¼Œæˆ‘ä»¬å°±ä¼šéšç€æˆé•¿è€Œä¸æ–­è¿›æ­¥ã€‚éšç€æˆ‘ä»¬çš„å‰è¿›ï¼Œæˆ‘ä»¬ä¸æ–­å–å¾—è¿›æ­¥ã€‚ç»§ç»­å‰è¿›ï¼!"

# ç¤¾äº¤åª’ä½“è¿æ¥:

é¢†è‹±:[https://www.linkedin.com/in/aminah-mardiyyah-rufa-i/](https://www.linkedin.com/in/aminah-mardiyyah-rufa-i/)

æ¨ç‰¹:@diyyah92

# ä»£ç åº“

[](https://github.com/Aminah92/Foundations-of-Machine-Learning/blob/main/Linear-Models/LINEAR%20REGRESSION%20FROM%20SCRATCH%20PT%203-%20SGD.ipynb) [## amina h92/æœºå™¨å­¦ä¹ åŸºç¡€

### åœ¨ GitHub ä¸Šåˆ›å»ºä¸€ä¸ªå¸æˆ·ï¼Œä¸º amina h92/æœºå™¨å­¦ä¹ åŸºç¡€å¼€å‘åšè´¡çŒ®ã€‚

github.com](https://github.com/Aminah92/Foundations-of-Machine-Learning/blob/main/Linear-Models/LINEAR%20REGRESSION%20FROM%20SCRATCH%20PT%203-%20SGD.ipynb) 

# é“¾æ¥åˆ°ä»¥å‰å…³äºè¿™ä¸ªä¸»é¢˜çš„æ–‡ç« 

ç¬¬ä¸€éƒ¨åˆ†:[https://mardiyyah . medium . com/linear-regression-from-scratch-pt1-484 ff 41e 5a 3](https://mardiyyah.medium.com/linear-regression-from-scratch-pt1-484ff41e5a3)

ç¬¬äºŒéƒ¨åˆ†:[https://medium . com/nerd-for-tech/linear-regression-from scratch-pt2-the-gradient-descent-algorithm-f 30d 42 FEA 40 c](/nerd-for-tech/linear-regression-from-scratch-pt2-the-gradient-descent-algorithm-f30d42fea40c)

# å‚è€ƒèµ„æ–™å’Œèµ„æº

[https://www . research gate . net/publication/328106221 _ Deep _ learning _ and _ virtual _ drug _ screening # pf6](https://www.researchgate.net/publication/328106221_Deep_learning_and_virtual_drug_screening#pf6)

[https://florian.github.io/estimators/](https://florian.github.io/estimators/)

[https://www . quora . com/what-what-the-difference-when-training-a-Perceptron](https://www.quora.com/Whats-the-difference-between-epoch-and-iteration-when-training-a-Perceptron)