# æ™ºèƒ½åˆåŒä¸­çš„å§”æ‰˜å‘¼å«

> åŸæ–‡ï¼š<https://medium.com/nerd-for-tech/delegate-call-in-smart-contract-431ba5caf576?source=collection_archive---------1----------------------->

![](img/d34725c75a0acc23a4d101c300a86079.png)

ä¸€äº›å¼€å‘äººå‘˜å¯¹â€œå§”æ‰˜è°ƒç”¨â€è¿™ä¸ªæœ¯è¯­æŒè°¨æ…æ€åº¦ï¼Œå› ä¸ºå®ƒè¢«æè¿°ä¸ºâ€œå±é™©çš„â€ææƒ§å’Œå±é™©æ¥è‡ªäºå¯¹äº‹ç‰©å¦‚ä½•å·¥ä½œä»¥åŠå¦‚ä½•å®‰å…¨ä½¿ç”¨çš„çŸ¥è¯†çš„ç¼ºä¹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººå¹¶ä¸å®³æ€•å¼€è½¦ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå¦‚ä½•å®‰å…¨åœ°é©¾é©¶ã€‚å½“ä¸€ä¸ªå¥‘çº¦ä½¿ç”¨å§”æ‰˜è°ƒç”¨æ¥è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œå®ƒä»å¦ä¸€ä¸ªå¥‘çº¦åŠ è½½å¹¶æ‰§è¡Œè¯¥å‡½æ•°ä»£ç ï¼Œå°±å¥½åƒå®ƒæ˜¯è‡ªå·±çš„ä¸€æ ·ã€‚

å½“é€šè¿‡å§”æ‰˜è°ƒç”¨æ‰§è¡Œå‡½æ•°æ—¶ï¼Œè¿™äº›å€¼ä¸ä¼šæ”¹å˜:

*   åœ°å€(è¿™ä¸ª)
*   msg.sender
*   æ¶ˆæ¯å€¼

ä½¿ç”¨å§”æ‰˜è°ƒç”¨åŠ è½½å’Œæ‰§è¡Œå‡½æ•°çš„åå®šæ‰§è¡Œå¯¹çŠ¶æ€å˜é‡çš„è¯»å–å’Œå†™å…¥ã€‚æŒæœ‰æ£€ç´¢åˆ°çš„å‡½æ•°çš„å¥‘çº¦æ°¸è¿œä¸ä¼šè¢«è¯»å–æˆ–å†™å…¥ã€‚

å¦‚æœ ContractA åˆ©ç”¨å§”æ‰˜è°ƒç”¨æ¥è°ƒç”¨ ContractB ä¸­çš„å‡½æ•°ï¼Œåˆ™ä»¥ä¸‹ä¸¤ç§è¯´æ³•æ˜¯æ­£ç¡®çš„:

*   ContractA çš„çŠ¶æ€å˜é‡å¯ä»¥è¯»å†™ã€‚
*   ContractB çš„çŠ¶æ€å˜é‡ä»ä¸è¢«è¯»å–æˆ–å†™å…¥ã€‚

ContractB çš„å‡½æ•°å¯ä»¥è¯»å†™ ContractA å’Œ ContractB å£°æ˜çš„çŠ¶æ€å˜é‡çš„å€¼ã€‚åªæœ‰ ContractA çš„çŠ¶æ€å˜é‡è¢«è¯»å–æˆ–å†™å…¥ã€‚

> *delegatecall å½±å“ä½¿ç”¨ delegatecall è°ƒç”¨å‡½æ•°çš„å¥‘çº¦çš„çŠ¶æ€å˜é‡ã€‚æŒæœ‰è¢«å€Ÿç”¨çš„å‡½æ•°çš„å¥‘çº¦çš„çŠ¶æ€å˜é‡ä¸è¢«è¯»å–æˆ–å†™å…¥ã€‚*

# ä¾‹å­

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªåŸºæœ¬çš„ä¾‹å­ã€‚
åˆåŒæ–¹æœ‰ä»¥ä¸‹å†…å®¹:

*   address(this)= = 0x 2791 BCA 1 F2 de 4661 ed 88 a 30 c 99 a7a 9449 aa 84174
*   åä¸ºâ€œå­—ç¬¦ä¸²ä»¤ç‰Œåâ€çš„çŠ¶æ€å˜é‡çš„å€¼æ˜¯â€œFunTokenâ€
*   åä¸ºâ€œinitialise()â€çš„å¤–éƒ¨æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä½¿ç”¨ delegatecall æ¥è°ƒç”¨ ContractB çš„â€œsettokenname(string calldata _ newName)â€å‡½æ•°ã€‚

åˆåŒ b åŒ…å«ä»¥ä¸‹æ¡æ¬¾:

*   åœ°å€(this)= = 0x6b 175474 e 89094 c 44 da 98 b 954 eedeac 495271d 0f
*   çŠ¶æ€å˜é‡å­—ç¬¦ä¸²â€œtokenNameâ€çš„å€¼æ˜¯â€œBoringTokenâ€
*   â€œsetTokenName(string calldata _newName)â€æ˜¯ä¸€ä¸ªå¤–éƒ¨å‡½æ•°ï¼Œå®ƒå°†â€œTokenNameâ€çŠ¶æ€å˜é‡æ›´æ–°ä¸ºâ€œ_ newNameâ€å€¼ã€‚

è¿™æ˜¯ç”¨ 2 ETH è°ƒç”¨ ContractA ä¸­çš„â€œåˆå§‹åŒ–()â€å‡½æ•°æ—¶å‘ç”Ÿçš„æƒ…å†µ:

1.  è¿™äº›å€¼æ˜¯è¿™æ ·è®¾ç½®çš„:

*   address(this)= = 0x 2791 BCA 1 F2 de 4661 ed 88 a 30 c 99 a7a 9449 aa 84174
*   msg . sender = = 0x ab 5801 a7 d 398351 b 8 be 11 c 439 e 05 C5 b 3259 AEC 9b
*   æ¶ˆæ¯å€¼== 2 ETH

2.ä½¿ç”¨å§”æ‰˜è°ƒç”¨,â€œinitialise()â€æ–¹æ³•è°ƒç”¨ ContractB ä¸­çš„â€œsetTokenNameâ€å‡½æ•°ã€‚è¿è¡Œâ€œsetTokenNameâ€æ—¶ï¼Œå°†è¿”å›ä»¥ä¸‹å€¼ã€‚ä»–ä»¬ä¸€ç‚¹éƒ½æ²¡å˜ã€‚

*   address(this)= = 0x 2791 BCA 1 F2 de 4661 ed 88 a 30 c 99 a7a 9449 aa 84174
*   msg . sender = = 0x ab 5801 a7 d 398351 b 8 be 11 c 439 e 05 C5 b 3259 AEC 9b
*   æ¶ˆæ¯å€¼== 2 ETH

3.åœ¨ ContractA ä¸­ï¼Œå­—ç¬¦ä¸²â€œtokenNameâ€çŠ¶æ€å˜é‡çš„å€¼è¢«æ›´æ”¹ã€‚å³ä½¿ä»£ç æºè‡ª ContractBï¼Œä¹Ÿä¸ä¼šåœ¨ ContractB ä¸­æ›´æ”¹ã€‚

Solidity addresses æœ‰ä¸€ä¸ªâ€œå§”æ‰˜è°ƒç”¨â€æ–¹æ³•ï¼Œå…è®¸æ‚¨è¿›è¡Œå§”æ‰˜è°ƒç”¨ã€‚æ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”çŠ¶æ€å˜é‡ï¼Œè¯¥å˜é‡æŒ‡ç¤ºå‡½æ•°è°ƒç”¨æ˜¯å¦è¢«åè½¬ã€‚å§”æ‰˜è°ƒç”¨å‡½æ•°è¿”å›ç¬¬äºŒä¸ªå€¼ï¼Œè¿™æ˜¯å‡½æ•°è°ƒç”¨çš„è¿”å›å€¼ã€‚è¯·å‚è§ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ã€‚

# å¦‚ä½•å®‰å…¨åœ°ä½¿ç”¨å§”æ‰˜è°ƒç”¨

æ—¢ç„¶æ‚¨å·²ç»ç†è§£äº†å§”æ‰˜è°ƒç”¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®‰å…¨åœ°ä½¿ç”¨å®ƒã€‚

## 1.æ§åˆ¶å§”æ‰˜è°ƒç”¨æ‰§è¡Œçš„å†…å®¹

ä¸å—ä¿¡ä»»çš„ä»£ç ä¸åº”è¯¥ä¸å§”æ‰˜è°ƒç”¨ä¸€èµ·è¿è¡Œï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæ›´æ”¹çŠ¶æ€å˜é‡æˆ–è°ƒç”¨â€œè‡ªæ¯â€æ¥ç ´åè°ƒç”¨åå®šã€‚å¯ä»¥ä½¿ç”¨æƒé™ã€èº«ä»½éªŒè¯æˆ–å…¶ä»–ç±»å‹çš„æ§åˆ¶æ¥æŒ‡å®šæˆ–æ›´æ”¹å§”æ‰˜è°ƒç”¨å‡½æ•°å’Œå¥‘çº¦ã€‚

## 2.ä»…å‘¼å«æœ‰ä»£ç çš„åœ°å€ä¸Šçš„å§”æ‰˜å‘¼å«

å¦‚æœåœ¨ä¸æ˜¯çº¦å®šçš„åœ°å€ä¸Šè°ƒç”¨ Delegatecallï¼Œå› æ­¤æ²¡æœ‰ä»£ç ï¼Œå®ƒå°†ä¸ºçŠ¶æ€å€¼è¿”å›â€œTrueâ€ã€‚å¦‚æœä»£ç æœŸæœ›å§”æ‰˜è°ƒç”¨å‡½æ•°åœ¨ä¸èƒ½è¿è¡Œæ—¶è¿”å›â€œFalse â€,è¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚

å¦‚æœæ‚¨ä¸ç¡®å®šå½“å¯¹æŸä¸ªåœ°å€å˜é‡è¿›è¡Œå§”æ‰˜è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡æ˜¯å¦æ€»æ˜¯ä¿ç•™å¸¦æœ‰ä»£ç çš„åœ°å€ï¼Œè¯·åœ¨è°ƒç”¨è¯¥å˜é‡ä¹‹å‰æ£€æŸ¥è¯¥å˜é‡ä¸­çš„ä»»ä½•åœ°å€æ˜¯å¦å¸¦æœ‰ä»£ç ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿›è¡Œæ¢å¤ã€‚ä»¥ä¸‹æ˜¯æ£€æŸ¥åœ°å€ä¸­ä»£ç çš„ä»£ç ç¤ºä¾‹:

# ç»“è®º

å› æ­¤ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ™ºèƒ½å¥‘çº¦ä¸­çš„å§”æ‰˜è°ƒç”¨ï¼Œå¦‚ä½•å°å¿ƒä½¿ç”¨å®ƒï¼Œä»¥åŠå½“æˆ‘ä»¬ä½¿ç”¨ç”¨ä¾‹æ—¶å®ƒå¦‚ä½•ä¸ºæˆ‘ä»¬å¸¦æ¥å¥½å¤„ã€‚

> *ä½ å¯ä»¥åœ¨è¿™é‡Œ* *ä¹°ä¸€æ¯å’–å•¡æ”¯æŒæˆ‘å’Œæˆ‘çš„å†…å®¹â˜•* [***ã€‚***](https://www.buymeacoffee.com/amanagarwal)
> 
> *å…³æ³¨æˆ‘ä¸Š*[***Twitter***](https://twitter.com/02amanag)*å’Œ*[***LinkedIn***](https://www.linkedin.com/in/02amanag/)*ã€‚*

# äº†è§£æ›´å¤šä¿¡æ¯

[](https://learn.block6.tech/oracle-blockchain-47b5ad917aa6) [## Oracle åŒºå—é“¾

### Oracle åŒºå—é“¾æ˜¯ä»€ä¹ˆï¼Ÿ

å­¦ä¹ . block6.tech](https://learn.block6.tech/oracle-blockchain-47b5ad917aa6) [](https://enlear.academy/off-chain-transaction-of-blockchain-7b9fa3f9b94a) [## åŒºå—é“¾çš„é“¾å¤–äº¤æ˜“

### ä»€ä¹ˆæ˜¯å¤–é“¾äº¤æ˜“ï¼Ÿ

enlear .å­¦é™¢](https://enlear.academy/off-chain-transaction-of-blockchain-7b9fa3f9b94a) [](/geekculture/ethereum-v-s-hyperledger-f1b0c5e05b40) [## ä»¥å¤ªåŠè™šæ‹Ÿåˆ†ç±»å¸

### Hyperledger å’Œä»¥å¤ªåŠæ˜¯ä¸–ç•Œä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„ä¸¤ä¸ªåŒºå—é“¾å¹³å°ã€‚ä¸¤è€…éƒ½æ˜¯å…è´¹ä½¿ç”¨çš„ã€‚ä»–ä»¬â€¦

medium.com](/geekculture/ethereum-v-s-hyperledger-f1b0c5e05b40) 

> [Learn å‘å¸ƒçš„å†…å®¹ã€‚Block6.tech](https://learn.block6.tech)
> 
> ğŸ‘‰[ç”µæŠ¥](https://t.me/block6_tech) â€”æ–°é²œæƒ³æ³•
> 
> ğŸ‘‰[æ¨ç‰¹](https://twitter.com/block6_tech) â€”æœ€æ–°æ–‡ç« 
> 
> ğŸ‘‰ [LinkTr.ee](https://linktr.ee/block6)