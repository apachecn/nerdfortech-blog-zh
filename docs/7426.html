<html>
<head>
<title>React with Typescript series (Charity Web App) â€” Uploading files to AWS S3 {Bonus section on Github pages deployment}</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React with Typescript series(æ…ˆå–„ç½‘ç«™åº”ç”¨ç¨‹åº)â€”å°†æ–‡ä»¶ä¸Šä¼ åˆ° AWS S3(Github é¡µé¢éƒ¨ç½²çš„å¥–åŠ±éƒ¨åˆ†)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/react-with-typescript-series-charity-web-app-uploading-files-to-aws-s3-5a0b6099786c?source=collection_archive---------1-----------------------#2022-10-24">https://medium.com/nerd-for-tech/react-with-typescript-series-charity-web-app-uploading-files-to-aws-s3-5a0b6099786c?source=collection_archive---------1-----------------------#2022-10-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6ba4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å˜¿ä¼™è®¡ä»¬ï¼Œåœ¨æˆ‘ä»¬çš„æ…ˆå–„é¡¹ç›®è¿›ä¸€æ­¥å‘å±•ä¹‹å‰ï¼Œæˆ‘æƒ³åˆ°äº†ç›´æ¥ä»å‰ç«¯å®ç° s3 æ–‡ä»¶ä¸Šä¼ ã€‚æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„å¯ä»¥ä»è¿™é‡Œå€Ÿé‰´ã€‚</p><p id="cf31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å‰ç«¯ååº”ç³»åˆ—</strong></p><div class="jd je ez fb jf"><div role="button" tabindex="0" class="ab bv ff cb dy jg jh bn ji jj jk"><div class="jl l"><div class="ab q"><div class="l di"><img alt="Dimuthu Wickramanayake" class="l de bw jm jn du" src="../Images/099c92eba7c0ef5b0373ba4d36052ba2.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*LsIMaDB2-AJKz28n02h_IQ.jpeg"/><div class="dr bw l jm jn ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://billa-code.medium.com/?source=post_page-----5a0b6099786c--------------------------------" rel="noopener follow" target="_top">è¿ªå§†å›¾Â·ç»´å…‹æ‹‰é©¬é‚£äºšå…‹</a></p></div></div><div class="jq jr fg l"><h2 class="bd hj sc sd dy se ea eb lf ed ef hh bi translated">ç”¨ Typescript ç³»åˆ—ä½œå‡ºååº”(æ…ˆå–„ç½‘ç»œåº”ç”¨)</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi sf au sg sh si oz sj an fx fy sk sl sm gb gc gd de bk ge" href="https://billa-code.medium.com/list/react-with-typescript-seriescharity-web-app-6f45ca471f54?source=post_page-----5a0b6099786c--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="sn l dw"><span class="bd b fp z dx">7 stories</span></div></div></div><div class="kd dh ke dy ab kf dw di"><div class="di jv bv jw jx"><div class="dh l"><img alt="" class="dh" src="../Images/ace19c3ad1c0f8dc12620ff352fd2b11.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*QhAfunLq4rh0VrChbXUtZA.png"/></div></div><div class="di jv bv jy jz ka"><div class="dh l"><img alt="" class="dh" src="../Images/23deda9e9ca42920182e5a94707a12e7.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*vBIWr2bx7SaHJveT97Xg9g.png"/></div></div><div class="di bv kb kc ka"><div class="dh l"><img alt="" class="dh" src="../Images/16523ac1bf719cb2bc80e1cc1ec44297.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*53lYwBkgmaFRow1Erxl06Q.png"/></div></div></div></div></div><p id="3d93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">åç«¯ AWS Lambda NodeJS ç³»åˆ—</strong></p><div class="jd je ez fb jf"><div role="button" tabindex="0" class="ab bv ff cb dy jg jh bn ji jj jk"><div class="jl l"><div class="ab q"><div class="l di"><img alt="Dimuthu Wickramanayake" class="l de bw jm jn du" src="../Images/099c92eba7c0ef5b0373ba4d36052ba2.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*LsIMaDB2-AJKz28n02h_IQ.jpeg"/><div class="dr bw l jm jn ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated">è¿ªç©†å›¾Â·ç»´å…‹æ‹‰é©¬é‚£äºšå…‹</p></div></div><div class="jq jr fg l"><h2 class="bd hj sc sd dy se ea eb lf ed ef hh bi translated">AWS Lambda(æ…ˆå–„ç½‘ç»œåº”ç”¨)ç³»åˆ—</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi sf au sg sh si oz sj an fx fy sk sl sm gb gc gd de bk ge" href="https://billa-code.medium.com/list/aws-lambda-charity-webapp-series-cd878238f932?source=post_page-----5a0b6099786c--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="sn l dw"><span class="bd b fp z dx">5 stories</span></div></div></div><div class="kd dh ke dy ab kf dw di"><div class="di jv bv jw jx"><div class="dh l"><img alt="" class="dh" src="../Images/5e5d417a4f8e977dff5a6564ccf48d39.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*ZMefBLP2MRSPDwmix-Z0Mw.png"/></div></div><div class="di jv bv jy jz ka"><div class="dh l"><img alt="" class="dh" src="../Images/75f2267185bffd78647008c578e838b9.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*myAvjQPuBRWl1INX8ZjhAg.png"/></div></div><div class="di bv kb kc ka"><div class="dh l"><img alt="" class="dh" src="../Images/fa6bf2ff659d1783bd38eee735f02f2d.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*Mu1FtEnLQw7sXtrpNJmSHQ.png"/></div></div></div></div></div><p id="10db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªè¾“å…¥æ¥ä¸Šä¼ æ–‡ä»¶ã€‚æˆ‘å°†æŠŠå®ƒæ·»åŠ åˆ°æ¨¡æ€ç»„ä»¶çš„é¡µè„šã€‚æˆ‘çš„ StudentModalComponent.tsx æ–‡ä»¶ä¼šè¿™æ ·æ”¹ã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="f282" class="ks kt hi kp b fi ku kv l kw kx">import React, { Component } from 'react';<br/>import { Modal, Button, Form } from 'react-bootstrap';<br/>import { withForm } from "../hoc/withForm";<br/><br/>export type StudentPropType = {<br/>    show: boolean,<br/>    form: any,<br/>    studentid: string,<br/>    config: any,<br/>    onHide(): void,<br/>    onSave(): void,<br/>    <strong class="kp hj">handleFileUpload(file: any): void</strong><br/>}<br/><br/>class StudentModalComponent extends Component&lt;StudentPropType&gt; {<br/>    constructor(props: StudentPropType) {<br/>        super(props);<br/>    }<br/><br/>    <strong class="kp hj">handleFileUpload(e: any) {<br/>        this.props.handleFileUpload(e.target.files[<em class="ky">0</em>])<br/>    }</strong><br/><br/>    render(): React.ReactNode {<br/>        return &lt;Modal show={this.props.show}&gt;<br/>            &lt;Modal.Header closeButton onClick={this.props.onHide}&gt;<br/>                &lt;Modal.Title id="contained-modal-title-vcenter"&gt;<br/>                    Details of Student {this.props.config[<em class="ky">1</em>].value}<br/>                &lt;/Modal.Title&gt;<br/>            &lt;/Modal.Header&gt;<br/>            &lt;Modal.Body&gt;<br/>                {this.props.form}<br/>            &lt;/Modal.Body&gt;<br/>            &lt;Modal.Footer&gt;<br/>                <strong class="kp hj">&lt;div style={{display: 'flex', width: '100%', justifyContent: 'center'}}&gt;<br/>                    &lt;Form.Group controlId="formFile" className="mb-3" onChange={(e) =&gt; this.handleFileUpload(e)}&gt;<br/>                        &lt;Form.Control type="file" /&gt;<br/>                    &lt;/Form.Group&gt;<br/>                &lt;/div&gt;</strong><br/>                &lt;div style={{display: 'flex', width: '45%', justifyContent: 'space-between'}}&gt;<br/>                    &lt;Button onClick={this.props.onSave}&gt;Save&lt;/Button&gt;<br/>                    &lt;Button onClick={this.props.onHide}&gt;Delete&lt;/Button&gt;<br/>                    &lt;Button onClick={this.props.onHide}&gt;Close&lt;/Button&gt;<br/>                &lt;/div&gt;<br/>            &lt;/Modal.Footer&gt;<br/>        &lt;/Modal&gt;<br/>    }<br/>}<br/><br/>export default withForm(StudentModalComponent);</span></pre><p id="a081" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨è¿™é‡Œï¼Œå½“æˆ‘æŠŠé¡µè„šåˆ†æˆä¸åŒçš„éƒ¨åˆ†æ—¶ï¼Œæˆ‘ä½¿ç”¨äº† CSS flexã€‚è¿™æ¯”ä½¿ç”¨å¼•å¯¼è¡Œåˆ—è¦å®¹æ˜“å¾—å¤šã€‚å¯¹äºæ–‡ä»¶ä¸Šä¼ è¾“å…¥éƒ¨åˆ†çš„ onChange äº‹ä»¶ï¼Œæˆ‘æ­£åœ¨è°ƒç”¨<strong class="ih hj"> handleFileUpload </strong>æ–¹æ³•ã€‚å®ƒè°ƒç”¨ä» props ä¼ é€’çš„å¦ä¸€ä¸ªæ–¹æ³•ã€‚ç°åœ¨ï¼Œæˆ‘å°†è½¬åˆ° StudentModalButton.tsx æ–‡ä»¶æ¥å®Œæˆå…¶ä½™çš„å®ç°ã€‚å¦‚æœä½ è¿˜è®°å¾—çš„è¯ï¼Œæˆ‘å·²ç»ä½¿ç”¨äº†é«˜é˜¶ç»„ä»¶ï¼Œå¹¶ä½¿è¡¨å•å®Œå…¨åŠ¨æ€åŒ–ã€‚ç°åœ¨ï¼Œä¸ºäº†æ˜¾ç¤ºæ·»åŠ ç»™å­¦ç”Ÿçš„æ–‡ä»¶ï¼Œæˆ‘åº”è¯¥æ›´æ”¹è¾“å…¥æ¡†ã€‚ä¹‹åï¼Œæˆ‘å°†è°ƒç”¨ handleFileUpload æ–¹æ³•ä½œä¸º StudentModalComponent çš„å±æ€§ï¼Œå¹¶åœ¨æ­¤å®ç°è¯¥æ–¹æ³•ã€‚å½“å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æœ‰@aws-sdk/client-s3ï¼Œå¹¶åœ¨ä¸‹è½½å¤„ç†ç¨‹åºä¸­é‡‡ç”¨é¢„å…ˆç­¾åçš„ URLï¼Œæˆ‘ä»¬éœ€è¦@aws-sdk/s3-request-presignerã€‚ä¸‹é¢æ˜¯æ›´æ–°åçš„ package.jsonã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="37bc" class="ks kt hi kp b fi ku kv l kw kx">{<br/>  "name": "serendib-ui",<br/>  "version": "0.1.0",<br/>  "private": true,<br/>  "homepage": "https://debilla.github.io/serendib-scholarship-ui",<br/>  "dependencies": {<br/>    "@testing-library/jest-dom": "^5.16.4",<br/>    "@testing-library/react": "^13.1.1",<br/>    "@testing-library/user-event": "^13.5.0",<br/>    "@types/jest": "^27.4.1",<br/>    "@types/node": "^16.11.31",<br/>    "@types/react": "^18.0.8",<br/>    "@types/react-dom": "^18.0.0",<br/>    "bootstrap": "^5.1.3",<br/>    "react": "^18.1.0",<br/>    "react-bootstrap": "^2.3.1",<br/>    "react-data-grid": "7.0.0-beta.15",<br/>    "react-dom": "^18.1.0",<br/>    "react-scripts": "5.0.1",<br/>    "typescript": "^4.6.3",<br/>    "web-vitals": "^2.1.4",<br/>    <strong class="kp hj">"@aws-sdk/client-s3": "3.194.0",<br/>    "@aws-sdk/s3-request-presigner": "3.194.0"</strong><br/>  },<br/>  "scripts": {<br/>    "start": "react-scripts start",<br/>    "build": "react-scripts build",<br/>    "test": "react-scripts test",<br/>    "eject": "react-scripts eject"<br/>  },<br/>  "eslintConfig": {<br/>    "extends": [<br/>      "react-app",<br/>      "react-app/jest"<br/>    ]<br/>  },<br/>  "browserslist": {<br/>    "production": [<br/>      "&gt;0.2%",<br/>      "not dead",<br/>      "not op_mini all"<br/>    ],<br/>    "development": [<br/>      "last 1 chrome version",<br/>      "last 1 firefox version",<br/>      "last 1 safari version"<br/>    ]<br/>  }<br/>}</span></pre><p id="7295" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¿…é¡»ä» react åº”ç”¨ç¨‹åºè¿æ¥åˆ° AWS å¸æˆ·ã€‚ä¸ºæ­¤ï¼Œå½“æˆ‘ä»¬åˆ›å»º S3 å®¢æˆ·ç«¯æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¸º AWS å¸æˆ·ä¼ é€’ç™»å½•ä»¤ç‰Œã€‚å¦‚æœæ‚¨ä¸çŸ¥é“å¦‚ä½•è·å¾—è¿™äº›å€¼ï¼Œè¯·å‚è€ƒä¸‹é¢çš„æ–‡ç« ã€‚æˆ‘å¤§èƒ†åœ°è¿ˆå‡ºäº†æ­¥ä¼ã€‚</p><div class="jd je ez fb jf kz"><a rel="noopener follow" target="_blank" href="/nerd-for-tech/aws-certified-solution-architect-iam-8930ce442515"><div class="la ab dw"><div class="lb ab lc cl cj ld"><h2 class="bd hj fi z dy le ea eb lf ed ef hh bi translated">AWS è®¤è¯è§£å†³æ–¹æ¡ˆæ¶æ„å¸ˆâ€” IAM</h2><div class="lg l"><h3 class="bd b fi z dy le ea eb lf ed ef dx translated">IAM çš„æ„æ€æ˜¯èº«ä»½å’Œè®¿é—®ç®¡ç†æœåŠ¡ã€‚å½“æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­åˆ›å»º AWS å¸æˆ·æ—¶ï¼Œæˆ‘ä»¬â€¦</h3></div><div class="lh l"><p class="bd b fp z dy le ea eb lf ed ef dx translated">medium.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jj kz"/></div></div></a></div><p id="e3a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œåœ¨åšä»»ä½•ä»£ç æ›´æ”¹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åœ¨ S3 åˆ›å»ºä¸€ä¸ªæ¡¶ã€‚ä¸ºæ­¤ï¼Œå»ä½ çš„ AWS æ§åˆ¶å°ï¼Œæœç´¢ S3ï¼Œå»é‚£é‡Œã€‚æœ‰ä¸€ä¸ªæŒ‰é’®å«åšåˆ›å»ºæ¡¶ã€‚å•å‡»å®ƒï¼Œç„¶åç”¨é»˜è®¤é…ç½®åˆ›å»ºå®ƒã€‚</p><figure class="kk kl km kn fd lp er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lo"><img src="../Images/78dd505d79ddb8cd47bba6d0d123ac00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhAfunLq4rh0VrChbXUtZA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">S3 æ°´æ¡¶</figcaption></figure><p id="360b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½†æ˜¯è¿™ä¸ª bucket ä¸èƒ½ä»æ‚¨çš„æœ¬åœ°ç¯å¢ƒè®¿é—®ï¼Œå› æ­¤ï¼Œè½¬åˆ°åˆ›å»ºçš„ bucketï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªåä¸º permissions çš„éƒ¨åˆ†ã€‚</p><figure class="kk kl km kn fd lp er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lo"><img src="../Images/6f9088bd47ba2f14526ae78bb2c82134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5Y4xqcn-M77T1-_vh2heA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">S3 æ¡¶æƒé™</figcaption></figure><p id="ee44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è½¬åˆ°æƒé™ï¼Œå½“ä½ å‘ä¸‹æ»šåŠ¨ï¼Œä½ ä¼šçœ‹åˆ°ä¸€èŠ‚è·¨æºèµ„æºå…±äº«(CORS)ã€‚ç‚¹å‡»ç¼–è¾‘æŒ‰é’®ï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="3587" class="ks kt hi kp b fi ku kv l kw kx">[<br/>    {<br/>        "AllowedHeaders": [<br/>            "*"<br/>        ],<br/>        "AllowedMethods": [<br/>            "PUT",<br/>            "POST",<br/>            "DELETE"<br/>        ],<br/>        "AllowedOrigins": [<br/>            "*"<br/>        ],<br/>        "ExposeHeaders": [<br/>            "x-amz-server-side-encryption",<br/>            "x-amz-request-id",<br/>            "x-amz-id-2"<br/>        ],<br/>        "MaxAgeSeconds": 3000<br/>    }<br/>]</span></pre><p id="0c35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¥½çš„ğŸ‘Œç°åœ¨æˆ‘ä»¬çš„ S3 å­˜å‚¨æ¡¶å·²ç»å‡†å¤‡å¥½æ¥æ”¶æ–‡ä»¶äº†ã€‚è®©æˆ‘ä»¬è½¬åˆ° React ä»£ç å¹¶å®ç°å®ƒã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="b38f" class="ks kt hi kp b fi ku kv l kw kx">const REGION = "us-east-1";<br/>const s3Client = new S3Client({ region: REGION, credentials: {accessKeyId: '&lt;YOUR KEY&gt;', secretAccessKey: '&lt;YOUR SECRET&gt;'} });</span></pre><p id="fc08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ Handle upload æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ‰€åšçš„æ˜¯ï¼Œåœ¨ try catch å—ä¸­ï¼Œæˆ‘ä¸Šä¼ æ–‡ä»¶ï¼Œä¸Šä¼ åï¼Œæˆ‘ç”¨æ›´æ–°çš„æ–‡ä»¶è®¾ç½®çŠ¶æ€ã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="c809" class="ks kt hi kp b fi ku kv l kw kx">async handleFileUpload(file: any) {<br/>    const bucketParams = {<br/>        Bucket: "&lt;YOUR BUCKET NAME&gt;",<br/>        Key: file['name'],<br/>        Body: file,<br/>    };<br/><br/>    try {<br/>        const data = await s3Client.send(new PutObjectCommand(bucketParams));<br/>        console.log(data);<br/>        <br/>        let fileArr = this.state.config[this.state.config.length - <em class="ky">1</em>].array;<br/>        fileArr.push(file['name']);<br/>        this.setConfigState(fileArr, this.state.config.length - <em class="ky">1</em>);<br/>    } catch(e) {<br/>        throw e;<br/>    }<br/>}</span></pre><p id="ca20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œor æ–‡ä»¶è¢«ä¸Šä¼ åˆ° S3 å­˜å‚¨æ¡¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡ AWS æ§åˆ¶å°ä¸­çš„ S3 æ¥æŸ¥çœ‹ã€‚æ¥ä¸‹æ¥æ˜¯ä¸‹è½½ä¸Šä¼ çš„æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†ä¼ é€’æ–‡ä»¶çš„åç§°ï¼Œç„¶åä¸ºè¯¥æ–‡ä»¶åˆ›å»ºé¢„ç­¾åçš„ URLã€‚ç„¶åï¼Œæˆ‘åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ‰“å¼€è¿™ä¸ªé“¾æ¥ï¼Œä¸‹è½½å®ƒã€‚é¢„å…ˆè®¾è®¡çš„ç½‘å€æ²¡æœ‰ä»€ä¹ˆç¥å¥‡çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªåœ¨è§„å®šæ—¶é—´å†…å…¬ä¼—å¯ä»¥è®¿é—®çš„ç½‘å€ã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="26d8" class="ks kt hi kp b fi ku kv l kw kx">async downloadFile(fileName: any) {<br/>    const bucketParams = {<br/>        Bucket: "ssdww",<br/>        Key: fileName,<br/>        Body: "BODY"<br/>    };<br/><br/>    try {<br/>        const command = new GetObjectCommand(bucketParams);<br/>        const signedUrl = await getSignedUrl(s3Client, command, {<br/>            expiresIn: <em class="ky">3600</em>,<br/>        });<br/><br/>        window.open(signedUrl)<br/>    } catch(e) {<br/>        throw e;<br/>    }<br/>}</span></pre><p id="267d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å®Œæ•´çš„ä»£ç ã€‚å¯¹ StudentModalButton.txs æ–‡ä»¶åšäº†è®¸å¤šæ›´æ”¹ï¼Œä»¥é€‚åº”æ–°çš„ S3 é›†æˆã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="6f8b" class="ks kt hi kp b fi ku kv l kw kx">import React, { Component } from 'react';<br/>import { Button } from 'react-bootstrap';<br/>import StudentModalComponent from '../StudentModalComponent/StudentModalComponent';<br/>import { S3Client, PutObjectCommand, GetObjectCommand } from "@aws-sdk/client-s3";<br/>import { getSignedUrl } from "@aws-sdk/s3-request-presigner";<br/><br/>const REGION = "us-east-1";<br/>const s3Client = new S3Client({ region: REGION, credentials: {accessKeyId: 'AKIAS3A4WDWDV4XTXSUS', secretAccessKey: '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'} });<br/><br/>interface StudentModalButtonComponentProps {<br/>    studentId: string,<br/>    detail: any<br/>}<br/><br/>export default class StudentModalButton extends Component&lt;StudentModalButtonComponentProps, { show: boolean, config: any }&gt; {<br/>    constructor(props: StudentModalButtonComponentProps) {<br/>        super(props);<br/><br/>        let config = [];<br/>        let arr = [...Object.keys(this.props.detail)];<br/><br/>        for (let i = <em class="ky">0</em>; i &lt; arr.length; i++ ) {<br/>            let label = arr[i];<br/>            let value = this.props.detail[arr[i]];<br/>            let obj;<br/><br/>            if (label === 'files') {<br/>                obj = {<br/>                    label: label,<br/>                    array: value,<br/>                    type: 'file',<br/>                    onChange: (e: any) =&gt; {<br/>                        this.downloadFile(e.target.innerText);<br/>                    }<br/>                }<br/>            } else {<br/>                obj = {<br/>                    label: label,<br/>                    value: value,<br/>                    type: 'text',<br/>                    onChange: (e: any) =&gt; {<br/>                        this.setConfigState(e.target.value, i);<br/>                    }<br/>                }<br/>            }<br/><br/>            config.push(obj);<br/>        }<br/><br/>        this.state = {<br/>            show: <em class="ky">false</em>,<br/>            config: config<br/>        };<br/>    }<br/><br/>    async downloadFile(fileName: any) {<br/>        const bucketParams = {<br/>            Bucket: "ssdww",<br/>            Key: fileName,<br/>            Body: "BODY"<br/>        };<br/><br/>        try {<br/>            const command = new GetObjectCommand(bucketParams);<br/>            const signedUrl = await getSignedUrl(s3Client, command, {<br/>                expiresIn: <em class="ky">3600</em>,<br/>            });<br/><br/>            window.open(signedUrl)<br/>        } catch(e) {<br/>            throw e;<br/>        }<br/>    }<br/><br/>    setConfigState(value: any, i: any) {<br/>        let arr = [...this.state.config];<br/>        arr[i].value = value;<br/>        this.setState({ config: arr });<br/>    }<br/><br/>    setModalShow(showState: boolean) {<br/>        this.setState({ show: showState });<br/>    }<br/><br/>    saveData() {<br/>        console.log(this.state.config);<br/>    }<br/><br/>    async handleFileUpload(file: any) {<br/>        const bucketParams = {<br/>            Bucket: "ssdww",<br/>            Key: file['name'],<br/>            Body: file,<br/>        };<br/><br/>        try {<br/>            const data = await s3Client.send(new PutObjectCommand(bucketParams));<br/>            console.log(data);<br/><br/>            let fileArr = this.state.config[this.state.config.length - <em class="ky">1</em>].array;<br/>            fileArr.push(file['name']);<br/>            this.setConfigState(fileArr, this.state.config.length - <em class="ky">1</em>);<br/>        } catch(e) {<br/>            throw e;<br/>        }<br/>    }<br/><br/>    render(): React.ReactNode {<br/>        return &lt;&gt;<br/>            &lt;Button onClick={() =&gt; this.setModalShow(<em class="ky">true</em>)}&gt;{this.props.studentId}&lt;/Button&gt;<br/>            &lt;StudentModalComponent config={this.state.config} show={this.state.show} handleFileUpload={(file: any) =&gt; this.handleFileUpload(file)} onHide={() =&gt; this.setModalShow(<em class="ky">false</em>)} onSave={() =&gt; this.saveData()} studentid = {this.props.studentId} /&gt;<br/>        &lt;/&gt;<br/>    }<br/>}</span></pre><p id="5874" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºæ­¤ï¼Œæˆ‘å¿…é¡»æ›´æ”¹ StudentTableComponentï¼Œè¿™æ˜¯ç›®å‰çš„ä¸»è¦æ•°æ®æº(æˆ‘ä»¬è¿˜æ²¡æœ‰ä¸åç«¯é›†æˆ)ã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="9ca5" class="ks kt hi kp b fi ku kv l kw kx">import { render } from '@testing-library/react';<br/>import React from 'react';<br/>import DataTableComponent from '../../components/DataTableComponent/DataTableComponent';<br/>import StudentModalButton from '../../components/StudentModalButton/StudentModalButton';<br/><br/>const columns = [<br/>    {<br/>        key: 'id', name: 'ID', width: <em class="ky">10</em>,<br/>        formatter(props: any) {<br/>            return (<br/>                &lt;&gt;<br/>                    &lt;StudentModalButton detail={props.row} studentId={props.row.id} /&gt;<br/>                &lt;/&gt;<br/>            );<br/>        },<br/>    },<br/>    { key: 'name', name: 'Name' },<br/>    { key: 'contactNo', name: 'Contact No' },<br/>    { key: 'email', name: 'Email' },<br/>    { key: 'university', name: 'Univeristy' },<br/>    { key: 'course', name: 'Course of Study' },<br/>    { key: 'startDate', name: 'Course Start Date' },<br/>    { key: 'endDate', name: 'Course End Date' },<br/>    { key: 'schoolEndDate', name: 'Schol. start Date' },<br/>    { key: 'sponsor', name: 'Sponsor Name' }<br/>];<br/><br/>const rows = [<br/>    { id: <em class="ky">0</em>, name: 'Example', contactNo: '', email: '', university: '', course: '', startDate: '', endDate: '', schoolEndDate: '', sponsor: '', files: [] },<br/>    { id: <em class="ky">1</em>, name: 'Demo', contactNo: '', email: '', university: '', course: '', startDate: '', endDate: '', schoolEndDate: '', sponsor: '', files: [] }<br/>];<br/><br/>export default function StudentTableContainer() {<br/>    return (&lt;DataTableComponent columns={columns} rows={rows} /&gt;);<br/>}</span></pre><p id="5c49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">S3 ä¸Šä¼ å’Œä¸‹è½½åˆ°æ­¤ç»“æŸã€‚ä¸‹ä¸€æ­¥æ˜¯ä»åç«¯å¤„ç†è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ äº‹ä»¶ã€‚æˆ‘çš„è®¡åˆ’æ˜¯ï¼Œä» Lambda å‡½æ•°æ•è· S3 æ–‡ä»¶ä¸Šä¼ äº‹ä»¶ï¼Œå¹¶ç›¸åº”åœ°æ›´æ–° DynamoDBã€‚ç›´åˆ°æˆ‘ä»¬å®ç°é‚£ä¸ªå¿«ä¹çš„ç¼–ç ï¼ï¼ï¼</p><p id="3e38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">UI å›è´­:<a class="ae lz" href="https://github.com/deBilla/serendib-scholarship-ui" rel="noopener ugc nofollow" target="_blank">https://github.com/deBilla/serendib-scholarship-ui</a></p><p id="31ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åç«¯å›è´­:ã€https://github.com/deBilla/serendib-scholarship-ws T2ã€‘</p><h1 id="5f07" class="ma kt hi bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak">å¥–é‡‘éƒ¨åˆ†</strong></h1><p id="b512" class="pw-post-body-paragraph if ig hi ih b ii mx ik il im my io ip iq mz is it iu na iw ix iy nb ja jb jc hb bi translated">ä¼™è®¡ä»¬ï¼Œè¿™æ˜¯ Github éƒ¨ç½²æŒ‡å—ã€‚å¦‚æœä½ ä»¬å›å»çœ‹çœ‹æˆ‘ä»¬ä»¥å‰çš„æ•™ç¨‹ï¼Œä½ å¯èƒ½ä¼šå¯¹æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„æœ‰æ›´å¤šçš„äº†è§£ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†æ•™ä½ å¦‚ä½•ä» Github ç¯å¢ƒä¸­æ£€ç´¢ç§˜å¯†ã€‚ä¸ºäº†æ”¯æŒè¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¿…é¡»åšä¸€äº›ä»£ç æ›´æ”¹ã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="a9af" class="ks kt hi kp b fi ku kv l kw kx">const REGION = "us-east-1";<br/>const s3Client = new S3Client({ region: REGION, credentials: {accessKeyId: process.env.REACT_APP_ACCESS_KEY_ID as string, secretAccessKey: process.env.REACT_APP_SECRET_ACCESS_KEY as string} });</span></pre><p id="fc42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬åœ¨ Github ä¸­æ·»åŠ å¯†é’¥ã€‚è½¬åˆ° Github è®¾ç½®ï¼Œä½ ä¼šåœ¨é‚£é‡Œæ‰¾åˆ°ä¸€ä¸ªå«åšç¯å¢ƒçš„éƒ¨åˆ†ã€‚è½¬åˆ°ç¯å¢ƒå¹¶æ·»åŠ è¿™æ ·çš„ç§˜å¯†ã€‚</p><figure class="kk kl km kn fd lp er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es nc"><img src="../Images/c6ab34fc4b345c0e3a80cfca1adaaae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSdZvy6zdeT7l9Zr9awi6A.png"/></div></div></figure><p id="a78a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ”¹æˆ‘ä»¬çš„æ„å»ºç®¡é“æ–‡ä»¶ page_build.ymlã€‚</p><pre class="kk kl km kn fd ko kp kq kr aw kj bi"><span id="2b24" class="ks kt hi kp b fi ku kv l kw kx">name: React Build<br/><br/>on:<br/>  pull_request:<br/>    branches: [ "main" ]<br/>    <br/>env:<br/>  CI: false<br/><br/>jobs:<br/>  build:<br/>    runs-on: ubuntu-latest<br/>    environment:<br/>      name: github-pages<br/>      url: ${{ steps.deployment.outputs.page_url }}<br/>    permissions:<br/>      contents: 'read'<br/>      id-token: 'write'<br/>      pages: 'write'<br/>      actions: 'write'<br/>      checks: 'write'<br/>      deployments: 'write'<br/>    strategy:<br/>      matrix:<br/>        node-version: [18.x]<br/>    <strong class="kp hj">env:<br/>      REACT_APP_ACCESS_KEY_ID: ${{ secrets.REACT_APP_ACCESS_KEY_ID }}<br/>      REACT_APP_SECRET_ACCESS_KEY: ${{ secrets.REACT_APP_SECRET_ACCESS_KEY }}</strong><br/>    <br/>    steps:<br/>    - uses: actions/checkout@v3<br/><br/>    - name: Use Node.js ${{ matrix.node-version }}<br/>      uses: actions/setup-node@v3<br/>      with:<br/>        node-version: ${{ matrix.node-version }}<br/><br/>    - name: Build<br/>      run: |<br/>        npm install<br/>        npm run build<br/>        <br/>    - name: Setup Pages<br/>      uses: actions/configure-pages@v2<br/>    - name: Upload artifact<br/>      uses: actions/upload-pages-artifact@v1<br/>      with:<br/>        <em class="ky"># Upload entire repository<br/>        </em>path: 'build/'<br/>    - name: Deploy to GitHub Pages<br/>      id: deployment<br/>      uses: actions/deploy-pages@v1<br/>      env:  <br/>        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}</span></pre><p id="d433" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œå½“æ‚¨åˆ›å»ºä¸€ä¸ªä»å¦ä¸€ä¸ªåˆ†æ”¯åˆ°ä¸»åˆ†æ”¯çš„æ‹‰è¯·æ±‚æ—¶ï¼Œè¿™å°†è§¦å‘ï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªå°†æ–‡ä»¶ä¿å­˜åˆ°æ‚¨çš„ S3 å­˜å‚¨æ¡¶çš„å·¥ä½œåº”ç”¨ç¨‹åºã€‚</p></div></div>    
</body>
</html>