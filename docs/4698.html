<html>
<head>
<title>How to use Rust inside your Electron application with Neon Bindings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•åœ¨ä½ çš„ç”µå­åº”ç”¨ä¸­ä½¿ç”¨ Rust ä¸ Neon ç»‘å®š</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/how-to-use-rust-inside-your-electron-application-using-neon-bindings-64bd83fec316?source=collection_archive---------2-----------------------#2021-08-03">https://medium.com/nerd-for-tech/how-to-use-rust-inside-your-electron-application-using-neon-bindings-64bd83fec316?source=collection_archive---------2-----------------------#2021-08-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="2567" class="io ip hi ik b fi iq ir l is it">// What is it for?<br/>/* If you have an Electron application that needs to be more performant in some tasks, if you need to access something on operating system or even to try the Rust language.</span></pre><p id="b617" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Github åº“:ã€https://github.com/cazetto/neon-electron T2ã€‘</p><figure class="if ig ih ii fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es jt"><img src="../Images/6efb1ddebd28afe17bd7598cff313211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*21DgcFfS2IY4ljye"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated"><a class="ae js" href="https://unsplash.com/@mullyadii?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ç©†åˆ©äºšè¿ª</a>åœ¨<a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</figcaption></figure><p id="b064" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¤§å®¶å¥½ã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åœ¨ Medium ä¸ŠæŠ•ç¨¿ï¼Œå¸Œæœ›å¤§å®¶å–œæ¬¢ï¼</p><p id="8655" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»Šå¤©æˆ‘ä»¬å°†ä½¿ç”¨ Rust è¯­è¨€çš„è¶…çº§èƒ½åŠ›åˆ›å»ºä¸€ä¸ªç”µå­åº”ç”¨ç¨‹åºã€‚</p><h2 id="2785" class="io ip hi bd kf kg kh ki kj kk kl km kn jf ko kp kq jj kr ks kt jn ku kv kw kx bi translated">å…ˆå†³æ¡ä»¶:</h2><p id="52ee" class="pw-post-body-paragraph iu iv hi iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr hb bi translated">å®‰è£…èŠ‚ç‚¹:https://nodejs.org/en/download/<a class="ae js" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"/></p><p id="95ac" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å®‰è£…é“é”ˆ:<a class="ae js" href="https://www.rust-lang.org/tools/install" rel="noopener ugc nofollow" target="_blank">https://www.rust-lang.org/tools/install</a></p><h1 id="c765" class="ld ip hi bd kf le lf lg kj lh li lj kn lk ll lm kq ln lo lp kt lq lr ls kw lt bi translated">ç”Ÿé”ˆçš„éƒ¨åˆ†</h1><h2 id="440a" class="io ip hi bd kf kg kh ki kj kk kl km kn jf ko kp kq jj kr ks kt jn ku kv kw kx bi translated">éœ“è™¹æ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote class="lu lv lw"><p id="5605" class="iu iv lx iw b ix iy iz ja jb jc jd je ly jg jh ji lz jk jl jm ma jo jp jq jr hb bi translated">Neon æ˜¯ä¸€ä¸ªåº“å’Œå·¥å…·é“¾ï¼Œç”¨äºåœ¨ä½ çš„ NodeJS åº”ç”¨ç¨‹åºå’Œåº“ä¸­åµŒå…¥ Rustã€‚</p></blockquote><h2 id="7f15" class="io ip hi bd kf kg kh ki kj kk kl km kn jf ko kp kq jj kr ks kt jn ku kv kw kx bi translated">ä»€ä¹ˆæ˜¯éœ“è™¹é¡¹ç›®ï¼Ÿ</h2><blockquote class="lu lv lw"><p id="3aa3" class="iu iv lx iw b ix iy iz ja jb jc jd je ly jg jh ji lz jk jl jm ma jo jp jq jr hb bi translated">éœ“è™¹é¡¹ç›®æ—¢æ˜¯ä¸€ä¸ª<a class="ae js" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">èŠ‚ç‚¹</a> <a class="ae js" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>åŒ…ï¼Œåˆæ˜¯ä¸€ä¸ª<a class="ae js" href="https://www.rust-lang.org/" rel="noopener ugc nofollow" target="_blank">é”ˆ</a> <a class="ae js" href="https://crates.io/" rel="noopener ugc nofollow" target="_blank">æ¿æ¡ç®±</a>åŒ…ã€‚</p></blockquote><p id="aacb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„éœ“è™¹ç¯é¡¹ç›®ã€‚</p><p id="7306" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘å¼•ç”¨äº† Neon æ–‡æ¡£ï¼Œæˆ‘ä»¬é¡¹ç›®çš„åŸºç¡€æ˜¯ Neon hello-world æ•™ç¨‹çš„ä»£ç ç»“æœã€‚</p><p id="b971" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://neon-bindings.com/docs/hello-world" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">https://neon-bindings.com/docs/hello-world</strong></a></p><p id="3868" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬å°†é¦–å…ˆåˆ›å»ºä¸€ä¸ªåä¸º neon-electronic çš„ neon é¡¹ç›®:</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="c7fc" class="io ip hi ik b fi iq ir l is it">npm init neon neon-electron</span></pre><p id="6dbf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™å°†ç”Ÿæˆä¸€ä¸ªåŒ…å«ä¸€ä¸ª<code class="du mb mc md ik b">Cargo.toml</code>å’Œä¸€ä¸ª<code class="du mb mc md ik b">package.json</code>æ–‡ä»¶çš„æ–°é¡¹ç›®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆ:</p><p id="ff06" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://doc.rust-lang.org/cargo/" rel="noopener ugc nofollow" target="_blank"> Cargo </a>æ˜¯ Rust åŒ…ç®¡ç†å™¨ï¼Œå°±åƒåœ¨ node ä¸­æˆ‘ä»¬æœ‰<a class="ae js" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>ï¼Œåœ¨ Rust ä¸­æˆ‘ä»¬æœ‰<a class="ae js" href="https://doc.rust-lang.org/cargo/" rel="noopener ugc nofollow" target="_blank"> Cargo </a>ã€‚</p><p id="f73c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬æœ‰ä¸€ä¸ª<code class="du mb mc md ik b">src/lib.rs</code>ï¼Œè¿™å°±æ˜¯ç¥å¥‡å‘ç”Ÿçš„åœ°æ–¹ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„ Rust éƒ¨åˆ†ï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å…±äº«å…³äºæ‚¨è®¡ç®—æœºä¸­ CPU æ•°é‡çš„ä¿¡æ¯ï¼Œå°±åƒåœ¨ Neon Bindings hello world æ•™ç¨‹ä¸­ä¸€æ ·ã€‚</p><p id="1ac0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">é¦–å…ˆåœ¨æˆ‘ä»¬çš„ Cargo.toml ä¸­æ·»åŠ <code class="du mb mc md ik b">num_cpus</code> Rust åº“ä½œä¸ºä¾èµ–é¡¹ã€‚</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="0eb1" class="io ip hi ik b fi iq ir l is it">[dependencies]<br/>num_cpus = "1"</span></pre><p id="4360" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿è¡Œ yarn æ¥å®‰è£…ä¾èµ–é¡¹:</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="6427" class="io ip hi ik b fi iq ir l is it">yarn</span></pre><p id="f020" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨ï¼Œåœ¨<code class="du mb mc md ik b">lib.rs,</code>å†…éƒ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºé€šè¿‡<a class="ae js" href="https://crates.io/crates/num_cpus" rel="noopener ugc nofollow" target="_blank">num _ CPU</a>Rust crate è¯»å– CPU æ•°é‡çš„å‡½æ•°:</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="fef2" class="io ip hi ik b fi iq ir l is it">fn get_num_cpus(mut cx: FunctionContext) -&gt; JsResult&lt;JsNumber&gt; {</span><span id="f90d" class="io ip hi ik b fi me ir l is it">  Ok(cx.number(num_cpus::get() as f64));</span><span id="0977" class="io ip hi ik b fi me ir l is it">}</span></pre><p id="9638" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æœ€åï¼Œæˆ‘ä»¬ä» Rust ä»£ç ä¸­å¯¼å‡ºæˆ‘ä»¬çš„å‡½æ•°ï¼Œå®ƒå°†åœ¨ç”Ÿæˆçš„æ–‡ä»¶<code class="du mb mc md ik b">index.node</code>ä¸­å¯ç”¨ã€‚</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="2f62" class="io ip hi ik b fi iq ir l is it">#[neon::main]</span><span id="949a" class="io ip hi ik b fi me ir l is it"><em class="lx">fn</em> main(<em class="lx">mut</em> cx: ModuleContext) -&gt; NeonResult&lt;()&gt; {</span><span id="cab0" class="io ip hi ik b fi me ir l is it">  cx.export_function("get", get_num_cpus)?;</span><span id="99d4" class="io ip hi ik b fi me ir l is it">  Ok(())</span><span id="35ee" class="io ip hi ik b fi me ir l is it">}</span></pre><p id="00f8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><code class="du mb mc md ik b">lib.rs</code>ä»£ç å˜æˆäº†:</p><figure class="if ig ih ii fd ju"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="f339" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨æˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿé‡å»ºé¡¹ç›®äº†:</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="d070" class="io ip hi ik b fi iq ir l is it">npm run build -- --release</span></pre><p id="bbb3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ç»ˆç«¯ä¸­æ‰“å¼€ NodeJS å¹¶è¿è¡Œç”Ÿæˆçš„ä»£ç æ¥æµ‹è¯•å®ƒ:</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="a933" class="io ip hi ik b fi iq ir l is it">node</span><span id="7755" class="io ip hi ik b fi me ir l is it">&gt; const cpuCount = require('.')</span><span id="61ab" class="io ip hi ik b fi me ir l is it">&gt; cpuCount.get()</span><span id="3bdf" class="io ip hi ik b fi me ir l is it">4</span></pre><h1 id="9f5e" class="ld ip hi bd kf le lf lg kj lh li lj kn lk ll lm kq ln lo lp kt lq lr ls kw lt bi translated">ç”µå­éƒ¨åˆ†</h1><p id="fd19" class="pw-post-body-paragraph iu iv hi iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr hb bi translated">å°†ç”µå­ä½œä¸ºä»å±é¡¹æ·»åŠ :</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="0c1c" class="io ip hi ik b fi iq ir l is it">yarn add -D electron</span></pre><p id="0f71" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å°†ç”µå­å¯åŠ¨è„šæœ¬æ·»åŠ åˆ°<code class="du mb mc md ik b">package.json</code></p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="806b" class="io ip hi ik b fi iq ir l is it">{<br/>  "scripts": {<br/>    "dev": "electron ./src/main.js",<br/>  }<br/>}</span></pre><p id="dfd5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åˆ›å»ºä¸€ä¸ª<code class="du mb mc md ik b">src/main.js</code>æ–‡ä»¶:</p><figure class="if ig ih ii fd ju"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="468f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åˆ›å»º<code class="du mb mc md ik b">src/preload.js</code>è„šæœ¬:</p><figure class="if ig ih ii fd ju"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="fee2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åˆ›å»º<code class="du mb mc md ik b">src/index.html</code>æ–‡ä»¶:</p><figure class="if ig ih ii fd ju"><div class="bz dy l di"><div class="mf mg l"/></div></figure></div><div class="ab cl mh mi gp mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hb hc hd he hf"><h2 id="a166" class="io ip hi bd kf kg kh ki kj kk kl km kn jf ko kp kq jj kr ks kt jn ku kv kw kx bi translated">å°†ä¸¤éƒ¨åˆ†ç»“åˆèµ·æ¥:</h2><p id="ea2e" class="pw-post-body-paragraph iu iv hi iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr hb bi translated">åœ¨æˆ‘ä»¬çš„<code class="du mb mc md ik b">src/index.html</code>ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªæ–°å…ƒç´ æ¥æ˜¾ç¤º CPU çš„æ•°é‡ã€‚</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="c378" class="io ip hi ik b fi iq ir l is it">&lt;p&gt;</span><span id="e41a" class="io ip hi ik b fi me ir l is it">  &lt;span&gt;CPUs:&lt;/span&gt;</span><span id="576c" class="io ip hi ik b fi me ir l is it">  &lt;span <em class="lx">id</em>="number-of-cpus"&gt;&lt;/span&gt;</span><span id="f1ad" class="io ip hi ik b fi me ir l is it">&lt;/p&gt;</span></pre><p id="2a0e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><code class="du mb mc md ik b">src/ndex.html</code>æ–‡ä»¶å˜æˆ:</p><figure class="if ig ih ii fd ju"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="99d6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨<code class="du mb mc md ik b">src/preload.js</code>æ–‡ä»¶ä¸­æˆ‘ä»¬éœ€è¦å¯¼å…¥ Neon ç”Ÿæˆçš„ä»£ç :</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="2d25" class="io ip hi ik b fi iq ir l is it">const lib = require('../index.node');</span></pre><p id="3a5d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">DOMContentLoader å›è°ƒå†…éƒ¨:</p><pre class="if ig ih ii fd ij ik il im aw in bi"><span id="d610" class="io ip hi ik b fi iq ir l is it">const numberOfCPUs = lib.get();</span><span id="7098" class="io ip hi ik b fi me ir l is it">const numberOfCPUsElement = document.getElementById(â€˜number-of-cpusâ€™);</span><span id="0b4b" class="io ip hi ik b fi me ir l is it">numberOfCPUsElement.innerText = numberOfCPUs;</span></pre><p id="dcce" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ¯”ï¼Œ<code class="du mb mc md ik b">src/preloader.js</code>å°±å˜æˆäº†:</p><figure class="if ig ih ii fd ju"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="05ca" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿è¡Œ<code class="du mb mc md ik b">yarn dev</code>å¹¶çœ‹åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä» Rust åˆ° NodeJS çš„ CPU æ•°æ®æ•°é‡ã€‚</p><figure class="if ig ih ii fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es mo"><img src="../Images/18c6c5154ed65333ef993b8eae702d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWOKtXYv3S2IuraIaBbKyQ.png"/></div></div></figure><p id="e9b7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä¹Ÿå°±è¿™äº›äº†ï¼Œå¯ä»¥éšæ„å’Œè¿™ä¸ªå¸–å­äº’åŠ¨ï¼Œé—®ç‚¹ä»€ä¹ˆæˆ–è€…å»ºè®®ç‚¹ä»€ä¹ˆï¼Œå¦‚æœæœ‰é”™å°±å‘Šè¯‰æˆ‘ã€‚</p><p id="e50c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è®©æˆ‘çŸ¥é“è¿™ä¸ªæ•™ç¨‹æ˜¯å¦å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥æŒ‡å¯¼è‡ªå·±å†™æ›´å¥½çš„å¸–å­ã€‚</p><p id="d34b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¸Œæœ›ä½ å–œæ¬¢å®ƒğŸš€</p></div></div>    
</body>
</html>