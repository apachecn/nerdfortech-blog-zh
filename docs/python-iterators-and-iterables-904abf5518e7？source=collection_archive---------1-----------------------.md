# Python è¿­ä»£å™¨å’Œå¯è¿­ä»£å¯¹è±¡

> åŸæ–‡ï¼š<https://medium.com/nerd-for-tech/python-iterators-and-iterables-904abf5518e7?source=collection_archive---------1----------------------->

## å¯¹å®ƒä»¬æ˜¯ä»€ä¹ˆã€å®ƒä»¬å¦‚ä½•å·¥ä½œä»¥åŠæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„åˆ†æã€‚

![](img/e17a4ff28698b23c0f0a4f98e43a4e3b.png)

æ— é™é˜¶æ¢¯[https://www.flickr.com/photos/gadl/288607676/](https://www.flickr.com/photos/gadl/288607676/)

# ä»‹ç»

ä¸€ä¸ª Python [è¿­ä»£å™¨](https://docs.python.org/3.9/glossary.html#term-iterator)è¢«å®šä¹‰ä¸º

> *ä»£è¡¨æ•°æ®æµçš„å¯¹è±¡ã€‚*

ç®€è€Œè¨€ä¹‹ï¼Œè¿­ä»£å™¨æ˜¯ä¸€ä¸ªå¯ä»¥è¿­ä»£çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è®¿é—®å…ƒç´ ï¼Œç›´åˆ°ä¸€ä¸ªå…ƒç´ éƒ½ä¸å‰©ã€‚

ä¾‹å¦‚ï¼Œåˆ—è¡¨æ˜¯ä½¿ç”¨å¾ªç¯è®¿é—®çš„æ•°æ®çš„é¡ºåºé›†åˆã€‚

```
my_list = ['a','b','c']
for letter in my_list:
  print(letter)
```

æˆ‘ä»¬å¯ä»¥å¾ªç¯çš„å¯¹è±¡è¢«å®šä¹‰ä¸ºå¯è¿­ä»£çš„ã€‚è¿­ä»£å™¨å’Œ **Iterables** æ˜¯ä¸¤ä¸ªä¸»è¦çš„ Python æ¦‚å¿µï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿæ··æ·†ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸¥æ ¼ç›¸å…³çš„ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬å°†åˆ†æ Python è¿­ä»£å™¨å’Œå¯è¿­ä»£å¯¹è±¡çš„å®šä¹‰

**å®šä¹‰**:iterable æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥è¿­ä»£çš„å¯¹è±¡ã€‚

**å®šä¹‰**:è¿­ä»£å™¨æ˜¯å¯ä»¥è¢«è¿­ä»£çš„å¯¹è±¡ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå…è®¸æˆ‘ä»¬è¿­ä»£ä¸€ä¸ª*å¯è¿­ä»£*å¯¹è±¡çš„å¯¹è±¡ã€‚

è¿™ä¸¤ä¸ªå®šä¹‰å¬èµ·æ¥å¯èƒ½æœ‰ç‚¹æ··ä¹±ï¼Œæ‰€ä»¥æˆ‘å°†è§£é‡Šç»†èŠ‚ï¼Œä»¥ä¾¿æœ‰ä¸€ä¸ªæ¸…æ™°çš„ç”»é¢ã€‚

ä»æŠ€æœ¯è§’åº¦æ¥çœ‹ï¼ŒPython å°†**è¿­ä»£å™¨**å®šä¹‰ä¸ºå®ç°**è¿­ä»£å™¨åè®®**çš„å¯¹è±¡ï¼Œè¯¥åè®®ç”±ä¸¤ä¸ªæ–¹æ³•ç»„æˆ:

**__next__** :è¿”å›å®¹å™¨çš„**ä¸‹ä¸€ä¸ª**é¡¹ã€‚

**__iter__** :è¿”å›**è¿­ä»£å™¨**æœ¬èº«ã€‚

> é‡å¤è°ƒç”¨è¿­ä»£å™¨çš„ __next__()æ–¹æ³•(æˆ–å°†å…¶ä¼ é€’ç»™å†…ç½®å‡½æ•° next())ä¼šè¿”å›æµä¸­çš„è¿ç»­é¡¹ã€‚
> 
> å½“æ²¡æœ‰æ›´å¤šçš„æ•°æ®å¯ç”¨æ—¶ï¼Œå°†å¼•å‘ StopIteration å¼‚å¸¸ã€‚
> 
> æ­¤æ—¶ï¼Œè¿­ä»£å™¨å¯¹è±¡è¢«è€—å°½ï¼Œå¯¹å®ƒçš„ __next__()æ–¹æ³•çš„ä»»ä½•è¿›ä¸€æ­¥è°ƒç”¨åªæ˜¯å†æ¬¡å¼•å‘ StopIterationã€‚

**__next__()** æ–¹æ³•è¿”å›æ•°æ®æµä¸­çš„**ä¸ªè¿ç»­é¡¹ã€‚**

é‡å¤è°ƒç”¨ **__next__()** æœ€ç»ˆä¼šåœ¨æ²¡æœ‰æ›´å¤šå¯ç”¨æ•°æ®æ—¶å¼•å‘ StopIteration å¼‚å¸¸**ã€‚**

æ­¤æ—¶ï¼Œæ•°æ®åºåˆ—è¢«è€—å°½ï¼Œå¯¹ **__next__()** çš„ä»»ä½•è¿›ä¸€æ­¥è°ƒç”¨éƒ½ä¼šå†æ¬¡å¼•å‘ **StopIteration** å¼‚å¸¸ã€‚

# Python å†…ç½®çš„å¯è¿­ä»£è¡¨

åœ¨ Python ä¸­ï¼Œæœ‰**å†…ç½®çš„ Iterables** æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚

*   åˆ—è¡¨
*   å…ƒç»„
*   ç”¨çº¿ä¸²
*   å­—å…¸

æ ¹æ®å®šä¹‰ï¼Œä¸€ä¸ª**å¯è¿­ä»£çš„**æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥è¿­ä»£çš„å¯¹è±¡ã€‚

æˆ‘ä»¬ä½¿ç”¨ ***for â€” in*** é”®è¿­ä»£ä¸€ä¸ª Iterableã€‚

è®©æˆ‘ä»¬è¯•ç€å»ç†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¦‚ä½•åœ¨å…ƒç´ é—´å¾ªç¯ã€‚

```
list_of_numbers = [1,2,3,4]
my_tuple = ('first','second','third')
my_str = 'hello world'

for i in list_of_numbers:
    print(i)

#Output
#1
#2
#3
#4

for i in my_tuple:
    print(i)

#Output
#first
#second
#third

for i in my_str:
    print(i)

#Output
#h
#e
#l
#l
#o

#w
#o
#r
#l
#d
```

è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°çœ‹çœ‹**å¯è¿­ä»£åˆ—è¡¨**ï¼Œä½¿ç”¨ [**dir** å‡½æ•°](https://docs.python.org/3/library/functions.html#dir)æ¥æ˜¾ç¤ºæˆ‘ä»¬çš„ *list_of_numbers* ä¸­çš„æ‰€æœ‰æ–¹æ³•å’Œå±æ€§

```
dir(list_of_numbers)
['__add__', '__class__', '__contains__', '__delattr__', '__delitem__', 
'__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', 
'__getitem__', '__gt__', '__hash__', '__iadd__', '__imul__', '__init__', 
'__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', 
'__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__reversed__',
 '__rmul__', '__setattr__', '__setitem__', '__sizeof__', '__str__', 
 '__subclasshook__', 'append', 'clear', 'copy', 'count', 'extend', 
 'index', 'insert', 'pop', 'remove', 'reverse', 'sort']
```

æˆ‘ä»¬çœ‹åˆ°ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ª **__iter__()** æ–¹æ³•ï¼Œç”¨äºè¿­ä»£*list _ of _ numbers*çš„å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åšæ¥çœ‹çœ‹å®ƒ

```
list_of_numbers.__iter__()
<list_iterator object at 0x7fc9700cc220>
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ å®ç° **__iter__()** æ–¹æ³•çš„å¯¹è±¡æ˜¯**å¯è¿­ä»£çš„**æ¥ä¸°å¯Œæˆ‘ä»¬ä¹‹å‰çš„å®šä¹‰ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨ od ä¸Šå¾ªç¯ã€‚

è¿™åŒæ ·é€‚ç”¨äº*æˆ‘çš„å…ƒç»„*å’Œ*æˆ‘çš„å­—ç¬¦ä¸²*

```
dir(my_tuple)
['__add__', '__class__', '__contains__', '__delattr__', '__dir__', 
'__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', 
'__getitem__', '__getnewargs__', '__gt__', '__hash__', '__init__', 
'__init_subclass__', '__iter__', '__le__', '__len__', '__lt__', '__mul__', 
'__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmul__', 
'__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'count', 'index']dir(my_str)
['__add__', '__class__', '__contains__', '__delattr__', '__dir__', '__doc__', 
'__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', 
'__gt__', '__hash__', '__init__', '__init_subclass__', '__iter__', '__le__', 
'__len__', '__lt__', '__mod__', '__mul__', '__ne__', '__new__', '__reduce__', 
'__reduce_ex__', '__repr__', '__rmod__', '__rmul__', '__setattr__', '__sizeof__', 
'__str__', '__subclasshook__', 'capitalize', 'casefold', 'center', 'count', 
'encode', 'endswith', 'expandtabs', 'find', 'format', 'format_map', 'index', 
'isalnum', 'isalpha', 'isascii', 'isdecimal', 'isdigit', 'isidentifier', 
'islower', 'isnumeric', 'isprintable', 'isspace', 'istitle', 'isupper', 
'join', 'ljust', 'lower', 'lstrip', 'maketrans', 'partition', 'replace', 
'rfind', 'rindex', 'rjust', 'rpartition', 'rsplit', 'rstrip', 'split', 
'splitlines', 'startswith', 'strip', 'swapcase', 'title', 'translate', 
'upper', 'zfill']
```

ä½†æ˜¯ **__next__()** æ–¹æ³•åœ¨ *my_str* ã€ *my_tuple* å’Œ *list_of_numbers* ä¸­æ²¡æœ‰å®ç°ã€‚å› æ­¤ï¼Œæ ¹æ®æˆ‘ä»¬çš„å®šä¹‰ï¼Œæˆ‘ä»¬ä¸å¤„ç†**è¿­ä»£å™¨**ã€‚

```
list_of_numbers.__next__()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'list' object has no attribute '__next__'
>>> next(list_of_numbers)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'list' object is not an iterator
```

æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œlist å¯¹è±¡ä¸æ˜¯è¿­ä»£å™¨ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å®ç°**è¿­ä»£å™¨åè®®ï¼Œ**ï¼Œç¨åæˆ‘ä»¬å°†äº†è§£åŸå› ã€‚

ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥ä»æˆ‘ä»¬æ‰€çŸ¥é“çš„å¼€å§‹ï¼Œåœ¨è¿™é‡Œæ–½å±•ä¸€äº›é­”æ³•:

list_of_number æœ‰ **__iter__()** æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥éå†æ‰€æœ‰çš„å…ƒç´ ã€‚

```
elem = list_of_numbers.__iter__()
```

**__iter__()** æ–¹æ³•è¿”å›ä¸€ä¸ª**è¿­ä»£å™¨**å¯¹è±¡ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ª Python è¿­ä»£å™¨å®ç°äº† **__next__()** æ–¹æ³•

```
elem
<list_iterator object at 0x106a36880>
type(elem)
<class 'list_iterator'>
```

å› æ­¤ï¼Œå¦‚æœ *elem* æ˜¯ä¸€ä¸ª Python è¿­ä»£å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **__next()__** æ–¹æ³•ï¼Œç›´åˆ° **StopIteration** å¼‚å¸¸è¢«å¼•å‘ã€‚

```
elem.__next__()
1
elem.__next__()
2
elem.__next__()
3
elem.__next__()
4
elem.__next__()
Traceback (most recent call last):
  File "<input>", line 1, in <module>
StopIteration
```

ä¸€åˆ†é’±ä¸€åˆ†è´§ï¼**è¿­ä»£å™¨åè®®**å¾—åˆ°éªŒè¯ã€‚

éœ€è¦è®°ä½çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œç”±äº**æ²¡æœ‰è¿”å›**ï¼Œ**çš„æ–¹æ³•ï¼Œæˆ‘ä»¬åªèƒ½ç”¨è¿­ä»£å™¨å‰è¿›ã€‚**

æ²¡æœ‰åŠæ³•è®¿é—®å‰é¢çš„å…ƒç´ ï¼Œé‡ç½®è¿­ä»£å™¨çš„å”¯ä¸€æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ï¼Œæˆ‘ç¨åä¼šå±•ç¤ºã€‚

å½“ç„¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šä»¥è¿™ç§æ–¹å¼ä½¿ç”¨è¿­ä»£å™¨ï¼Œä½†æ˜¯å®ƒè®©æˆ‘ä»¬çœ‹åˆ°äº†äº‹ç‰©å†…éƒ¨æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

# Iterables å’Œè¿­ä»£å™¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ‰€å­¦çš„å†…å®¹ã€‚

æˆ‘ä»¬å·²ç»çœ‹åˆ°**è¿­ä»£å™¨**å’Œ**è¿­ä»£å™¨**å¯ä»¥æ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œå³ä½¿å®ƒä»¬å¹¶ä¸æ€»æ˜¯æˆ–å¿…é¡»å¦‚æ­¤ã€‚

æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å®ç°äº† **__iter__()** å’Œ **__next__()** æ–¹æ³•ï¼Œå°±å¯ä»¥å®šä¹‰è¿­ä»£å™¨ã€‚

æˆ‘ä»¬å·²ç»éªŒè¯äº†åˆ—è¡¨å®ç°äº† **__iter__()** æ–¹æ³•ï¼Œåˆ—è¡¨å¯ä»¥å®šä¹‰ä¸º Iterablesï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»è¯æ˜äº†åˆ—è¡¨ä¸æ˜¯è¿­ä»£å™¨ã€‚

```
next(list_of_numbers)
Traceback (most recent call last):
  File "<input>", line 1, in <module>
TypeError: 'list' object is not an iterator

next(my_tuple)
Traceback (most recent call last):
  File "<input>", line 1, in <module>
TypeError: 'tuple' object is not an iterator
next(my_str)
Traceback (most recent call last):
  File "<input>", line 1, in <module>
TypeError: 'str' object is not an iterator
```

æ‰€ä»¥ï¼Œ*åˆ—è¡¨*ï¼Œ*å…ƒç»„*ï¼Œ*å­—ç¬¦ä¸²*æ˜¯**å¯è¿­ä»£**ä½†æ˜¯**æœ¬èº«ä¸æ˜¯è¿­ä»£å™¨**ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•ä½¿ *list_of_numbers* æˆä¸º**è¿­ä»£å™¨**ã€‚

**è¿­ä»£å™¨**å’Œ**è¿­ä»£å™¨**çš„æ¦‚å¿µæ˜¯åˆ†å¼€çš„ï¼Œå› ä¸º**è¿­ä»£å™¨**è·Ÿè¸ªå…ƒç´ çš„å†…éƒ¨ä½ç½®ã€‚æ¯•ç«Ÿï¼Œ**è¿­ä»£å™¨**éœ€è¦ç»´æŠ¤ä¸‹ä¸€ä¸ª**è¿”å›å“ªä¸ªå…ƒç´ çš„ä¿¡æ¯ã€‚**

ç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦

> å¦‚æœ Iterables è¦ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬ä¸€æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªå¾ªç¯ã€‚å¦åˆ™ï¼Œå…¶ä»–å¾ªç¯ä¼šå¹²æ‰°ç¬¬ä¸€ä¸ªå¾ªç¯äº§ç”Ÿçš„çŠ¶æ€ã€‚
> 
> è¿­ä»£å™¨æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬æ€»æ˜¯å¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨å¯¹è±¡ã€‚

Python **è¿­ä»£å™¨ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¿­ä»£**å¯¹è±¡ï¼Œ**ä½†ä¸æ˜¯æ¯ä¸ªå¯è¿­ä»£å¯¹è±¡éƒ½æ˜¯è¿­ä»£å™¨**ã€‚

æˆ‘ä»¬å·²ç»çŸ¥é“åˆ—è¡¨æ˜¯ä¸€ä¸ª**å¯è¿­ä»£**å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª**è¿­ä»£å™¨**ã€‚

# æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿­ä»£å™¨

ä»¥ä¸‹æ˜¯ä½¿ç”¨è¿­ä»£å™¨çš„ä¸€äº›æœ€å¸¸è§çš„æ–¹æ³•

## å¸¦æœ‰å­—ç¬¦ä¸²å’Œåˆ—è¡¨çš„ for å¾ªç¯ä¸­çš„è¿­ä»£å™¨

```
my_str = 'I like Python'
for letter in my_str:
  print(letter)

my_list = list(my_str)
for letter in my_list:
print(letter)

#Outout 
I

l
i
k
e

P
y
t
h
o
```

## åˆ—è¡¨ç†è§£ä¸­çš„è¿­ä»£å™¨

```
[letter for letter in my_list]
['I', ' ', 'l', 'i', 'k', 'e', ' ', 'P', 'y', 't', 'h', 'o', 'n']
```

## å…·æœ‰å­—å…¸é”®å’Œå€¼çš„è¿­ä»£å™¨

```
my_dict = {"brand": "motoguzzi","model":"850T5","year":1987}
>>> for key in my_dict:
...     print(key)
... 
brand
model
yearfor key in my_dict.keys():
...     print(key)
... 
brand
model
yearfor val in my_dict.values():
...     print(val)
... 
motoguzzi
850T5
```

## å¸¦ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„è¿­ä»£å™¨

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨è½»æ¾åœ°è®¿é—®å’Œæ‰“å°æ–‡ä»¶çš„å†…å®¹ï¼Œå› ä¸º[*open()*](https://docs.python.org/3/library/functions.html#open)*å‡½æ•°è¿”å›ä¸€ä¸ª **Iterable** å¯¹è±¡*

```
*with open('my_bikes.txt') as bikes:
   for bike in bikes:
      print(bike)*
```

# *iter å†…ç½®å‡½æ•°*

*Python æœ‰ä¸€ä¸ªå†…ç½®çš„ iter()å‡½æ•°æ¥è·å–è¿­ä»£å™¨ï¼Œè¿˜æœ‰ä¸€ä¸ª [**next()** å‡½æ•°](https://docs.python.org/3/library/functions.html#next)æ¥éå†å®ƒçš„å…ƒç´ ã€‚*

***è¿­ä»£å™¨**å¯ä»¥ä½¿ç”¨ [**iter()** å†…ç½®å‡½æ•°](https://docs.python.org/3/library/functions.html#iter)ä»åºåˆ—ä¸­è½»æ¾åˆ›å»ºã€‚*

*æˆ‘ä»¬å·²ç»çŸ¥é“ **Iterable** æ˜¯ä¸€ä¸ªæˆ‘ä»¬è¿­ä»£çš„å¯¹è±¡ï¼Œå½“ä¼ é€’ç»™**ITER()**å‡½æ•°æ—¶ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨ã€‚*

*ğŸ”–å¯ä»¥é€šè¿‡ä½¿ç”¨[å‡½æ•° iter()](https://docs.python.org/3/library/functions.html#iter) ä» iterable åˆ›å»ºè¿­ä»£å™¨ã€‚*

*åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œå¯¹è±¡çš„ç±»éœ€è¦ä¸€ä¸ªæ–¹æ³• **__iter__** ï¼Œå®ƒè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæˆ–è€…ä¸€ä¸ª **__getitem__** æ–¹æ³•ï¼Œå…¶é¡ºåºç´¢å¼•ä» 0 å¼€å§‹ã€‚*

```
*my_iterator = iter(list_of_numbers)
type(my_iterator)
<class 'list_iterator'>
while my_iterator:
    print(next(my_iterator))

2
3
4
Traceback (most recent call last):
  File "<input>", line 2, in <module>
StopIteration*
```

***iter()** ä¸è°ƒç”¨ **__iter__()** ç›¸åŒ*

***next()** ä¸è°ƒç”¨ **__next__()** ç›¸åŒ*

*è®©æˆ‘ä»¬çœ‹å¦ä¸€ä¸ªä¾‹å­ã€‚è¯­æ³•ç°åœ¨åº”è¯¥å¾ˆç†Ÿæ‚‰äº†ï¼Œ*

```
*>>> x = iter(["motoguzzi","ferrari","maserati"])
>>> print(next(x))
motoguzzi
>>> print(next(x))
ferrari
>>> print(next(x))
maserati
>>> print(next(x))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
StopIteration
>>>*
```

*å½“æ²¡æœ‰æ›´å¤šçš„é¡¹ç›®è¦å¤„ç†æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ª **StopIteration** å¼‚å¸¸è¢«å¼•å‘ã€‚*

*æˆ‘ä»¬ä¸å¾—ä¸è¯´è¿˜æœ‰ä¸€äº›ç‰¹æ®Šç±»å‹çš„ **Iterables** ï¼Œå«åšç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°ã€‚*

# *å¦‚ä½•æ„å»ºæˆ‘ä»¬çš„è¿­ä»£å™¨*

*ä¸€ç§ç®€å•çš„æ–¹æ³•æ˜¯æŠŠè¿­ä»£å™¨çœ‹æˆä¸€ä¸ªåŒ…å«æ•°æ®çš„å¯¹è±¡ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°ä¸€ä¸ªå¯¹è±¡å¿…é¡»å®ç° **__iter__()** å’Œ **__next__()** æ–¹æ³•ã€‚*

***__next__()** æ–¹æ³•æ˜¯äº§ç”Ÿæ•°æ®çš„æ–¹æ³•ã€‚*

*é‡è¦æç¤º:åªè¦å®šä¹‰äº† **__iter__()** ï¼Œå°±ä¸å¿…å®šä¹‰ **__next__()** ã€‚*

***__iter_()** æ–¹æ³•è¿”å›è¿­ä»£å™¨å¯¹è±¡æœ¬èº«ã€‚æ‰€ä»¥æ¯ä¸ª**è¿­ä»£å™¨**ä¹Ÿæ˜¯ä¸€ä¸ª**å¯è¿­ä»£çš„**å¹¶ä¸”å¯ä»¥åœ¨å¤§å¤šæ•°æ¥å—å…¶ä»–å¯è¿­ä»£çš„åœ°æ–¹ä½¿ç”¨ã€‚*

*è®©æˆ‘ä»¬æ„å»ºæˆ‘ä»¬çš„è¿­ä»£å™¨ï¼Œä¸€ä¸ªè®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„è‡ªå®šä¹‰ç±»ã€‚*

```
*class FibonacciIterator:
        def __init__(self, max: int):
        self.max = max
        self.a = 0
        self.b = 1
        self.counter = self.a

    def __iter__(self):
        """
        This method returns the iterator itself

        :return:
        """

        return self

    def __next__(self):
        """
        This method returns the next element.

        :return:
        """

        if self.counter > self.max:
            raise StopIteration
        else:
            self.a, self.b = self.b, self.a + self.b
            self.counter = self.a
            return self.counter

series = FibonacciIterator(20)
for num in series:
  print(num)
else:
  print("stop")*
```

*å½“æˆ‘ä»¬è¿è¡Œå®ƒæ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°*

```
*1
1
2
3
5
8
13
21
stop*
```

*è¿™é‡Œé‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œå½“æˆ‘ä»¬æ‰“å° stop æ—¶ï¼ŒStopIteration å¼‚å¸¸è¢«æŠ›å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è¿­ä»£å™¨è¢«è€—å°½äº†ã€‚*

*å¦‚æœæˆ‘ä»¬è¿è¡Œå®ƒä¸¤æ¬¡ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æ²¡æœ‰æ›´å¤šçš„å…ƒç´ å¯ç”¨ã€‚*

```
*for num in series:
        print(num)
    else:
        print("stop")
    for num in series:
        print(num)
    else:
        print("stop")*
```

*æˆ‘ä»¬çœ‹åˆ°åœ¨ç¬¬ä¸€ç«™è¢«æ‰“å°åï¼Œæ²¡æœ‰æ›´å¤šçš„æ¡ç›®éœ€è¦è¿­ä»£ã€‚*

```
*1
1
2
3
5
8
13
21
stop
stop*
```

*è¿™æ˜¯å› ä¸ºè¿­ä»£å™¨ä¿æŒçŠ¶æ€ã€‚**è¿­ä»£å™¨éœ€è¦ç»´æŠ¤ä¸‹ä¸€ä¸ªè¿”å›å“ªä¸ªå…ƒç´ çš„ä¿¡æ¯ã€‚***

*å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸€ä¸ª**è¿­ä»£å™¨ï¼Œå®ƒæ°¸è¿œä¸ä¼šè€—å°½å®ƒçš„æ¡ç›®**ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™å¯åŠ¨å®ƒã€‚*

```
*for _ in range(10):
        fibonacci_series = [print(num) for num in FibonacciIterator(20)]*
```

*åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå¾ªç¯ä¸­åˆå§‹åŒ–è¿­ä»£å™¨ã€‚*

*å¦ä¸€ç§å®ç°æ–¹å¼æ˜¯é‡æ„æˆ‘ä»¬çš„è¿­ä»£å™¨**ï¼Œå°†è¿­ä»£çŠ¶æ€å’Œè¿­ä»£å™¨å¯¹è±¡**åˆ†å¼€ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½åšåˆ°ï¼Œä¸ºä»€ä¹ˆå®ƒä¼šæœ‰å¸®åŠ©ã€‚*

*é¦–å…ˆï¼Œéœ€è¦æåˆ°çš„æ˜¯ï¼Œ **__iter__()** è¿˜å¯ä»¥è¿”å›å®ç° **__next__()** æ–¹æ³•çš„å¦ä¸€ä¸ªç±»çš„æ–°å®ä¾‹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªåªå®ç° **__iter__()** æ–¹æ³•çš„ç±»ï¼Œå¹¶åœ¨å•ç‹¬çš„ç±»ä¸­å®šä¹‰ **__next__()** æ–¹æ³•ã€‚*

> *è¿­ä»£å™¨å¿…é¡»æœ‰ä¸€ä¸ª __iter__()æ–¹æ³•è¿”å›è¿­ä»£å™¨å¯¹è±¡æœ¬èº«ï¼Œæ‰€ä»¥æ¯ä¸ªè¿­ä»£å™¨ä¹Ÿæ˜¯å¯è¿­ä»£çš„ï¼Œå¹¶ä¸”å¯èƒ½ç”¨åœ¨å¤§å¤šæ•°æ¥å—å…¶ä»–å¯è¿­ä»£çš„åœ°æ–¹ã€‚*

*å•ç‹¬çš„ç±»ä¹Ÿå¯ä»¥æ˜¯è¿­ä»£å™¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†è¿­ä»£å™¨ä¼ é€’ç»™å®ç°è¿­ä»£å™¨çš„ç±»ï¼Œç„¶åæ¥å—è¿­ä»£å™¨ã€‚*

*è®©æˆ‘ä»¬é€šè¿‡æ·»åŠ  *DotheMath* è¿­ä»£å™¨ç±»æ¥é‡æ„æˆ‘ä»¬æœ€åˆçš„ä¾‹å­ã€‚*

```
*class DoTheMath:
    def __init__(self, max: int):
        self.max = max
        self.a = 0
        self.b = 1
        self.counter = self.a

    def __next__(self):
        """
        This method returns the next element.

        :return:
        """

        if self.counter > self.max:
            raise StopIteration
        else:
            self.a, self.b = self.b, self.a + self.b
            self.counter = self.a
            return self.counter

class FibonacciIterator:
    def __init__(self, max: int):
        self.max = max

    def __iter__(self):
        """
        This method returns the iterator itself

        :return:
        """

        return DoTheMath(self.max)*
```

*æˆ‘ä»¬å¯ä»¥è¿è¡Œå®ƒï¼Œçœ‹çœ‹è¿­ä»£å™¨æ°¸è¿œä¸ä¼šè€—å°½ã€‚*

```
*series = FibonacciIterator(20)
for num in series:
  print(num)
else:
  print("stop")
for num in series:
  print(num)
else:
  print("stop")

1
1
2
3
5
8
13
21
stop
1
1
2
3
5
8
13
21
stop*
```

*æˆ–è€…*

```
*series = FibonacciIterator(20)

for _ in range(10):
  fibonacci_series = [print(num) for num in series]*
```

*æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªå¯é‡ç”¨çš„è¿­ä»£å™¨ï¼Œå› ä¸º**æˆ‘ä»¬å·²ç»åˆ†ç¦»äº†è¿­ä»£çŠ¶æ€å’Œè¿­ä»£å™¨å¯¹è±¡**ã€‚æˆ‘ä»¬å°†ç¡®ä¿æˆ‘ä»¬çš„è¿­ä»£å™¨ä¸ä¼šè€—å°½ã€‚*

*æˆ‘ä»¬å¯ä»¥ç”¨æœ€åˆçš„ FibonacciIterator ç±»å®ç°åŒæ ·çš„è¡Œä¸ºã€‚*

```
*run_this = iter([num for num in FibonacciIterator(10)])*
```

***iter()** å’Œè°ƒç”¨æˆ‘ä»¬çš„ç±» FibonacciIterator çš„ **__iter__()** æ–¹æ³•æ˜¯ä¸€æ ·çš„ã€‚*

***next()** ä¸è°ƒç”¨æˆ‘ä»¬çš„ç±» FibonacciIterator çš„ **__next__()** æ–¹æ³•ç›¸åŒã€‚*

# *ç»“è®º*

*è¿­ä»£å™¨æ˜¯ä¸€ä¸ªå¯ä»¥è¢«è¿­ä»£çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è®¿é—®å…ƒç´ ï¼Œç›´åˆ°æ²¡æœ‰å…ƒç´ ç•™ä¸‹ã€‚å½“æ²¡æœ‰æ›´å¤šçš„å…ƒç´ è¦è®¿é—®æ—¶ï¼Œä¼šå¼•å‘ StopIteration å¼‚å¸¸ã€‚
æˆ‘ä»¬ç”¨æ¥è¿­ä»£çš„å·¥å…·æ˜¯ *for-in* ã€‚æ‰€ä»¥è¿­ä»£å™¨å’Œå¾ªç¯æ˜¯å…¼å®¹çš„ã€‚
æ¯ä¸ªå®ç°è¿­ä»£å™¨åè®®çš„å¯¹è±¡éƒ½å¯ä»¥è¢«è§†ä¸ºè¿­ä»£å™¨ã€‚å¦ä¸€ä»¶å€¼å¾—ä¸€æçš„äº‹æƒ…æ˜¯è¿­ä»£å™¨åœ¨èµ„æºæ–¹é¢ä¹Ÿå¾ˆæœ‰æ•ˆï¼Œå› ä¸ºä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªå…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæä¾›æ— é™å…ƒç´ åºåˆ—çš„è¿­ä»£å™¨æ°¸è¿œä¸ä¼šè€—å°½å®ƒçš„å†…å­˜åˆ†é…ã€‚
å¯è¿­ä»£å¯¹è±¡æ˜¯æˆ‘ä»¬å¯ä»¥è¿­ä»£çš„å¯¹è±¡ã€‚æˆ‘ä»¬ä½¿ç”¨ *for-in* æ¥è¿­ä»£ä¸€ä¸ª iterableã€‚
ä¸€ä¸ª**è¿­ä»£å™¨**æ˜¯ä¸€ä¸ª**å¯è¿­ä»£**ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„**å¯è¿­ä»£**éƒ½æ˜¯**è¿­ä»£å™¨**ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† list æ˜¯å¦‚ä½•å®ç° **__iter__()** æ–¹æ³•å´æ²¡æœ‰å®ç° **__next__()** ã€‚è¦ç†è§£çš„é‡è¦ä¸€ç‚¹æ˜¯è¿­ä»£å™¨ç»´æŠ¤çŠ¶æ€ï¼Œè¿™æ„å‘³ç€å®ƒä»¬çŸ¥é“ä¸‹ä¸€ä¸ªè¦è¿”å›çš„å…ƒç´ (å¦‚æœæœ‰çš„è¯)çš„ä½ç½®ã€‚Iterables ä¸ä¿æŒçŠ¶æ€ï¼Œè¿™å¾ˆå¥½ï¼Œå› ä¸ºå¦‚æœ Iterables è¦ä¿æŒçŠ¶æ€ï¼Œæˆ‘ä»¬ä¸€æ¬¡åªèƒ½ä½¿ç”¨ä¸€ä¸ªå¾ªç¯ã€‚å¦åˆ™ï¼Œå…¶ä»–å¾ªç¯ä¼šå¹²æ‰°ç¬¬ä¸€ä¸ªå¾ªç¯äº§ç”Ÿçš„çŠ¶æ€ã€‚
å¦ä¸€æ–¹é¢ï¼Œè¿­ä»£å™¨æ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨å¯¹è±¡ï¼Œåˆ›å»ºæ°¸è¿œä¸è¿­ä»£çš„è¿­ä»£å™¨ã€‚*