<html>
<head>
<title>Decodable helper that can save you some time</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¯è§£ç çš„åŠ©æ‰‹ï¼Œå¯ä»¥èŠ‚çœä½ ä¸€äº›æ—¶é—´</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/decodable-helper-that-can-save-you-some-time-830e51d01fcf?source=collection_archive---------14-----------------------#2021-04-10">https://medium.com/nerd-for-tech/decodable-helper-that-can-save-you-some-time-830e51d01fcf?source=collection_archive---------14-----------------------#2021-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/39aa9840b79d1bb21e182399d3cbb471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lNcr5FnERufAFHxtNXUWGQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae iu" href="https://unsplash.com/@aronvisuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Aron è§†è§‰æ•ˆæœ</a>åœ¨<a class="ae iu" href="https://unsplash.com/s/photos/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="27ed" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">ç¼–å†™ä¸€ä¸ª iOS åº”ç”¨ç¨‹åºå‡ ä¹æ€»æ˜¯æ¶‰åŠåˆ°å°†æ¥è‡ªåç«¯å“åº”æˆ– JSON æ–‡ä»¶çš„æ•°æ®è§£ææˆæˆ‘ä»¬é¢†åŸŸçš„ç»“æ„æˆ–ç±»ï¼Œå› æ­¤ï¼Œè§£ç æ•°æ®åº”è¯¥å°½å¯èƒ½åœ°å¹²å‡€ã€å®¹æ˜“å‡ºé”™å’Œé€æ˜ã€‚</p><h2 id="ea94" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">é—®é¢˜æ˜¯</h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="bdd5" class="ka kb hi la b fi le lf l lg lh">// 1. Parsing the json (wherever it comes from) to data<br/>let jsonData = JSON.data(using: .utf8)!</span><span id="b1ea" class="ka kb hi la b fi li lf l lg lh">// 2. Decoding the data to the actual structure<br/>let fact = try! JSONDecoder().decode(CatFact.self, from: jsonData)</span></pre><p id="7d73" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">è¿™æ˜¯â€œæœ€â€å¸¸ç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯ï¼Œè¿™ä¸¤è¡Œæ˜¯å¼ºåˆ¶è§£åŒ…å€¼ï¼Œç”±äºå¯èƒ½å‘ç”Ÿâ€œæ„å¤–â€çš„å´©æºƒï¼Œä¸å»ºè®®åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å¯é€‰ç»‘å®šä»¥æ›´å®‰å…¨çš„æ–¹å¼æ¥å®ç°ã€‚</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b58b" class="ka kb hi la b fi le lf l lg lh">guard let jsonData = JSON.data(JSON.data(using: .utf8)) else {<br/>    return nil<br/>}</span><span id="0891" class="ka kb hi la b fi li lf l lg lh">do {<br/>    let fact = try JSONDecoder().decode(CatFact.self, from: jsonData)<br/>    return fact<br/>}<br/>catch {<br/>    print(error.localizedDescription)<br/>    return nil<br/>}</span></pre><p id="f5c4" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">æ˜¯çš„ï¼Œä½†ä¸æ˜¯ï¼Œå› ä¸ºç°åœ¨åœ¨é¡¹ç›®ä¸­çš„æ¯ä¸ªè¯·æ±‚æˆ–æœåŠ¡ä¸­ç¼–å†™è¿™æ®µä»£ç å·²ç»å˜å¾—å¾ˆä¹å‘³äº†ã€‚ç„¶è€Œï¼Œè€ƒè™‘åˆ°æ‰€æœ‰ç¬¦åˆåè®®è§£ç çš„ç»“æ„å’Œç±»éƒ½å¯ä»¥è¢«é‡æ„ï¼Œè®©æˆ‘ä»¬æŠŠè¿™ä¸ªç‰‡æ®µç§»åˆ°åè®®æœ¬èº«çš„ä¸€ä¸ªé™æ€å‡½æ•°ä¸­ã€‚</p><h2 id="bb4d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">ä¸€ä¸ªå¯èƒ½çš„è§£å†³æ–¹æ¡ˆ</h2><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ca02" class="ka kb hi la b fi le lf l lg lh">extension Decodable {<br/>    static func parse(from data: Data?) -&gt; Self? {<br/>        // ...<br/>        return nil<br/>    }<br/>}</span><span id="6b42" class="ka kb hi la b fi li lf l lg lh">// We can now use it as follows<br/>let fact = CatFat.parse(from: JSON.data)<br/>print(fact)</span></pre><p id="161e" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">è¿™ä¼¼ä¹åªé€‚ç”¨äºæ•°æ®ï¼Œä¸ºäº†æ”¹è¿›è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ¥å—ä»»ä½•ç±»å‹æ¥å¢åŠ æ‰©å±•çš„çµæ´»æ€§ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»å‡ ä¹ä»»ä½• JSON å†…å®¹åˆ°æ‰€éœ€çš„å¯¹è±¡è§£æå®ƒã€‚è®©æˆ‘ä»¬çœ‹çœ‹<code class="du lj lk ll la b">data(from: Any?)</code>å‡½æ•°çš„å®ç°ï¼Œå®ƒå°†æ£€æŸ¥ä¸åŒç±»å‹çš„å†…å®¹ï¼Œå¹¶è¿”å›æ•°æ®ä¸­çš„å¯¹ç­‰å†…å®¹ã€‚</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="fd47" class="ka kb hi la b fi le lf l lg lh">extension Decodable {<br/>    static func parse(from item: Any?) -&gt; Self? {<br/>        // ...<br/>    }<br/>    <br/>    private static func data(from item: Any?) -&gt; Data? {<br/>        switch item {<br/>        case let data as Data:<br/>            return data<br/>        case let string as String:<br/>            return string.data(using: .utf8)<br/>        case let item?:<br/>            return try? JSONSerialization.data(withJSONObject: item, options: [])<br/>        default:<br/>            return nil<br/>        }<br/>    }<br/>}</span></pre><h2 id="64cd" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">æ”¹è¿›è§£å†³æ–¹æ¡ˆ</h2><p id="172f" class="pw-post-body-paragraph jc jd hi je b jf lm jh ji jj ln jl jm jn lo jp jq jr lp jt ju jv lq jx jy jz hb bi translated">åœ¨å°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€èµ·ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€ä»¶äº‹éœ€è¦è€ƒè™‘ï¼Œå¦‚æœ JSON çš„å†…å®¹ä¸­çš„é”®æ˜¯ç”¨ snake case è€Œä¸æ˜¯ iOS camel case çº¦å®šç¼–å†™çš„ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚è®©æˆ‘ä»¬åœ¨é»˜è®¤æƒ…å†µä¸‹ç”¨ camel case ä¸º parse å‡½æ•°æ·»åŠ ä¸€ä¸ªå°çš„<code class="du lj lk ll la b">KeyDecodingStrategy</code>å¯é€‰å‚æ•°ã€‚</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3dd1" class="ka kb hi la b fi le lf l lg lh">extension Decodable {<br/>    static func parse(from item: Any?, strategy: JSONDecoder.KeyDecodingStrategy = .useDefaultKeys) -&gt; Self? {<br/>        // 1. Sets the decoding strategy to the decoder<br/>        let decoder = JSONDecoder()<br/>        decoder.keyDecodingStrategy = strategy<br/>        <br/>        // ..<br/>    }<br/>    <br/>    private static func data(from item: Any?) -&gt; Data? {<br/>        // ...<br/>    }<br/>}</span></pre><h2 id="f827" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">æ•´ä¸ªæ‰©å±•</h2><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h2 id="a173" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jn kl km kn jr ko kp kq jv kr ks kt ku bi translated">ä¸€ä¸ªç®€å•çš„ä¾‹å­</h2><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><ol class=""><li id="9e65" class="lt lu hi je b jf jg jj jk jn lv jr lw jv lx jz ly lz ma mb bi translated">ç»“æ„çš„å®šä¹‰å’Œç¬¦åˆå¯è§£ç çš„åè®®ã€‚</li><li id="8528" class="lt lu hi je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb bi translated">å¯ä»¥æœ‰åµŒå¥—ç»“æ„ï¼Œåªè¦å®ƒä»¬ä¹Ÿæ˜¯å¯è§£ç çš„ã€‚</li><li id="586b" class="lt lu hi je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb bi translated">SwiftUI æ˜¯äºŒæ‰‹çš„ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯æˆ‘ä»¬å¾ˆå¥½çš„è€å¼ UIKitã€‚</li><li id="ac71" class="lt lu hi je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb bi translated">æ•°æ®æ¥è‡ªé™æ€å­—å…¸ï¼Œä½†ä¹Ÿå¯èƒ½æ¥è‡ªæ–‡ä»¶ã€åç«¯å“åº”æˆ–ä»»ä½•å…¶ä»– JSON ç±»å‹çš„å†…å®¹ã€‚</li><li id="63e9" class="lt lu hi je b jf mc jj md jn me jr mf jv mg jz ly lz ma mb bi translated">è¿™æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬æ¼‚äº®çš„æ‰©å±•ï¼Œå®ƒçœ‹èµ·æ¥å¹²å‡€æ˜“æ‡‚ã€‚å¯è§£ç çš„æ•°ç»„ä¹Ÿå¯ä»¥è§£æï¼Œåªæ˜¯å…è´¹çš„ğŸ˜‰</li></ol></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="6065" class="pw-post-body-paragraph jc jd hi je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><em class="mh">æ„Ÿè°¢é˜…è¯»ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™æ®µä»£ç ï¼Œå¦‚æœå®ƒå¯¹ä½ æœ‰ç”¨ï¼Œä¸è¦å®³ç¾ğŸ‘å…³äºè¿™ç¯‡æ–‡ç« ã€‚ä¸‹æ¬¡è§ã€‚</em></p></div></div>    
</body>
</html>