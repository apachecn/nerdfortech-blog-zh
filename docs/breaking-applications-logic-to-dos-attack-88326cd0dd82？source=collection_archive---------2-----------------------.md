# ç ´è§£åº”ç”¨ç¨‹åºé€»è¾‘åº”å¯¹ DOS æ”»å‡»

> åŸæ–‡ï¼š<https://medium.com/nerd-for-tech/breaking-applications-logic-to-dos-attack-88326cd0dd82?source=collection_archive---------2----------------------->

å˜¿ä¼™è®¡ä»¬ï¼Œ
æœ€è¿‘æˆ‘å‘ç°äº†ä¸€ä¸ªè¶³ä»¥é…å¾—ä¸Šè¿™ç¯‡æ–‡ç« çš„ bugã€‚æ‰€ä»¥ï¼Œæˆ‘æƒ³æŠŠå®ƒå†™åœ¨è¿™é‡Œã€‚å› ä¸ºä¿å¯†åè®®ï¼Œæˆ‘ä¸èƒ½é€éœ²å…¬å¸çš„åå­—(NDA)ã€‚æ‰€ä»¥æˆ‘å°†ä½¿ç”¨ redacted.com çš„*ä½œä¸ºè¿›ä¸€æ­¥çš„å‚è€ƒã€‚*

# *TLï¼›é€Ÿåº¦ä¸‰è§’å½¢å®šä½æ³•(dead reckoning)*

*æˆ‘åœ¨ POST è¯·æ±‚ä¸­å‘ç°ä¸€ä¸ªå‚æ•°ï¼Œå®¹æ˜“å—åˆ° ***IDOR*** çš„æ”»å‡»ã€‚è¿™ä¸ªå‚æ•°å®é™…ä¸Šæ˜¯ ***åºåˆ—*** ï¼Œè¿™ç»™äº†æˆ‘åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æˆ‘ä¸ºè¯¥ç‰¹å®šåº”ç”¨ç¨‹åºç¼–å†™çš„ python è„šæœ¬åˆ›å»º ***æ‹’ç»æœåŠ¡*** æ”»å‡»çš„ä¼˜åŠ¿ã€‚æ²¡æœ‰ WAF (Web åº”ç”¨ç¨‹åºé˜²ç«å¢™)èƒ½å¤Ÿæ£€æµ‹åˆ°è¿™ç§æ”»å‡»ï¼Œå› ä¸ºè¿™å®Œå…¨æ˜¯åº”ç”¨ç¨‹åºçš„é€»è¾‘è¡Œä¸º(æ‚¨å°†åœ¨åé¢çœ‹åˆ°)ã€‚*

## *å…ˆå†³æ¡ä»¶*

***DOS æ”»å‡»ä½ æ‡‚ä»€ä¹ˆï¼Ÿ** *åœ¨è®¡ç®—é¢†åŸŸï¼Œæ‹’ç»æœåŠ¡æ”»å‡»æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»ï¼Œæ”»å‡»è€…è¯•å›¾é€šè¿‡æš‚æ—¶æˆ–æ— é™æœŸä¸­æ–­è¿æ¥åˆ°äº’è”ç½‘çš„ä¸»æœºçš„æœåŠ¡ï¼Œä½¿å…¶ç›®æ ‡ç”¨æˆ·æ— æ³•ä½¿ç”¨æœºå™¨æˆ–ç½‘ç»œèµ„æºã€‚ã€æ¥è‡ª:* [*ç»´åŸº*](https://en.wikipedia.org/wiki/Denial-of-service_attack) *ã€‘ã€‚*
å¥½çš„ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿™æ˜¯ [**US-CERT**](https://us-cert.cisa.gov/ncas/tips/ST04-015) æ‰€è¯´çš„:
*æ‹’ç»æœåŠ¡æ¡ä»¶æ˜¯é€šè¿‡ç”¨æµé‡* ***æ·¹æ²¡ç›®æ ‡ä¸»æœºæˆ–ç½‘ç»œï¼Œç›´åˆ°ç›®æ ‡æ— æ³•å“åº”æˆ–å¹²è„†å´©æºƒ*** *ï¼Œé˜»æ­¢åˆæ³•ç”¨æˆ·çš„è®¿é—®æ¥å®ç°çš„ã€‚**

*è¿™æ˜¯æˆ‘æ‰€ç†è§£çš„ï¼Œâ€œ*å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿåœ¨æ”»å‡»ä¹‹å(æˆ–æœŸé—´)é˜»æ­¢ç”¨æˆ·ä½¿ç”¨åº”ç”¨ç¨‹åºå†…éƒ¨çš„ä»»ä½•åŠŸèƒ½æˆ–ç‰¹æ€§â€åº”è¯¥è¢«è§†ä¸ºæ‹’ç»æœåŠ¡æ”»å‡»*ã€‚*

## *è®©æˆ‘ä»¬ä»åˆå§‹ bug(IDOR)å¼€å§‹ï¼Œ*

*è¿™ä¸ªåº”ç”¨ç¨‹åºç±»ä¼¼äº [Wetransfer](https://wetransfer.com) ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æä¾›ä¸€äº›ç»†èŠ‚ï¼Œå¦‚æ¥æ”¶è€…çš„ç”µå­é‚®ä»¶ã€å‘é€è€…çš„ç”µå­é‚®ä»¶ã€æ‰‹æœºå·ç (åº”è¯¥éªŒè¯)å’Œæ–‡ä»¶(å½“ç„¶)ï¼Œå°†æ–‡ä»¶å‘é€ç»™å¦ä¸€ä¸ªç”¨æˆ·ã€‚*

*![](img/5c9f6c300028a3cb53e827b5853d9eef.png)*

*çœ‹èµ·æ¥æ€ä¹ˆæ ·*

*å½“ä½ ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œä½œä¸ºå›åº”ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ id çš„ä¸Šä¼ æ–‡ä»¶ã€‚ä½ ä¹Ÿå¯ä»¥ä» ***æ£€æŸ¥å™¨*** ä¸­çœ‹åˆ° ***file_id*** ä¹Ÿå¯ä»¥ã€‚*

*![](img/64205835fe0fa732e493ed6b83099906.png)*

*ä¸Šä¼ æ–‡ä»¶>è·å–æ–‡ä»¶æ ‡è¯†ã€‚*

*å¦‚æœä½ ä¸Šä¼ äº†ä¸€ä¸ªé”™è¯¯çš„æ–‡ä»¶ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä»æœåŠ¡å™¨ä¸Šåˆ é™¤è¿™ä¸ªæ–‡ä»¶ã€‚ç°åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œ ***file_id*** æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„ï¼Œå½“æˆ‘ä»¬å°è¯•åˆ é™¤æ–‡ä»¶æ—¶ï¼Œ ***POST*** è¯·æ±‚æ˜¯ç”¨è¯·æ±‚ä½“ä¸­çš„ ***file_id*** å‚æ•°ç”Ÿæˆçš„ã€‚ä¸‹é¢æ˜¯åˆ é™¤æ–‡ä»¶çš„è¯·æ±‚:*

*![](img/aff4968060b9742f3c76cc0f819194c4.png)*

*å¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™æ˜¾ç¤º**æˆåŠŸ**ï¼Œå¦åˆ™**å¤±è´¥**ã€‚*

*ç°åœ¨ä½ ä»¬ä¸­çš„è®¸å¤šäººå·²ç»æ„è¯†åˆ°å¯èƒ½å­˜åœ¨ IDOR(ä¸å®‰å…¨çš„ç›´æ¥å¯¹è±¡å¼•ç”¨)ã€‚æ‰€ä»¥ï¼Œæ˜¯çš„ï¼Œä½ å¯ä»¥åˆ é™¤æ–‡ä»¶ï¼Œå› ä¸ºæ²¡æœ‰è®¿é—®æ§åˆ¶åˆ é™¤æ–‡ä»¶ã€‚
å¥½çš„ï¼Œæ‰€ä»¥ä»»ä½•äººåªè¦çŸ¥é“ä½ çš„ ***file_id*** å°±å¯ä»¥åˆ é™¤ä½ çš„æ–‡ä»¶ã€‚å°½ç®¡ ***file_id*** æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç®€å•åœ°ç”¨ ***è›®åŠ›*** ä¸€ä¸‹ã€‚å½“ file_id è¢«åˆ é™¤æ—¶ï¼Œç”¨æˆ·ç®€å•åœ°å¾—åˆ°ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯ï¼Œè¯´ ***â€œå‡ºé”™äº†ï¼Œè¯·å†è¯•ä¸€æ¬¡â€ã€‚****

*![](img/96430b86b9d651ed36bdee27c0a19f9c.png)*

*å‡ºé”™ä¿¡æ¯*

*é‚£ä¹ˆæ¥ä¸‹æ¥å¯ä»¥åšä»€ä¹ˆæ¥å¢åŠ è¿™ä¸ª bug çš„ä¸¥é‡æ€§å‘¢ï¼Ÿæ€è€ƒä¸€åˆ†é’Ÿï¼Œç„¶åç»§ç»­å¾€ä¸‹è¯»ã€‚*

# ***IDOR - > DOS***

*åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª IDOR(ä¸¥é‡æ€§:é«˜)ï¼Œç°åœ¨æˆ‘å°†å‘æ‚¨å±•ç¤ºï¼Œæˆ‘å¦‚ä½•é€šè¿‡ç¼–å†™ä¸€ä¸ªç®€å•çš„ python è„šæœ¬å°†å®ƒæé«˜åˆ°ä¸´ç•Œ(DOS æ”»å‡»)ã€‚*

*æˆ‘å†™äº†ä¸€ä¸ªè„šæœ¬ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€ä¸ª ***èŒƒå›´*** ï¼Œå®ƒå‘é€ POST è¯·æ±‚æ¥åˆ é™¤è¯¥èŒƒå›´å†…çš„ç‰¹å®š file_idã€‚å¹¶ä¸”ä¸€æ—¦è„šæœ¬å‘ç°ä»»ä½• ***file_id*** è¢«æˆåŠŸç§»é™¤ï¼Œåˆ™èŒƒå›´è‡ªåŠ¨è°ƒæ•´è‡ªèº«(å³å¢åŠ å®ƒçš„èŒƒå›´)ã€‚å…ˆçœ‹å‰§æœ¬:*

*python3 dos_poc.py*

## ***è¿™ä¸ªè„šæœ¬æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ***

*é¦–å…ˆï¼Œä½ å¿…é¡»åœ¨ç½‘ç«™ä¸Šä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶è·å¾—å½“å‰çš„æ–‡ä»¶æ ‡è¯†(ç”±æ£€æŸ¥å‘˜)ã€‚
**1ã€‚**ç°åœ¨é€šè¿‡å°† file_id å€¼ä½œä¸ºå‚æ•°ä¼ é€’æ¥è¿è¡Œè„šæœ¬ã€‚ä¾‹å¦‚:
(python3 dos_poc.py 310)ã€‚
**2ã€‚è¯¥è„šæœ¬å°†åˆ›å»ºä¸€ä¸ªä» 310 åˆ° 330 çš„èŒƒå›´ã€‚
**3ã€‚å®ƒå°†å‘é€ä¸€ä¸ª Post è¯·æ±‚æ¥åˆ é™¤èŒƒå›´åœ¨ 310 åˆ° 330 ä¹‹é—´çš„æ–‡ä»¶æ ‡è¯†ã€‚
**4ã€‚å¦‚æœè„šæœ¬æ‰¾åˆ°äº†å“åº”ä»»ä½•è¯·æ±‚çš„æˆåŠŸæ¶ˆæ¯ï¼Œé‚£ä¹ˆå®ƒå°†è‡ªåŠ¨å¢åŠ å®ƒçš„èŒƒå›´ã€‚ä¾‹:å¦‚æœå‘ç° 310 æˆåŠŸ(å“åº”)ï¼Œé‚£ä¹ˆæ–°èŒƒå›´å°†æ˜¯ 311 åˆ° 331ã€‚æ”»å‡»ä»åœ¨ç»§ç»­..*******

*![](img/51f07341fd2d9376f6c3927225b535ad.png)*

# ***å½±å“***

*å› æ­¤ï¼Œå½“æˆ‘è¿è¡Œæˆ‘çš„è„šæœ¬æ—¶ï¼Œä»»ä½•è¯•å›¾é€šè¿‡è¯¥ç½‘ç«™å…±äº«æ–‡ä»¶çš„äººéƒ½ä¼šå—åˆ°å½±å“ï¼Œä»–ä»¬çš„æ–‡ä»¶ä¼šè¢«è‡ªåŠ¨ä»æœåŠ¡å™¨ä¸Šåˆ é™¤ï¼Œå¹¶æ˜¾ç¤ºä¸€æ¡é”™è¯¯æ¶ˆæ¯ ***â€œå‡ºé”™ï¼Œè¯·ç¨åå†è¯•ã€‚â€ã€‚****

*å› æ­¤ï¼Œæˆ‘ç”¨ IDOR æ¼æ´é“¾æ¥ï¼Œä½¿è¯¥ç½‘ç«™å®¹æ˜“å—åˆ°æ‹’ç»æœåŠ¡æ”»å‡»ã€‚è¿™ç§ DOS æ”»å‡»æ˜¯å®Œå…¨åˆä¹é€»è¾‘ï¼Œå› ä¸ºå®ƒçš„è¡Œä¸ºæ²¡æœ‰æ¶æ„ï¼Œæ‰€ä»¥æ²¡æœ‰ WAF èƒ½å¤Ÿæ£€æµ‹åˆ°è¿™ç§æ”»å‡»ã€‚*

# *å¤–å–:*

*>æˆ‘ä»¬åº”è¯¥å§‹ç»ˆè€ƒè™‘å°†æ¼æ´é“¾æ¥èµ·æ¥ä»¥å¢åŠ ä¸¥é‡æ€§(å¯»æ‰¾æœ€é«˜çš„)ã€‚
>å¦‚æœæŠŠè®¿é—®æ§åˆ¶çš„ bug å’Œå…¶ä»–ä¸€äº› bug é“¾æ¥èµ·æ¥ï¼Œå°±å˜å¾—æ›´æœ‰æ„æ€äº†ã€‚æƒ³æƒ³å§ã€‚
>åœ¨ Twitter ä¸Šå…³æ³¨æˆ‘äº†è§£æ›´å¤šä¿¡æ¯ã€‚ğŸ˜‰*

*å¯¹äºä»»ä½•æŸ¥è¯¢ï¼ŒDMs éƒ½æ˜¯å¼€æ”¾çš„:*

*æ¨ç‰¹:[https://twitter.com/abhiunix](https://twitter.com/abhiunix)
é¢†è‹±:[https://linkedin.com/in/abhiunix](https://linkedin.com/in/abhiunix)
è°¢è°¢ï¼ï¼*