<html>
<head>
<title>Accessing S3 and Redshift via API Gateway (using AWS Lambda)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é€šè¿‡APIç½‘å…³è®¿é—®S3å’Œçº¢ç§»(ä½¿ç”¨AWS Lambda)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/accessing-s3-and-redshift-via-api-gateway-using-aws-lambda-aad4d1915587?source=collection_archive---------0-----------------------#2020-07-18">https://medium.com/nerd-for-tech/accessing-s3-and-redshift-via-api-gateway-using-aws-lambda-aad4d1915587?source=collection_archive---------0-----------------------#2020-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="da79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä»Šå¤©æˆ‘è¦è®²çš„æ˜¯å¦‚ä½•ä»ä½ çš„ç½‘ç«™è·å–æ•°æ®ï¼Œå¹¶ä½¿ç”¨AWSæ— æœåŠ¡å™¨æ¶æ„å°†å…¶å­˜å‚¨åœ¨redshiftä¸­ã€‚è¿™å¯èƒ½æ˜¯å¼€å§‹å¤„ç†æ•°æ®å’Œå¿«é€Ÿæ„å»ºåç«¯çš„æœ€ç®€å•ã€æœ€å¿«çš„æ–¹æ³•ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/d3dadc736229cada0156ce92f8a928d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*GO6Om2O9UO2RLURZkRkdQg.png"/></div></figure><p id="37c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬ä»æ„å»ºä¸€ä¸ªç®€å•çš„GET restpointå¼€å§‹ã€‚</p><ol class=""><li id="f11d" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">æ‰“å¼€AWSæ§åˆ¶å°å¹¶è½¬åˆ°APIç½‘å…³ã€‚</li><li id="20e1" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">é€‰æ‹©HTTP APIï¼Œç„¶åé€‰æ‹©BUILDã€‚HTTP apiæ”¯æŒlambdaï¼Œå¹¶æä¾›ç°æˆçš„CORSæ”¯æŒã€‚</li><li id="8f2a" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">ç°åœ¨ç»™ä½ çš„apiå‘½åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹äº†ã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å°†å‘½åä¸ºâ€œæµ‹è¯•â€ã€‚</li><li id="de30" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">å®ƒå°†ä¸ºæ‚¨æä¾›ä¸€ä¸ªè‡ªåŠ¨éƒ¨ç½²è·¯å¾„çš„é€‰é¡¹ï¼Œè‡ªåŠ¨éƒ¨ç½²æ‚¨çš„æ‰€æœ‰æ›´æ”¹ã€‚æ‚¨å¯ä»¥ç»™å®ƒèµ·è‡ªå·±çš„åå­—ï¼Œæˆ–è€…ä¿ç•™$defaultã€‚</li><li id="0cfc" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">ç°åœ¨åªéœ€å•å‡»createï¼Œå°±ä¼šä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªapiã€‚</li></ol><p id="bc6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºlambdaå‡½æ•°ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒä¸æˆ‘ä»¬çš„apiç½‘å…³é›†æˆåœ¨ä¸€èµ·ã€‚</p><ol class=""><li id="2c5d" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">ä»å¤´å¼€å§‹åˆ›å»ºå‡½æ•°ã€‚</li><li id="48c6" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">æˆ‘é€‰æ‹©äº†pythonä½œä¸ºè¯­è¨€ï¼Œä½†æ˜¯ä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä½ å–œæ¬¢çš„è¯­è¨€ã€‚</li><li id="36fc" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">åˆ›å»ºä¸€ä¸ªIAMè§’è‰²ï¼Œå¹¶æˆäºˆå¯¹API Gatewayã€S3ã€Redshiftå’ŒCloudwatchçš„è¯»å†™æƒé™ã€‚</li><li id="eaa2" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">Lambdaä¼šè‡ªåŠ¨ä¸ºä½ åˆ›å»ºä¸€ä¸ªæ—¥å¿—ç»„ï¼Œå¹¶å°†æ‰€æœ‰æ—¥å¿—ä¸Šä¼ åˆ°cloudwatchã€‚</li></ol><p id="b6b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬åœ¨apiä¸­åˆ›å»ºä¸€æ¡è·¯çº¿ã€‚</p><ol class=""><li id="4d6e" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">å•å‡»å·¦ä¾§çª—æ ¼ä¸­çš„è·¯çº¿ã€‚</li><li id="497c" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">å•å‡»åˆ›å»ºå¹¶é€‰æ‹©â€œè·å–â€apiã€‚</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es jz"><img src="../Images/b2d2a2102e132e1f8c6c0907ba285eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZLum8QFtba8b2nQhWOj-g.png"/></div></div></figure><p id="cbd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªç«¯ç‚¹ï¼Œè®©æˆ‘ä»¬å°†å®ƒä¸æˆ‘ä»¬çš„åç«¯(lambda)é›†æˆèµ·æ¥ã€‚</p><p id="f586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.ç°åœ¨è½¬åˆ°æ‚¨çš„è·¯çº¿å¹¶ç‚¹å‡»â€œè·å–â€ã€‚</p><p id="34e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.ç‚¹å‡»â€œé™„åŠ é›†æˆâ€ï¼Œé€‰æ‹©lambdaå‡½æ•°ï¼Œå¹¶å°†æ‚¨çš„Lambdaå‡½æ•°çš„arnå¤åˆ¶åˆ°æ­¤å¤„ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ke"><img src="../Images/cd4af2a3fa59fcee899ea887b40c390a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpWaevusjlONK7VOLlqPNQ.png"/></div></div></figure><p id="0725" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.å•å‡»â€”æˆäºˆAPIç½‘å…³è°ƒç”¨lambdaçš„æƒé™ã€‚</p><p id="406b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AAANNNDDDï¼ï¼ï¼..ä½ å¯ä»¥èµ°äº†ã€‚</p><p id="f22a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.é»˜è®¤æƒ…å†µä¸‹ï¼Œlambdaè¿”å›â€œä½ å¥½ï¼" .ç°åœ¨è®©æˆ‘ä»¬æŠŠä»£ç æ”¹ä¸ºâ€œæµ‹è¯•æµ‹è¯•1 2 3â€å¹¶ä¿å­˜å®ƒã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kf"><img src="../Images/14ccb01b43966a8cce464bafac722588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h58ZBSNGT8XQoPKbXZPV8g.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">ä½ çš„lambdaå‡½æ•°åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚</figcaption></figure><p id="ff7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨çš„apiåº”è¯¥è‡ªåŠ¨éƒ¨ç½²åˆ°é»˜è®¤é˜¶æ®µã€‚</p><p id="deb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.ç°åœ¨è®©æˆ‘ä»¬é…ç½®CORSï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»ä»»ä½•webæµè§ˆå™¨è®¿é—®æˆ‘ä»¬çš„APIã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kk"><img src="../Images/7d9f1fa71f228ff9df504ef6901ce8c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdwo1DkW-m_bIdPBVn5Rfg.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">å®Œæˆåï¼Œæ‚¨çš„CORSé…ç½®åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºã€‚æˆ‘ä»¬ç°åœ¨å°†å…è®¸æ‰€æœ‰çš„å¤´å‘½ä¸­æˆ‘ä»¬çš„APIã€‚</figcaption></figure><p id="4373" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»é…ç½®å¥½äº†ä¸€åˆ‡ï¼Œè®©æˆ‘ä»¬è¯•ç€ç‚¹å‡»APIã€‚</p><p id="e0ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å°†åœ¨å·¦ä¾§é¢æ¿ä¸­æ‰¾åˆ°æ‚¨çš„é˜¶æ®µçš„urlã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kl"><img src="../Images/f2be478cb99bf275574b596f3e2a93a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srpP045ga7zvnyVATVV5fw.png"/></div></div></figure><p id="e9f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬è½¬åˆ°è¿™ä¸ªç½‘å€ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„â€œæµ‹è¯•â€æ¶ˆæ¯ğŸ¥³ğŸ¥³ğŸ¥³ğŸ¥³.</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es km"><img src="../Images/fb2e86d1856e2eb4cb8219a9d48f1fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JqpoBEZuGLGKAbdxK_IkcA.png"/></div></div></figure><p id="3452" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬å·²ç»å»ºç«‹äº†lambdaå’Œapigatewayä¹‹é—´çš„è¿æ¥ï¼Œè®©æˆ‘ä»¬å¼€å§‹å°†æ•°æ®ä¿å­˜åœ¨S3å’Œçº¢ç§»ä¸­ã€‚</p><p id="9570" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åˆ›å»ºä¸€ä¸ªâ€œPOSTâ€è·¯ç”±ï¼Œç±»ä¼¼äºæˆ‘ä»¬åˆ›å»ºâ€œGETâ€çš„æ–¹å¼ï¼Œå¹¶å°†å…¶ä¸ç›¸åŒçš„lambdaé›†æˆã€‚</p><p id="34de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬ä¹Ÿåˆ›å»ºä¸€ä¸ªS3æ¡¶å’Œçº¢ç§»è¡¨æ¥å­˜å‚¨æˆ‘ä»¬çš„æ•°æ®ã€‚</p><p id="978a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">S3Â·å·´ç‰¹â€”</p><ol class=""><li id="033f" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">åªè¦ç»™ä½ çš„æ¡¶èµ·ä¸€ä¸ªç‹¬ç‰¹çš„åå­—ï¼Œä½ å°±å¯ä»¥å¼€å§‹äº†ã€‚ä½ ä¸éœ€è¦æ›´å¤šçš„é…ç½®ã€‚æˆ‘æŠŠæˆ‘çš„æ¡¶å‘½åä¸ºâ€œæµ‹è¯•-ä¸­ç­‰-å®‰åŸºå¡”â€ã€‚</li><li id="b049" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">ç°åœ¨ï¼Œåœ¨æ‚¨çš„lambdaä¸­ï¼Œæ·»åŠ è¿™ä¸ªS3æ¡¶ä½œä¸ºè§¦å‘å™¨ï¼Œè¿™æ ·æ¯å½“æœ‰ä»»ä½•æ•°æ®æ·»åŠ åˆ°æ¡¶ä¸­æ—¶ï¼Œå®ƒéƒ½ä¼šæµå‘çº¢ç§»ã€‚</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kn"><img src="../Images/f7d882ce41a9e299e3f94764be281b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iaGEE0nANDluxAtAsv5APA.png"/></div></div></figure><p id="1cdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">çº¢ç§»è¡¨</p><ol class=""><li id="0abc" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">è®©æˆ‘ä»¬çš„æ¨¡å¼ã€‚â€”å­—ç¬¦ä¸²åç§°ã€å­—ç¬¦ä¸²å¹´é¾„ã€å­—ç¬¦ä¸²æ”¶è—_å¡é€š</li><li id="c319" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">ç°åœ¨ä»AWSæ§åˆ¶å°æ‰“å¼€Redshiftï¼Œè®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„è¡¨ã€‚(æˆ‘å‡è®¾ä½ å·²ç»æœ‰çº¢ç§»è®¾ç½®ã€‚å¦‚æœæ²¡æœ‰ï¼Œä½ å¯ä»¥æŒ‰ç…§è¿™ä¸ª<a class="ae ko" href="https://docs.aws.amazon.com/redshift/latest/gsg/getting-started.html" rel="noopener ugc nofollow" target="_blank">æ•™ç¨‹</a>ã€‚</li><li id="c0ba" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªè¡¨ã€‚</li></ol><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="541f" class="ku kv hi kq b fi kw kx l ky kz">Create table public.medium (<br/>name VARCHAR(max),<br/>age VARCHAR(max),<br/>fav_cartoon VARCHAR(max)<br/>)</span></pre><p id="1024" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.å½“ä½ è¿™ä¹ˆåšçš„æ—¶å€™â€”</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="5584" class="ku kv hi kq b fi kw kx l ky kz">select * from public.medium; </span></pre><p id="01f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ åº”è¯¥çœ‹çœ‹ä½ çš„æ¡Œå­ã€‚å¯¹äºæˆ‘çš„æ•™ç¨‹ï¼Œæ¯å½“æ•°æ®è¢«æ’å…¥åˆ°S3æ¡¶â€”â€”â€œtest-medium-ankitaâ€æ—¶ï¼Œå®ƒåº”è¯¥ä¼šè‡ªåŠ¨å¡«å……æ‚¨çš„çº¢ç§»è¡¨ã€‚</p><p id="a200" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸€æ—¦æˆ‘ä»¬å‡†å¤‡å¥½æ‰€æœ‰çš„é…ç½®ï¼Œè®©æˆ‘ä»¬å¼€å§‹åˆ›å»ºæˆ‘ä»¬çš„lambdaå‡½æ•°ã€‚</p><p id="675b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å°†éœ€è¦ä»¥ä¸‹è½¯ä»¶åŒ…:</p><ol class=""><li id="df66" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">å¿ƒç†æˆ˜2</li><li id="5bef" class="jl jm hi ih b ii ju im jv iq jw iu jx iy jy jc jq jr js jt bi translated">boto3</li></ol><p id="399d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å°†éœ€è¦åœ¨æœ¬åœ°æœºå™¨ä¸Šé…ç½®AWS(ä¸ºæ­¤åˆ›å»ºä¸€ä¸ªæ‹¥æœ‰å‰é¢æåˆ°çš„æ‰€æœ‰å¿…éœ€æƒé™çš„ç”¨æˆ·)ã€‚</p><ol class=""><li id="5546" class="jl jm hi ih b ii ij im in iq jn iu jo iy jp jc jq jr js jt bi translated">ç°åœ¨åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿenvã€‚(æˆ‘ä»¬å°†éœ€è¦è¿™ä¸ªæŠŠæˆ‘ä»¬çš„ä»£ç ä½œä¸ºzipæ–‡ä»¶ä¸Šä¼ åˆ°lambdaã€‚ä¹Ÿå¯ä»¥è·Ÿç€è¿™ä¸ª<a class="ae ko" rel="noopener" href="/@manivannan_data/import-custom-python-packages-on-aws-lambda-function-5fbac36b40f8">æ•™ç¨‹</a>ã€‚</li></ol><p id="20e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä»£ç :</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="0460" class="ku kv hi kq b fi kw kx l ky kz">import json<br/>import psycopg2<br/>import boto3</span><span id="d881" class="ku kv hi kq b fi la kx l ky kz">def redshiftputdata(loc):<br/>    con = psycopg2.connect(dbname='***',<br/>                       host='***',<br/>                       port='***', user='***', password='***')<br/>    cur = conn.cursor()<br/>    # Begin your transaction<br/>    cur.execute("begin;")<br/>    cur.execute(<br/>        "COPY public.executed_user_rules FROM" + loc + "CREDENTIALS 'aws_iam_role=arn:aws:iam::***' json 'auto';")<br/>    # Commit your transaction<br/>    cur.execute("commit;")<br/>    print("executed user rules copy executed fine!")</span><span id="30fe" class="ku kv hi kq b fi la kx l ky kz">def put_data_into_s3(data, bucket):<br/>    putbucket = bucket<br/>    key = "medium"<br/>    client = boto3.client('s3')<br/>    client.put_object(Body=data, Bucket=putbucket, Key=key)<br/>    return data</span><span id="a981" class="ku kv hi kq b fi la kx l ky kz">def lambda_handler(event, context):<br/>    print(event)<br/>    # For api gateway post.<br/>    response = "default"<br/>    if ("rawPath" in event and event.get("rawPath") == "/postnames"):<br/>        body = event.get("body")<br/>        dict = json.loads(body)<br/>        dict = json.dumps(dict)<br/>        print(dict)<br/>        response = put_data_into_s3(dict, "test-medium-ankita")<br/>    <br/>    # handle data coming from s3.<br/>    if("Records" in event):<br/>        records = event["Records"]<br/>        for record in records:<br/>            s3_name = record["s3"]["bucket"]["name"]<br/>            key = record["s3"]["object"]["key"]<br/>            output = ""<br/>            if (s3_name == "test-medium-ankita" and key.find(".json") != -1):<br/>                loc = "'s3://test-medium-ankita/%s'" % (key)<br/>                output = redshiftputdata(loc)<br/>                print("output: ", output)<br/>    # TODO implement<br/>    return {<br/>        'statusCode': 200,<br/>        'body': json.dumps(response)<br/>    }</span></pre><p id="5f23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å‡½æ•°â€œredshiftputdataâ€ç”¨äºå°†ä»S3æ”¶åˆ°çš„jsonæ–‡ä»¶å¤åˆ¶åˆ°æˆ‘ä»¬çš„çº¢ç§»è¡¨ä¸­ã€‚å‡½æ•°â€œput_data_into_s3â€ç”¨äºå°†æ‚¨çš„æ•°æ®ä»¥jsonæ ¼å¼æ”¾å…¥s3ã€‚</p><p id="3502" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬è¿›è¡Œpostè°ƒç”¨ï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥ç›´æ¥çœ‹åˆ°å¡«å……åœ¨çº¢ç§»è¡¨ä¸­çš„æ•°æ®:</p><p id="8007" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å·å¬æ­£æ–‡:</p><pre class="je jf jg jh fd kp kq kr ks aw kt bi"><span id="42b3" class="ku kv hi kq b fi kw kx l ky kz">{"name":"Ankita Sinha","age": "15","fav_cartoon": "tom and jerry"}</span></pre><p id="8e3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹è¡¨æ ¼ä¸­çš„æ•°æ®â€”</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lb"><img src="../Images/969790c559ded65e810857e1500fe5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBwNoG42RtbQo2sNhQ7gew.png"/></div></div></figure><p id="28f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦å¤–ï¼Œä½ å¯ä»¥ä»è¿™é‡Œè·å¾—lambdaå¯æ‰§è¡Œæ–‡ä»¶psycopg 2â€”ã€https://github.com/jkehler/awslambda-psycopg2ã€‘T4ã€‚ä½ åªéœ€è¦æŠŠè¿™ä¸ªæ–‡ä»¶æ”¾åˆ°ä½ çš„ä»£ç ä¸­ï¼Œç„¶åå‹ç¼©å®ƒã€‚</p></div></div>    
</body>
</html>