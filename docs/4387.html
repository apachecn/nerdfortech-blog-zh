<html>
<head>
<title>Stacked Package â€” Service Location, Routing &amp; Logging</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å †å åŒ…è£…â€”æœåŠ¡ä½ç½®ã€è·¯çº¿å’Œè®°å½•</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/stacked-package-service-location-routing-logging-b8bdc1e6c839?source=collection_archive---------5-----------------------#2021-07-19">https://medium.com/nerd-for-tech/stacked-package-service-location-routing-logging-b8bdc1e6c839?source=collection_archive---------5-----------------------#2021-07-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c4c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¤§å®¶å¥½ï¼Œæˆ‘å·²ç»å†™äº†ä¸€ç¯‡æ–‡ç« ï¼Œå…³äºæˆ‘ä»¬å¦‚ä½•ç”¨å †å åŒ…è½»æ¾å¤„ç†åŠ è½½çŠ¶æ€å’Œé”™è¯¯ã€‚</p><p id="a567" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å †å åŒ…æä¾›çš„å„ç§æœåŠ¡ã€‚</em></p><p id="2283" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å †å åŒ…æä¾›å„ç§åŠŸèƒ½ï¼Œå¦‚<strong class="ih hj">æœåŠ¡å®šä½ã€è·¯ç”±ã€è®°å½•</strong>ç­‰ã€‚å®ƒé€šè¿‡ä»£ç ç”Ÿæˆä½¿å®ƒä»¬å˜å¾—éå¸¸ç®€å•ï¼Œä½ éœ€è¦åšçš„åªæ˜¯ç”¨<code class="du je jf jg jh b">@StackedApp </code>æ³¨é‡Šä¸€ä¸ªç±»å¹¶æŒ‡å®šä½ æƒ³è¦çš„æœåŠ¡ã€‚</p><p id="ced7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–å…ˆï¼Œåœ¨æ‚¨çš„<code class="du je jf jg jh b">pubspec.yaml</code>ä¸­å£°æ˜ä¾èµ–é¡¹ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="1d84" class="jq jr hi jh b fi js jt l ju jv">dependencies:<br/>  <strong class="jh hj">stacked: ^2.2.2</strong><br/>  <strong class="jh hj">stacked_services: ^0.8.10</strong></span><span id="1322" class="jq jr hi jh b fi jw jt l ju jv">dev_dependencies:<br/>  <strong class="jh hj">build_runner: <br/>  stacked_generator:</strong></span></pre><h1 id="dc3a" class="jx jr hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">æŒ‰æŒ‡å®šè·¯çº¿å‘é€</h1><figure class="ji jj jk jl fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ku"><img src="../Images/4ba2ac2b77bda0055ded5cf722c69f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kO4V3dXa78gTPsqe6w_FYQ.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">ä½•å¡Â·é©¬ä¸Â·æ‹‰ç±³é›·æ–¯Â·å¡æ‹‰æ–¯ç§‘åœ¨<a class="ae lg" href="https://unsplash.com/s/photos/route?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h2 id="b046" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated"><strong class="ak">è®¾ç½®</strong></h2><ol class=""><li id="0261" class="lu lv hi ih b ii lw im lx iq ly iu lz iy ma jc mb mc md me bi translated"><strong class="ih hj">ç”¨@StackedApp </strong>æ³¨é‡Šä¸€ä¸ªç±»</li></ol><p id="c01c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåå­—ç”±ä½ é€‰æ‹©ğŸ™ƒï¼Œæˆ‘æŠŠå®ƒå‘½åä¸º<code class="du je jf jg jh b">app.dart</code></p><p id="4354" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åï¼Œè®©æˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæŒ‡å®šä¸€äº›<strong class="ih hj">è·¯çº¿</strong>ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="5c64" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">@StackedApp(<br/>  routes:[<br/>    </strong>MaterialRoute(page: HomePage,initial: true),<br/>    MaterialRoute(page: LoginPage),<strong class="jh hj"><br/>  ]<br/>)</strong><br/>class <strong class="jh hj">App</strong>{<br/>   //empty class, will be filled after code generation<br/>}</span></pre><ul class=""><li id="e687" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated">æˆ‘ä»¬åˆšåˆšå®£å¸ƒäº†ä¸¤æ¡è·¯çº¿ï¼Œå¹¶å°†æˆ‘ä»¬çš„ä¸»é¡µè®¾ç½®ä¸ºæˆ‘ä»¬çš„åˆå§‹è·¯çº¿ã€‚</li><li id="17a5" class="lu lv hi ih b ii mj im mk iq ml iu mm iy mn jc mi mc md me bi translated">è¿™ä¹Ÿæ”¯æŒåµŒå¥—è·¯ç”±(<a class="ae lg" href="https://pub.dev/packages/stacked" rel="noopener ugc nofollow" target="_blank"> docs </a>)</li></ul><p id="9f3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2ã€‚è¿è¡Œä»£ç ç”Ÿæˆå™¨å‘½ä»¤</strong></p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="498f" class="jq jr hi jh b fi js jt l ju jv">flutter pub<em class="jd"> </em>run<em class="jd"> build_runner build --delete-conflicting-outputs</em></span></pre><p id="2e51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™å°†äº§ç”Ÿ</p><blockquote class="mo mp mq"><p id="d29f" class="if ig jd ih b ii ij ik il im in io ip mr ir is it ms iv iw ix mt iz ja jb jc hb bi translated"><code class="du je jf jg jh b"><em class="hi">app.router.dart</em></code>:ç”±<strong class="ih hj">è·¯çº¿</strong>å‚æ•°è‡ªåŠ¨ç”Ÿæˆã€‚</p><p id="fc0d" class="if ig jd ih b ii ij ik il im in io ip mr ir is it ms iv iw ix mt iz ja jb jc hb bi translated"><code class="du je jf jg jh b"><em class="hi">app.locator.dart</em></code>:ç”±<strong class="ih hj">ä¾èµ–å…³ç³»</strong>å‚æ•°è‡ªåŠ¨ç”Ÿæˆã€‚</p><p id="23f2" class="if ig jd ih b ii ij ik il im in io ip mr ir is it ms iv iw ix mt iz ja jb jc hb bi translated"><code class="du je jf jg jh b"><em class="hi">app.logger.dart</em></code>:ç”±<strong class="ih hj">è®°å½•å™¨</strong>å‚æ•°è‡ªåŠ¨ç”Ÿæˆã€‚</p></blockquote><blockquote class="mu"><p id="b188" class="mv mw hi bd mx my mz na nb nc nd jc dx translated">æ¯æ¬¡å¯¹@StackedApp è¿›è¡Œä¸€äº›æ›´æ”¹æ—¶ï¼Œéƒ½å¿…é¡»è¿è¡Œè¿™ä¸ªå‘½ä»¤</p></blockquote><p id="37d5" class="pw-post-body-paragraph if ig hi ih b ii ne ik il im nf io ip iq ng is it iu nh iw ix iy ni ja jb jc hb bi translated"><strong class="ih hj"> 3ã€‚åœ¨æ‚¨çš„ MaterialApp </strong>ä¸­æŒ‡å®š onGenerateRouteï¼ŒnavigatorKey</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="0086" class="jq jr hi jh b fi js jt l ju jv">class MyApp extends StatelessWidget {<br/>  @override<br/>  Widget build(BuildContext context) {<br/>    return MaterialApp(<br/>        title: 'My APP',<br/>        <strong class="jh hj">navigatorKey: StackedService.<em class="jd">navigatorKey</em>,<br/>        onGenerateRoute: StackedRouter().onGenerateRoute</strong>,<br/>    );<br/>  }<br/>}</span></pre><ul class=""><li id="5b2c" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated">Navigator é”®éå¸¸é‡è¦ï¼Œå®ƒä½¿æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸æ˜ç¡®ä½¿ç”¨ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹æµè§ˆé¡µé¢ã€‚</li><li id="6ddb" class="lu lv hi ih b ii mj im mk iq ml iu mm iy mn jc mi mc md me bi translated">StackedApp ä½¿ç”¨ auto_route ç”Ÿæˆ<code class="du je jf jg jh b">app.router.dart </code>æ–‡ä»¶ã€‚æœ€æ£’çš„æ˜¯ï¼Œå®ƒä¸ºæ¯æ¡è·¯ç”±åˆ›å»ºäº†ä¸€ä¸ªè·¯ç”±å™¨å‚æ•°ç±»(åœ¨æ„é€ å‡½æ•°ä¸­æœ‰ç›¸åŒçš„å‚æ•°)ï¼Œæ‚¨å¯ä»¥åœ¨å¯¼èˆªåˆ°ç›®æ ‡ç±»æ—¶ä½¿ç”¨å®ƒã€‚</li></ul><p id="d9eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å‡è®¾æˆ‘ä»¬çš„ LoginPage å¦‚ä¸‹æ‰€ç¤ºï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="dd6b" class="jq jr hi jh b fi js jt l ju jv">class LoginPage extends StatelessWidget {<br/>  <strong class="jh hj">String id;<br/>  LoginPage(this.id);</strong><br/>  //...<br/>}</span></pre><p id="9487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">app.router.dart</code>æœ‰ä¸€ä¸ª<code class="du je jf jg jh b"><strong class="ih hj">LoginArguments </strong></code>ç±»ï¼Œä½œä¸ºæ„é€ å‡½æ•°å‚æ•°çš„æŒæœ‰è€…ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="e3a0" class="jq jr hi jh b fi js jt l ju jv">class LoginPageArguments {<br/>  final String id;<br/>  LoginPageArguments({required this.id});<br/>}</span></pre><p id="65c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿå‡è®¾æˆ‘ä»¬åœ¨ä¸€ä¸ªè§†å›¾æ¨¡å‹ä¸­</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="adbb" class="jq jr hi jh b fi js jt l ju jv"><em class="jd">//within a viewModel<br/></em>void move(){<br/>     //after registering navigationService as dependency(more on this later)<br/>     <strong class="jh hj">locator.get&lt;NavigationService()</strong><br/>            .navigateTo(<br/>                Routes.<em class="jd">loginPage</em>,<br/>                 <strong class="jh hj">arguments:</strong> <strong class="jh hj">LoginPageArguments(id: '1')</strong>);<br/>    <br/>    /* #### Equivalent to #####<br/>     <em class="jd">Navigator.of(context)<br/>              .pushNamed(Routes.loginPage,<br/>                  arguments:{id:1});<br/></em>    */ <br/>}</span></pre><p id="925d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™å°†æŠŠæˆ‘ä»¬å¯¼èˆªåˆ°å¸¦æœ‰ä¼ é€’çš„å‚æ•°çš„ Loginpageã€‚å‚æ•°è§£ç»„å°†ç”±å †å çš„åŒ…å®Œæˆã€‚</p><ul class=""><li id="6a23" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated">å½“ä½¿ç”¨ LoginPageArguments æ—¶ï¼Œæˆ‘ä»¬ä¸èƒ½è·³è¿‡ä»»ä½•<code class="du je jf jg jh b">required</code>å‚æ•°ï¼Œè¿™ä¸ºä¼ é€’å‚æ•°æä¾›äº†<strong class="ih hj">ç¼–è¯‘æ—¶å®‰å…¨æ€§</strong>ã€‚</li></ul><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="b623" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">arguments:</strong> <strong class="jh hj">LoginPageArguments() //error, must pass 'id'</strong></span></pre><ul class=""><li id="7ea7" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated">å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘ä»¬åœ¨ä¸šåŠ¡é€»è¾‘å±‚ä¸­ä¸ä½¿ç”¨ä»»ä½•ä¸Šä¸‹æ–‡è¿›è¡Œå¯¼èˆªã€‚è¿™æ˜¯ä½¿ç”¨å †å æœåŠ¡çš„ä¸»è¦å¥½å¤„ä¹‹ä¸€ã€‚</li></ul></div><div class="ab cl nj nk gp nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="hb hc hd he hf"><figure class="ji jj jk jl fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nq"><img src="../Images/c14f2637b1695941e9f459b93b5c52f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7v50z18isGx7adfhWVKWQ.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">Diana Polekhina åœ¨<a class="ae lg" href="https://unsplash.com/s/photos/injection?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h2 id="087a" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">2.ä¾èµ–æ€§æ³¨å†Œ</h2><p id="03db" class="pw-post-body-paragraph if ig hi ih b ii lw ik il im lx io ip iq nr is it iu ns iw ix iy nt ja jb jc hb bi translated">æ‚¨å¯ä»¥åœ¨ stackedApp æ³¨é‡Šä¸­æ³¨å†Œæ‚¨çš„ä¾èµ–é¡¹ï¼Œå®ƒå‡å°‘äº†<code class="du je jf jg jh b">get_it</code>åŒ…çš„å¤§éƒ¨åˆ†æ³¨å†Œæ ·æ¿ä»£ç ã€‚æˆ‘å†™äº†ä¸€ç¯‡å…³äº get_it çš„æ–‡ç« ï¼Œå¦‚æœä½ æœ‰å…´è¶£å¯ä»¥åœ¨è¿™é‡Œ<a class="ae lg" rel="noopener" href="/nerd-for-tech/implement-service-locator-design-pattern-with-get-it-flutter-5e50671bbbcb">é˜…è¯»ã€‚</a></p><h2 id="c951" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">1.åœ¨@StackedApp ä¸­æŒ‡å®šä¾èµ–é¡¹</h2><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="beb3" class="jq jr hi jh b fi js jt l ju jv">//code snippet from the official docs<br/><strong class="jh hj">@StackedApp</strong>(<br/>routes : [ ... ],<br/><strong class="jh hj">dependencies</strong>: [<br/>    <strong class="jh hj">LazySingleton</strong>(classType: ThemeService, resolveUsing: ThemeService.getInstance),</span><span id="2e2e" class="jq jr hi jh b fi jw jt l ju jv"><em class="jd">// abstracted class type support</em><br/>    <strong class="jh hj">LazySingleton</strong>(classType: FirebaseAuthService, asType: AuthService),</span><span id="d651" class="jq jr hi jh b fi jw jt l ju jv">    <strong class="jh hj">Singleton</strong>(classType: NavigationService),</span><span id="6d79" class="jq jr hi jh b fi jw jt l ju jv"><strong class="jh hj">Factory</strong>( classType: Counter)<strong class="jh hj">,</strong></span><span id="02d4" class="jq jr hi jh b fi jw jt l ju jv"><strong class="jh hj">Presolve</strong>(<br/>      classType: SharedPreferencesService,<br/>      presolveUsing: SharedPreferencesService.getInstance,<br/>    ),<br/>  ],<br/>)</span></pre><h2 id="0269" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">2.è¿è¡Œå‘½ä»¤</h2><p id="00a8" class="pw-post-body-paragraph if ig hi ih b ii lw ik il im lx io ip iq nr is it iu ns iw ix iy nt ja jb jc hb bi translated">ä¸è¦å¿˜è®°è¿è¡Œå‘½ä»¤ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="9635" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">flutter pub<em class="jd"> </em>run<em class="jd"> build_runner build --delete-conflicting-outputs</em></strong></span></pre><blockquote class="mo mp mq"><p id="8e1c" class="if ig jd ih b ii ij ik il im in io ip mr ir is it ms iv iw ix mt iz ja jb jc hb bi translated">è¿™å°†ç”Ÿæˆ<strong class="ih hj"> app.locator.dart </strong>ï¼Œå…¶ä¸­åŒ…å«æ‚¨æŒ‡å®šçš„æ‰€æœ‰ä¾èµ–é¡¹ã€‚</p></blockquote><h2 id="6d4b" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">3.ä» runApp()è°ƒç”¨ setupLocator()</h2><p id="bbd5" class="pw-post-body-paragraph if ig hi ih b ii lw ik il im lx io ip iq nr is it iu ns iw ix iy nt ja jb jc hb bi translated">å¦å¤–ï¼Œä¸è¦å¿˜è®°ä» runApp()è°ƒç”¨ setupLocator()ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="aadc" class="jq jr hi jh b fi js jt l ju jv">import './<strong class="jh hj">app.locator.dart</strong>';<br/>void main() {<br/>  <strong class="jh hj">setupLocator()</strong>; //this function is inside the <strong class="jh hj"><em class="jd">app.router.dart</em></strong> file<br/>  runApp(MyApp());<br/>}</span></pre><p id="0166" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">4 ç§æ³¨å†Œç±»å‹</strong></p><h2 id="6cb9" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">1.è¾›æ ¼å°”é¡¿&amp;æ‹‰å…¹è¾›æ ¼å°”é¡¿</h2><ul class=""><li id="d0aa" class="lu lv hi ih b ii lw im lx iq ly iu lz iy ma jc mi mc md me bi translated">Singleton â€”å§‹ç»ˆåªåˆ›å»ºå’Œé‡ç”¨ä¸€ä¸ªå®ä¾‹ã€‚</li><li id="50c5" class="lu lv hi ih b ii mj im mk iq ml iu mm iy mn jc mi mc md me bi translated">LazySingletonâ€”â€”ç±»ä¼¼äº Singletonï¼Œä½†å®ä¾‹ä»…åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶åˆ›å»ºï¼Œè€Œä¸æ˜¯åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶åˆ›å»ºï¼Œè¿™å¯ä»¥èŠ‚çœä¸€äº›å¯åŠ¨æ—¶é—´ã€‚</li></ul><p id="237d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å‚æ•°:</strong></p><ul class=""><li id="617c" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated"><strong class="ih hj"> classType </strong>:è¦åˆå§‹åŒ–çš„ç±»çš„ç±»å‹ã€‚</li><li id="9fb7" class="lu lv hi ih b ii mj im mk iq ml iu mm iy mn jc mi mc md me bi translated"><strong class="ih hj"> asType </strong>:è¦å…¬å¼€çš„ç±»çš„ç±»å‹ã€‚</li><li id="da90" class="lu lv hi ih b ii mj im mk iq ml iu mm iy mn jc mi mc md me bi translated"><strong class="ih hj"> resolveUsing </strong>:è¿™é‡Œéœ€è¦ä¼ é€’ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å›<code class="du je jf jg jh b">classType</code>çš„å®ä¾‹ã€‚</li></ul><p id="edaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç¤ºä¾‹:</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="48d4" class="jq jr hi jh b fi js jt l ju jv">//abstract parent class<br/><strong class="jh hj">abstract class AuthService</strong> {<br/>    bool get isLoggedIn;<br/>    void login();<br/>    void logout();<br/>    void register();<br/>}</span></pre><p id="1d21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬çš„ AuthService å®ç°</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="58cc" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">class FirebaseAuthService extends AuthService</strong> {<br/>    //implements all the required methods of AuthService<br/>}</span></pre><p id="03d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨æˆ‘ä»¬è¦å¯åŠ¨ FirebaseAuthService å¹¶å°†å…¶ç±»å‹å…¬å¼€ä¸ºå…¶çˆ¶ç±»å‹(AuthService)ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="39ed" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">AuthService </strong>authService = <strong class="jh hj">FirebaseAuthService</strong>();</span></pre><p id="f183" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„é€»è¾‘æ³¨å†ŒæœåŠ¡ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="2da4" class="jq jr hi jh b fi js jt l ju jv">LazySingleton(<strong class="jh hj">classType</strong>: <strong class="jh hj">FirebaseAuthService</strong>, <strong class="jh hj">asType</strong>: <strong class="jh hj">AuthService</strong>)</span></pre><h2 id="948d" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">2.å·¥å‚()</h2><p id="932a" class="pw-post-body-paragraph if ig hi ih b ii lw ik il im lx io ip iq nr is it iu ns iw ix iy nt ja jb jc hb bi translated">æœ‰æ—¶æˆ‘ä»¬ä¸æƒ³è¦å•ä¾‹ï¼Œæˆ‘ä»¬å¸Œæœ›æ¯æ¬¡è°ƒç”¨<code class="du je jf jg jh b">locator.get&lt;T&gt;()</code>æ—¶éƒ½æœ‰ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚å¯ä»¥ä½¿ç”¨ Factory()æ³¨å†Œæ¥å®ç°ã€‚</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="8b58" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">Factory</strong>(classType: Dog,asType: Animal,);</span></pre><p id="5fef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç›¸å½“äº</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="fe79" class="jq jr hi jh b fi js jt l ju jv">Animal animal = new Dog();</span></pre><p id="d378" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ get_it ä¸­ï¼Œå®ƒç›¸å½“äºï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="7e71" class="jq jr hi jh b fi js jt l ju jv">locator.registerFactory&lt;Animal&gt;(() =&gt; Dog());</span></pre><p id="e044" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.é¢„æ±‚è§£()</p><p id="cd11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å‡è®¾æˆ‘ä»¬è¯´ä½ æƒ³åœ¨æ³¨å†Œå¯¹è±¡ä¹‹å‰åšä¸€äº›<strong class="ih hj"> <em class="jd">æœªæ¥</em> </strong>çš„è®¡ç®—ï¼Œå¯ä»¥ç”¨<em class="jd"> Presolve() </em>ã€‚</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="89b6" class="jq jr hi jh b fi js jt l ju jv">Presolve(<br/>      classType: SharedPreferencesService,<br/>      <strong class="jh hj"><em class="jd">presolveUsing: SharedPreferencesService.getInstance</em></strong>,<br/>    ),</span></pre><ul class=""><li id="dd04" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated">presolveUsing:å®ƒä¹Ÿé‡‡ç”¨ç±»ä¼¼äº<code class="du je jf jg jh b">resolveUsing </code>çš„é™æ€æ–¹æ³•ï¼Œä½†æ˜¯å®ƒ<code class="du je jf jg jh b"> </code>å¿…é¡»è¿”å›æŒ‡å®šç±»å‹çš„æœªæ¥ã€‚<code class="du je jf jg jh b">Future&lt;classType&gt;</code></li></ul><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="ddd2" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">static</strong> Future&lt;SharedPreferencesService&gt; getInstance() <strong class="jh hj">async</strong> {<br/>  <strong class="jh hj">//...</strong><br/>}</span></pre><p id="7e94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚ä½ æ‰€è§ï¼Œ<code class="du je jf jg jh b">getInstance() </code>æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¿”å›æŒ‡å®šç±»å‹çš„æœªæ¥å€¼<code class="du je jf jg jh b">SharedPreferencesService.</code></p><ul class=""><li id="f2e4" class="lu lv hi ih b ii ij im in iq mf iu mg iy mh jc mi mc md me bi translated">å¦‚æœæˆ‘ä»¬å°è¯•åœ¨æ²¡æœ‰é¢„è§£çš„æƒ…å†µä¸‹æ³¨å†Œï¼Œå®ƒå°†æ³¨å†Œ<code class="du je jf jg jh b">Future&lt;SharedPreferencesService&gt; </code>è€Œä¸æ˜¯<code class="du je jf jg jh b">SharedPreferencesService.</code>çš„ç±»å‹</li><li id="7b90" class="lu lv hi ih b ii mj im mk iq ml iu mm iy mn jc mi mc md me bi translated">é¢„è§£å†³'<strong class="ih hj">ç­‰å¾…'</strong>,ç›´åˆ°å°†æ¥å®Œæˆå¹¶æ³¨å†Œå®ä¾‹ã€‚</li></ul><blockquote class="mo mp mq"><p id="23ce" class="if ig jd ih b ii ij ik il im in io ip mr ir is it ms iv iw ix mt iz ja jb jc hb bi translated">å¦‚æœæ‚¨æ³¨å†Œäº†ä»»ä½•éœ€è¦é¢„å…ˆè§£å†³çš„ä¾èµ–é¡¹ï¼Œé‚£ä¹ˆæ‚¨å¿…é¡»å°†ä¸»å‡½æ•°æ›´æ”¹ä¸º<strong class="ih hj"> Futureï¼Œå¹¶ç­‰å¾… setupLocator </strong>è°ƒç”¨ã€‚</p></blockquote><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="cbbb" class="jq jr hi jh b fi js jt l ju jv">Future main() <strong class="jh hj">async</strong> {<br/>  <strong class="jh hj">await</strong> setupLocator();<br/>  runApp(MyApp());<br/>}</span></pre></div><div class="ab cl nj nk gp nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="hb hc hd he hf"><h2 id="294d" class="jq jr hi bd jy lh li lj kc lk ll lm kg iq ln lo kk iu lp lq ko iy lr ls ks lt bi translated">3.è®°å½•</h2><p id="eb05" class="pw-post-body-paragraph if ig hi ih b ii lw ik il im lx io ip iq nr is it iu ns iw ix iy nt ja jb jc hb bi translated">ä½ å¦‚ä½•è°ƒè¯•ä½ çš„ç¨‹åºï¼Ÿä½¿ç”¨ print()ï¼Œæ˜¯æ—¶å€™æ”¹å˜äº†ã€‚å †å å°è£…æä¾›å¼€ç®±å³ç”¨çš„<code class="du je jf jg jh b">logger </code>ã€‚</p><p id="4e0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1ã€‚åœ¨@StackedApp </strong>ä¸­æŒ‡å®šè®°å½•å™¨</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="441d" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">@StackedApp</strong>(<br/>routes: [..],<br/><strong class="jh hj">logger: StackedLogger()<br/></strong>)</span></pre><p id="2382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2ã€‚å®‰è£…è®°å½•å™¨åŒ…</strong></p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="ec02" class="jq jr hi jh b fi js jt l ju jv">dependencies:<br/>  ...<br/>  logger:</span></pre><p id="d487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å¯ä»¥è°ƒç”¨ getLogger()ï¼Œå®ƒè¿”å›ä¸€ä¸ª Loggerï¼Œå®ƒæ›´åƒä¸€ä¸ª print()ï¼Œä½†æ˜¯å®ƒå·§å¦™åœ°æ ¼å¼åŒ–äº†æ¶ˆæ¯ï¼Œå¹¶èµ‹äºˆå®ƒä¸€å®šçš„é‡è¦æ€§ã€‚</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="fd1f" class="jq jr hi jh b fi js jt l ju jv"><strong class="jh hj">class</strong> <strong class="jh hj">MyViewModel</strong> {<br/><strong class="jh hj">final</strong> logger = getLogger('MyViewModel');<br/><strong class="jh hj">void</strong> move() {<br/>    //importance level from low to high<br/>    logger.<strong class="jh hj">v</strong>("Verbose log");  //verbose<br/>    logger.<strong class="jh hj">d</strong>("Debug log");    //debug<br/>    logger.<strong class="jh hj">i</strong>("Info log");     //info<br/>    logger.<strong class="jh hj">w</strong>("Warning log");  //warning<br/>    logger.<strong class="jh hj">e</strong>("Error log");    //error<br/>    logger.<strong class="jh hj">wtf</strong>("What a terrible failure log"); //you know this<br/>  }<br/>}</span></pre><blockquote class="mo mp mq"><p id="62cc" class="if ig jd ih b ii ij ik il im in io ip mr ir is it ms iv iw ix mt iz ja jb jc hb bi translated">ç¡®ä¿ä½ ä¼ é€’ç»™ getLogger()çš„ç±»åä¸ä½ æ‰€åœ¨çš„ç±»ç›¸åŒã€‚è¿™å°†å¸®åŠ©è®°å½•å™¨è‡ªåŠ¨æ‰“å°æ–¹æ³•åã€‚(æœ¬ä¾‹ä¸­ä¸º move())</p></blockquote><p id="029c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¿™å°†åœ¨æ‚¨çš„æ§åˆ¶å°ä¸Šæ‰“å°ä»¥ä¸‹æ¶ˆæ¯</p><figure class="ji jj jk jl fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nu"><img src="../Images/bca36aa5b4d6d750d198d073c6890984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8dezhcVGQjT82YMOaRWlA.png"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">è¡¨æƒ…ç±»å|æ–¹æ³•åâ€”é”™è¯¯æ¶ˆæ¯</figcaption></figure><p id="b168" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨è¿˜å¯ä»¥è¿‡æ»¤æ—¥å¿—çº§åˆ«çš„æ—¥å¿—ï¼Œå‡è®¾æ‚¨åªæƒ³æ‰“å°æ—¥å¿—çº§åˆ«ä¸º'<em class="jd">è­¦å‘Š'</em>'çš„æ—¥å¿—ã€‚ä½ èƒ½åšçš„ï¼Œ</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="29c5" class="jq jr hi jh b fi js jt l ju jv">void main() {<br/>  runApp(MyApp());<br/>  <strong class="jh hj">Logger.<em class="jd">level </em>= Level.warning;<br/> </strong>//prints only ['warning','error','wtf'] logs<br/>}</span></pre><figure class="ji jj jk jl fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es nv"><img src="../Images/d724577f5fd1d693ddcf9d94673a59f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnqX8C5a9x_aTYmsJfyaGA.png"/></div></div></figure><p id="5e0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœä½ æƒ³ç”¨å…¶ä»–æ–¹æ³•è€Œä¸æ˜¯<code class="du je jf jg jh b">getLogger()</code>æ¥è·å–æ—¥å¿—ï¼Œä½ å¯ä»¥åœ¨<code class="du je jf jg jh b">StackedLogger</code>ä¸­è¦†ç›–å®ƒã€‚</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="6d96" class="jq jr hi jh b fi js jt l ju jv">@StackedApp(<br/>  routes:[..],<br/>  logger: StackedLogger(<br/>    <strong class="jh hj">logHelperName: 'getMyLogger' </strong>//default: 'getLogger'<br/>  )<br/>)</span></pre><p id="b4db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è°ƒç”¨è®°å½•å™¨:</p><pre class="ji jj jk jl fd jm jh jn jo aw jp bi"><span id="9ec5" class="jq jr hi jh b fi js jt l ju jv">getMyLogger(â€˜className);</span></pre><p id="b79d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æœ‰äº†<code class="du je jf jg jh b">Stacked </code>åŒ…ï¼Œä½ å°±å¯ä»¥<strong class="ih hj">è‡ªåŠ¨ç”Ÿæˆè¡¨å•</strong>å¦å¤–ï¼Œè¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å»çœ‹çœ‹<a class="ae lg" href="https://pub.dev/packages/stacked" rel="noopener ugc nofollow" target="_blank">å®˜æ–¹æ–‡æ¡£</a>ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œå®ƒå†™å¾—éå¸¸å¥½ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚æ‹æ‰‹å£°ğŸ‘å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ã€‚</p></div></div>    
</body>
</html>