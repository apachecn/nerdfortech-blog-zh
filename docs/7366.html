<html>
<head>
<title>Leveraging git hooks with Husky in Javascript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨ Javascript ä¸­åˆ©ç”¨ Husky çš„ git æŒ‚é’©</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/nerd-for-tech/leveraging-git-hooks-with-husky-in-javascript-c34cac4613ee?source=collection_archive---------2-----------------------#2022-10-09">https://medium.com/nerd-for-tech/leveraging-git-hooks-with-husky-in-javascript-c34cac4613ee?source=collection_archive---------2-----------------------#2022-10-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a0aaa1e8f2590f9b3e9f6131f121c53a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C1J0VxC5YBTxqagi"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">ç”±<a class="ae iu" href="https://unsplash.com/@maxwelldacombe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">éº¦å…‹æ–¯éŸ¦Â·è¾¾ç§‘å§†</a>åœ¨<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„çš„ç…§ç‰‡</figcaption></figure><h1 id="ee1a" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">å¿«é€Ÿä»‹ç»</h1><p id="189a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">Git ä¸ºåœ¨ç‰¹å®šäº‹ä»¶ä¹‹å‰/ä¹‹åè§¦å‘å‘½ä»¤æä¾›äº†ä¸åŒçš„é’©å­ã€‚ä½†æ˜¯å¼€å‘æ—¶å¯èƒ½ä¼šæ´¾ä¸Šç”¨åœºçš„é’©å­ä¸€èˆ¬æ˜¯<code class="du kr ks kt ku b">pre-commit</code>ã€<code class="du kr ks kt ku b">commit-msg</code>å’Œ<code class="du kr ks kt ku b">pre-push</code>é’©å­ã€‚</p><p id="2e09" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">æˆ‘ä»¬å°†ä½¿ç”¨<code class="du kr ks kt ku b">pre-commit</code>(æäº¤å‰è¿è¡Œå‘½ä»¤ï¼Œæäº¤å¤±è´¥)å’Œ<code class="du kr ks kt ku b">commit-msg</code>(æ£€æŸ¥æäº¤æ¶ˆæ¯ï¼Œå¤±è´¥)</p><p id="ec30" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">è¿™äº›é’©å­ä¸<code class="du kr ks kt ku b">bash</code>å‘½ä»¤ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯ä¸ºäº†å¿«é€Ÿå…¥é—¨è€Œæ— éœ€ç¼–å†™<code class="du kr ks kt ku b">bash</code>ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Husky npm åŒ…æ¥ä¸ºæˆ‘ä»¬è®¾ç½®ã€‚</p><h1 id="da88" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">è®¾ç½® Husky</h1><p id="5b39" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">è¿™å¾ˆå®¹æ˜“ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œhusky æä¾›äº†ä¸€ä¸ªå‘½ä»¤æ¥è®¾ç½®å’Œåˆ›å»ºä¸€ä¸ª<code class="du kr ks kt ku b">pre-commit</code>é’©å­ã€‚</p><p id="0ed0" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">ä½†æ˜¯ç¬¬ä¸€æ­¥æ˜¯åˆå§‹åŒ– git å­˜å‚¨åº“(å¦‚æœè¿˜æ²¡æœ‰åˆå§‹åŒ–çš„è¯)ã€‚æ‰§è¡Œ<code class="du kr ks kt ku b">git init</code>å¹¶åˆå§‹åŒ– git å­˜å‚¨åº“ã€‚</p><p id="f5c2" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">ä¸‹ä¸€æ­¥æ˜¯å®‰è£…å“ˆå£«å¥‡</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="36a8" class="li iw hi ku b fi lj lk l ll lm">npx husky-init &amp;&amp; npm install</span></pre><p id="43ff" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">ä¸Šé¢çš„å‘½ä»¤å°†å®‰è£… husky ä½œä¸ºä¸€ä¸ªå¼€å‘ä¾èµ–é¡¹ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª<code class="du kr ks kt ku b">.husky</code>æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨<code class="du kr ks kt ku b">.husky/pre-commit</code>æ–‡ä»¶ä¸­è®¾ç½®ä¸€ä¸ªæ¼”ç¤º<code class="du kr ks kt ku b">pre-commit</code>é’©å­ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–‡ä»¶å†…å®¹ä¼šæœ‰<code class="du kr ks kt ku b">npm test</code>å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œæ›´æ”¹ã€‚</p><p id="92b7" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">æ‚¨å¯ä»¥é€šè¿‡ç±»ä¼¼äº<code class="du kr ks kt ku b">npx eslint &amp;&amp; npm test</code>çš„æ–¹å¼æ¥æ›´æ”¹è¿™ä¸ªé»˜è®¤æäº¤ï¼Œå®ƒå°†é¦–å…ˆ lint æ•´ä¸ªä»£ç åº“ï¼Œç„¶åè¿è¡Œæµ‹è¯•(å¦‚æœæœ‰çš„è¯)ã€‚</p><p id="8b43" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">è¦æ‰‹åŠ¨æ·»åŠ <code class="du kr ks kt ku b">husky</code>ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œ</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="77d4" class="li iw hi ku b fi lj lk l ll lm">npm install --save-dev husky</span><span id="a556" class="li iw hi ku b fi ln lk l ll lm">npx husky install</span></pre><p id="be91" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">è¦æ·»åŠ å…¶ä»– git æŒ‚é’©ï¼Œè¯·ä½¿ç”¨</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="731d" class="li iw hi ku b fi lj lk l ll lm">npx husky add .husky/&lt;hook-name&gt; "your command"</span></pre><p id="db64" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">è¦åœ¨åŒä¸€ä¸ªæŒ‚é’©ä¸­æ·»åŠ æ›´å¤šå‘½ä»¤ï¼Œè¯·åœ¨æ–°çš„ä¸€è¡Œå¼€å§‹æ·»åŠ å‘½ä»¤</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="588b" class="li iw hi ku b fi lj lk l ll lm">// .husky/pre-commit</span><span id="ed7f" class="li iw hi ku b fi ln lk l ll lm">#!/usr/bin/env sh<br/>. "$(dirname -- "$0")/_/husky.sh</span><span id="1afb" class="li iw hi ku b fi ln lk l ll lm">npx eslint<br/>npm test</span></pre><p id="c912" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">å¦‚æœå‡ºäºæŸç§åŸå› ï¼Œæ‚¨æƒ³è·³è¿‡ git-hooks æ£€æŸ¥ï¼Œé‚£ä¹ˆåœ¨æäº¤æ—¶æ·»åŠ <code class="du kr ks kt ku b">--no-verify</code>æ ‡å¿—</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="3848" class="li iw hi ku b fi lj lk l ll lm">git commit --no-verify -m "WIP"</span></pre><h1 id="8cba" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">ä½¿ç”¨ lint-staged æ­é… Husky</h1><p id="0712" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">å½“æ—æŒºä»£ç æ—¶ï¼Œæ‚¨åªéœ€è¦ lint æš‚å­˜åŒºä¸­å°†è¦æäº¤çš„æ–‡ä»¶ã€‚</p><p id="16f2" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">ä½†æ˜¯ï¼Œ<code class="du kr ks kt ku b">eslint</code>æˆ–å…¶ä»– linters å¯¹ä»£ç åº“ä¸­çš„æ‰€æœ‰æ–‡ä»¶æˆ–æ»¡è¶³ç‰¹å®š glob æ¨¡å¼(å¦‚<code class="du kr ks kt ku b">src/**/*.{js,ts}</code>)çš„æ–‡ä»¶è¿è¡Œæ—æŒºã€‚è¿™ä¸åˆ©äºæ—¶é—´æ•ˆç‡ã€‚ç›¸åï¼Œåªå¯¹æš‚å­˜åŒºä¸­çš„æ–‡ä»¶è¿è¡Œæ—æŒºä¼šæ›´å¥½ã€‚</p><p id="431a" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">æœ‰ä¸€ä¸ªåŒ…å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<code class="du kr ks kt ku b">lint-staged</code>å¯è®©æ‚¨é…ç½®è¦ä¸ºæš‚å­˜æ–‡ä»¶è¿è¡Œçš„å‘½ä»¤ã€‚</p><p id="f662" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">å®‰è£…<code class="du kr ks kt ku b">lint-staged</code>ä½œä¸ºå¼€å‘ä¾èµ–é¡¹</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="39c8" class="li iw hi ku b fi lj lk l ll lm">npm install --save-dev lint-staged</span></pre><p id="e323" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">å°†ä¸‹é¢çš„é…ç½®æ·»åŠ åˆ°<code class="du kr ks kt ku b">package.json</code>ï¼Œå¹¶åœ¨æäº¤æš‚å­˜çš„<code class="du kr ks kt ku b">js</code>æˆ–<code class="du kr ks kt ku b">ts</code>æ–‡ä»¶ä¹‹å‰æä¾›æ‚¨æƒ³è¦è¿è¡Œçš„ä»»ä½•å‘½ä»¤ã€‚</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="3034" class="li iw hi ku b fi lj lk l ll lm">"lint-staged": {<br/>  "*.{js,ts}": ["npx eslint --fix", "npm test"]<br/>}</span></pre><p id="794c" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">åœ¨<code class="du kr ks kt ku b">.husky/pre-commit</code>æ¡£ä¸­ï¼Œå°†<code class="du kr ks kt ku b">npm test</code>æ›¿æ¢ä¸º<code class="du kr ks kt ku b">npx lint-staged</code>ã€‚è¿™å°†è¿è¡Œ<code class="du kr ks kt ku b">lint-staged</code>ï¼Œè€Œ<code class="du kr ks kt ku b">lint-staged</code>åˆå°†è¿è¡Œæä¾›ç»™<code class="du kr ks kt ku b">lint-staged</code>é…ç½®çš„å‘½ä»¤ï¼Œåªåœ¨æš‚å­˜æ–‡ä»¶ä¸Šè¿è¡Œã€‚</p><h1 id="602c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">æ—æŒºç”¨<code class="du kr ks kt ku b">Commitlint</code>æäº¤æ¶ˆæ¯</h1><p id="5a47" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">æˆ‘ä»¬å¯ä»¥åœ¨ husky ä¸­ä½¿ç”¨å¦ä¸€ä¸ªæµè¡Œçš„ git æŒ‚é’©<code class="du kr ks kt ku b">commit-msg</code>ã€‚æˆ‘ä»¬å°†æ£€æŸ¥æˆ‘ä»¬çš„æäº¤æ˜¯å¦å†™å¾—å¾ˆå¥½å¹¶éµå¾ªäº†æ ‡å‡†ã€‚</p><p id="0ae3" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code class="du kr ks kt ku b">commitlint</code>åœ¨æäº¤ä¹‹å‰éªŒè¯æˆ‘ä»¬çš„æäº¤æ¶ˆæ¯ã€‚</p><p id="60bc" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">å®‰è£…<code class="du kr ks kt ku b">@commitlint/cli</code>å’Œ<code class="du kr ks kt ku b">@commitlint/config-conventional</code>(å¸¦æœ‰é¢„å®šä¹‰æäº¤è§„åˆ™çš„ç¤ºä¾‹é…ç½®)ã€‚</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="4a42" class="li iw hi ku b fi lj lk l ll lm">npm install --save-dev @commitlint/cli @commitlint/config-conventional</span></pre><p id="d836" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">ç„¶ååˆ›å»ºä¸€ä¸ª<code class="du kr ks kt ku b">commitlint.config.js</code>æ–‡ä»¶å¹¶æ‰©å±•<code class="du kr ks kt ku b">config-conventional</code></p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="2ecb" class="li iw hi ku b fi lj lk l ll lm">// commitlint.config.js</span><span id="1f4b" class="li iw hi ku b fi ln lk l ll lm">module.exports = { extends: ["@commitlint/config-conventional"] };</span></pre><p id="38ca" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªè®¾ç½®ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚åœ¨ husky ä¸­æ·»åŠ ä¸€ä¸ª<code class="du kr ks kt ku b">commit-msg</code>æŒ‚é’©ï¼Œä»¥ä¾¿åœ¨æäº¤å‰è‡ªåŠ¨è¿è¡Œã€‚</p><pre class="la lb lc ld fd le ku lf lg aw lh bi"><span id="d358" class="li iw hi ku b fi lj lk l ll lm">npx husky add .husky/commit-msg "npx commitlint --edit"</span></pre><p id="2c01" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">å¦‚æœæ¶ˆæ¯æ— æ•ˆï¼Œè¿™ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå¹¶ä¸”ä¸å…è®¸æäº¤(æ ¹æ® commitlint é…ç½®)ã€‚</p><p id="695c" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äº<code class="du kr ks kt ku b">commitlint</code>çš„ä¿¡æ¯å¹¶æƒ³å®šåˆ¶é…ç½®ï¼Œè¯·è®¿é—®<a class="ae iu" href="https://commitlint.js.org/#/reference-configuration" rel="noopener ugc nofollow" target="_blank">https://commitlint.js.org/#/reference-configuration</a>ã€‚</p></div><div class="ab cl lo lp gp lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hb hc hd he hf"><p id="f40d" class="pw-post-body-paragraph jt ju hi jv b jw kv jy jz ka kw kc kd ke kx kg kh ki ky kk kl km kz ko kp kq hb bi translated">è¿™æ˜¯æ‰€æœ‰çš„ä¹¡äº²ã€‚å¦‚æœè¿™æœ‰å¸®åŠ©ï¼Œè¯·ç•™ä¸‹ğŸ‘ä¸‹ä¸€é›†å†è§ã€‚</p><h1 id="1678" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">æœ‰ç”¨çš„é“¾æ¥</h1><ul class=""><li id="ac67" class="lv lw hi jv b jw jx ka kb ke lx ki ly km lz kq ma mb mc md bi translated">ã€https://typicode.github.io/husky/#/ã€‘</li><li id="da52" class="lv lw hi jv b jw me ka mf ke mg ki mh km mi kq ma mb mc md bi translated"><a class="ae iu" href="https://www.npmjs.com/package/lint-staged" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/lint-staged</a></li><li id="ecd7" class="lv lw hi jv b jw me ka mf ke mg ki mh km mi kq ma mb mc md bi translated"><a class="ae iu" href="https://commitlint.js.org/#/" rel="noopener ugc nofollow" target="_blank">https://commitlint.js.org/#/</a></li></ul></div></div>    
</body>
</html>